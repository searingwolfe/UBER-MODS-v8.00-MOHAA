main:

exec cvars/cvars.scr			// <><><> UBER MODS <><><>
exec ubermods/runspeed.scr 350 		// set the server's player run speed here (default = 250).
exec ubermods/hardcode_list.scr		// set the "g_ubergametype" for each map in "hardcode_list.scr" (only if "g_uberhardcode 1" cvar is set, default = "0").
					
//setcvar "g_ubergametype" "0"		// "cyb", "snd", "bb", "ft", "0" (normal TDM or FFA, based on "g_gametype" being "2" or "1" respectively).
					// cyber attack, search & destroy, base-builder, freze tag, none (this cvar is usually placed in server.cfg).
setcvar "g_obj_alliedtext1" "m1l2a"
setcvar "g_obj_axistext1" ""
setcvar "g_obj_axistext2" ""
setcvar "g_obj_axistext3" "By: Searingwolfe"

setcvar "g_scoreboardpic" "m1l2a"

setcvar "fraglimit" "0"
setcvar "timelimit" "20"
setcvar "maxentities" "2000"

setcvar "dmrespawning" "1" 
setcvar "dmroundlimit" "20" 
setcvar "level.clockside" "kills"
local.v = exec ubermods/uberversion.scr

if(getcvar("g_throwingknives") != "1") { setcvar "g_obj_alliedtext3" "" }
if(getcvar("g_throwingknives") == "1") { setcvar "g_obj_alliedtext3" "+ Throwing Knives Mod" }

if(getcvar("g_gametype") == "1") { 		setcvar "g_obj_alliedtext2" ("UBER Free-For-All " + local.v);	setcvar "g_gametypestring" "Free-For-All UBER";		setcvar "g_gametype" "1"; thread ffa_spawns }
if(getcvar("g_gametype") != "1") { 		setcvar "g_obj_alliedtext2" ("UBER Team-Match " + local.v);	setcvar "g_gametypestring" "Team-Match UBER";		setcvar "g_gametype" "2"; thread tdm_spawns
						spawn info_player_deathmatch "origin" "1911 2255 136" "angle" "124" // for spectators when joining game
						spawn info_player_deathmatch "origin" "5298 -2988 115" "angle" "69"
						spawn info_player_deathmatch "origin" "1500 -602 182" "angle" "96"
}
if(getcvar("g_ubergametype") == "cyb") {	setcvar "g_obj_alliedtext2" ("UBER Cyber Attack " + local.v);	setcvar "g_gametypestring" "Cyber Attack UBER";		setcvar "g_gametype" "2"; thread cyb }
if(getcvar("g_ubergametype") == "snd") {	setcvar "g_obj_alliedtext2" ("UBER Search-Destroy " + local.v);	setcvar "g_gametypestring" "Search & Destroy UBER";	setcvar "g_gametype" "2"; thread snd }
if(getcvar("g_ubergametype") == "ft") {		setcvar "g_obj_alliedtext2" ("UBER Freeze Tag " + local.v);	setcvar "g_gametypestring" "Freeze Tag UBER";		setcvar "g_gametype" "2"; thread cyb }
if(getcvar("g_ubergametype") == "bb") {		setcvar "g_obj_alliedtext2" ("UBER Base-Builder " + local.v);	setcvar "g_gametypestring" "Base-Builder UBER"; 	thread bb_objects
setcvar "g_obj_axistext1" "Build a base &"; setcvar "g_obj_axistext2" "kill enemy players."

exec alienx/basebuild.scr::main 800 1000 500 1 1 0 0 0 // buildtime objectlimit buildspeed buildtakeweaps buildfalldamage countdownhide hudhide consoleprint
//level.basebuild_laserdist = 700
}

if(getcvar("g_ubermods") == "1" || getcvar("g_ubermods") == "2")
{
exec global/aliascache_triggersounds.scr airstrikes
exec global/aliascache_triggersounds.scr explode_building_small
exec global/aliascache_triggersounds.scr explode_building_large
exec global/aliascache_triggersounds.scr explode_wood_small
}
exec global/aliascache_triggersounds.scr arty_exp_sand

waitthread setup

level waittill prespawn

	exec global/DMprecache.scr
	exec alienx/hud.scr
	exec ui/fix.scr
	level.dmrespawning = 1

	level.script = maps/m1l2a.scr
	exec global/ambient.scr m1l2a
	exec global/exploder.scr
	//exec global/door_locked.scr
	//exec global/barrel.scr::explosive_barrel
	exec global/shutter.scr

	setcvar "r_fastsky" "0"
	exec global/fastsky.scr 0
	$world farplane 150000
	$world farplane_color ( 0.04314 0.05882 0.16471 )

exec global/victory_podium.scr ( 1535 685 -157 ) -90 auto auto 5

if(getcvar("g_ubermods") == "1" || getcvar("g_ubermods") == "2")
{
	exec global/dog.scr ( 2418 3878 -191 ) ( 0 193 0 ) 15 20

	exec killstreaks/claymores.scr 3 2		// number of kills, number of claymores given (max = 5)
	exec killstreaks/airstrikes.scr	5 8		// number of kills, number of bullets to kill a plane
	exec killstreaks/cluster_mines.scr 7 5		// number of kills, number of additional mines spawned (max = 15)
	exec killstreaks/sentry_turret.scr 9 180	// number of kills, time until sentry turret dies

	thread UBER_mapextras
	thread UBER_teleporters
}
if(getcvar("g_ubermods") == "2")
{
	exec global/playerflak88.scr $flak88a 200 45
	exec global/playerflak88.scr $flak88b 200 45

	exec map_triggers/joint.scr ( -2315 -4118 -639 )

exec map_triggers/lightbomb.scr ( 4631 -3798 128 ) ( 6114 -2699 288 ) ( 4047 -1537 -4 ) ( 5137 -1049 344 ) ( 2575 3103 -191 ) ( 1287 2022 64 ) ( 278 2286 256 ) ( 2528 3879 256 ) ( -509 -445 336 ) ( -1760 -3014 -207 )
exec map_triggers/bomb.scr ( 5880 -3349 384 ) ( 4671 -2934 216 ) ( 5759 -1487 232 ) ( 3184 1066 328 ) ( -57 751 -93 ) ( 4439 5566 244 ) ( 6090 3742 201 ) ( 239 4696 256 ) ( 16 -1302 480 ) ( -399 -2887 -271 )
exec map_triggers/grenade_ammo.scr ( 5402 -4328 -55 ) ( 4109 -2352 -5 ) ( 5641 -2309 17 ) ( 4751 -1304 -127 ) ( 4159 -11 -167 ) ( 3008 -1008 -87 ) ( 992 3143 -39 ) ( 2456 3613 -191 ) ( 688 -1264 19 ) ( -1189 -3680 -319 )
exec map_triggers/rocket_ammo.scr ( 5856 -3522 192 ) ( 5050 -1871 192 ) ( 5616 -1456 184 ) ( 4495 -903 64 ) ( 1295 -1136 -14 ) ( -423 2783 -126 ) ( 953 4160 97 ) ( 1967 2255 -201 ) ( 2400 2255 256 ) ( -235 -336 -47 )
exec map_triggers/snowball_ammo.scr ( 7150 -4936 584 ) ( 7024 -4449 49 ) ( 5750 -4416 400 ) ( 4816 -1520 32 ) ( 4300 -352 264 ) ( 3504 -1008 304 ) ( 1734 -1264 400 ) ( 3184 -112 248 ) ( 734 -475 304 ) ( -2755 -1296 -139 )
exec map_triggers/health.scr ( 6752 -5746 256 ) ( 5825 -4242 234 ) ( 4955 -1542 48 ) ( 4239 -616 64 ) ( 4871 -17 -121 ) ( 3352 -239 120 ) ( -32 2920 -415 ) ( 1711 3760 -511 ) ( -3548 -43 -95 ) ( -2288 -3283 -583 )

exec map_triggers/led_trap.scr ( 4336 -1295 -4 ) led1 1
exec map_triggers/led_trap.scr ( 4631 -3408 -90 ) led2 1
exec map_triggers/led_trap.scr ( 6570 -5473 32 ) led3 2

	level.autospot_trigdist = 550
	level.autospot_movespeed = 2.5
	exec global/player_spotlight.scr ( 2270.25 2047.58 320 ) ( 1 0 0 ) s_auto0 9999 270 0 0 1 ( 0 0 0 ) spotpath1_2 // origin, color, name, health, angle, mountwall (0 = floor), ...
	exec global/player_spotlight.scr ( 785.25 2048.58 320 ) ( 0 1 0 ) s_auto1 9999 270 0 0 1 ( 0 0 0 ) spotpath1_1 // orient (only for mountwall = 1 or 3), removeafterdeath (0 = no, ...
	exec global/player_spotlight.scr ( 70.25 2464.58 328 ) ( 0 0 1 ) s_auto2 9999 270 0 0 1 ( 0 0 0 ) spotpath1_3 // 1 = remove spotlight keep base, 2 = remove everything), initial spot angles, pathname to follow automatically.

if(getcvar("g_ubergametype") != "bb")
{
	// some spotlights were removed to keep entity count lower
	//
	exec map_triggers/player_spotlight.scr ( 7223 -5417 496 ) ( 1 1 1 ) s0 9999 45 0 0 1 		// white
	exec map_triggers/player_spotlight.scr ( -1377 -2681 -47 ) ( 1 0 0 ) s1 700 45 0 0 1		// red
	//exec map_triggers/player_spotlight.scr ( 6783 -4495 384 ) ( 1 .5 0 ) s2 700 135 0 0 1		// orange
	exec map_triggers/player_spotlight.scr ( 5735 -4171 400 ) ( 1 1 0 ) s3 700 135 0 0 1		// yellow
	exec map_triggers/player_spotlight.scr ( 5850 -2683 288 ) ( 0 1 0 ) s4 9999 135 0 0 1		// green
	//exec map_triggers/player_spotlight.scr ( 5278 -1950 248 ) ( 0 1 1 ) s5 700 -45 0 0 1		// teal
	exec map_triggers/player_spotlight.scr ( 5151 -670 208 ) ( 0 0 1 ) s6 700 -135 0 0 1		// blue 
	exec map_triggers/player_spotlight.scr ( 3072 -577 308 ) ( .5 0 1 ) s7 700 135 0 0 1		// purple

	//exec map_triggers/player_spotlight.scr ( 1277 -960 352 ) ( 1 0 1 ) s8 700 45 0 0 1		// magenta
	//exec map_triggers/player_spotlight.scr ( -784 -480 336 ) ( 0 1 .5 ) s9 700 -135 0 0 1		// spring green
	exec map_triggers/player_spotlight.scr ( 2050 1086 328 ) ( 0 .5 1 ) s10 9999 135 0 0 1		// chartreuse
	//exec map_triggers/player_spotlight.scr ( 1865 -74 400 ) ( .5 1 0 ) s11 700 135 0 0 1		// azure
	//exec map_triggers/player_spotlight.scr ( 2583 4448 320 ) ( .125 0 .333 ) s12 700 45 0 0 1	// uv

	exec map_triggers/spotlight_colorswitch.scr ( -1506 -2738 -122 ) ( 0 -45 0 ) s1
	exec map_triggers/spotlight_colorswitch.scr ( 5880 -2879 310 ) ( 0 90 0 ) s4
	exec map_triggers/spotlight_colorswitch.scr ( 2177 1064 328 ) ( 270 90 180 ) s10 rainbow
}

	exec map_triggers/spotlight_colorswitch.scr ( 895 2479 310 ) ( 0 -90 0 ) all rainbow
	exec map_triggers/spotlight_colorswitch.scr ( 607 2479 310 ) ( 0 -90 0 ) all slowrainbow

//exec maps/gen_mapscripts/truckstuff_trig.scr $latertruck2 1 1 500 //$t208 // targetname, horn, headlights, health, name2nd (optional collision entity targetname)
//exec maps/gen_mapscripts/truckstuff_trig.scr $truck2 1 1 500 //$t208

exec global/playervehicle.scr bike2 vehicles/bmwbike.tik ( 6664.85 -3855.81 16.13 ) ( 0 -174 0 ) 250 500 45 1
exec global/playervehicle.scr bike3 vehicles/bmwbike.tik ( 4101.12 -2098.35 -5.87 ) ( 0 0 0 ) 250 500 45 1
exec global/playervehicle.scr latertruck2 vehicles/opeltruck.tik ( 1244 2862 -199 ) ( 0 90 0 ) 250 250 45 1
exec global/playervehicle.scr jeep vehicles/jeep.tik ( -993 -800 -150 ) ( 0 -35 0 ) 250 400 45 1
exec global/playertank.scr kingtank vehicles/kingtank.tik ( -811 2381 -115 ) ( 0 -90 0 ) 1000 45

exec maps/gen_mapscripts/radiobomb_walkietrig.scr bombwalkie1 ( 2125 3096 -449 ) ( 0 180 0 ) ( 1815 3096 -449 ) ( 0 90 0 ) 500 1 1 8
exec maps/gen_mapscripts/radiobomb_walkietrig.scr bombwalkie2 ( -1231 -3751 -383 ) ( 0 -90 0 ) ( -1136 -3751 -383 ) ( 0 0 0 ) 500 1 1 8
exec maps/gen_mapscripts/radiobomb_walkietrig.scr bombwalkie3 ( 4927 -1928 0 ) ( 0 90 0 ) ( 4934 -1681 0 ) ( 0 0 0 ) 500 1 1 8

exec maps/training_mapscripts/bangalore_wallbomb.scr bb1 ( 5151 -1954 144 ) ( 60 270 0 ) 100 0 
exec map_triggers/map_switches/training_alarmswitch_gunrange.scr ( 5231.5 -1935 65 ) ( 0 90 0 ) bb1 60 450 2   // alarmswitch origin, angles; bangalore name, time, damageradius, pulsatingoff
exec maps/training_mapscripts/bangalore_wallbomb.scr bb2 ( 5876 -4223 168 ) ( 60 90 0 ) 100 0 
exec map_triggers/map_switches/training_alarmswitch_gunrange.scr ( 5799 -4364 38 ) ( 0 180 0 ) bb2 60 450 2
exec maps/training_mapscripts/bangalore_wallbomb.scr bb3 ( -635 -416 153 ) ( 60 270 0 ) 100 0 
exec map_triggers/map_switches/training_alarmswitch_gunrange.scr ( -470 -351 27 ) ( 0 90 0 ) bb3 60 450 2
exec maps/training_mapscripts/bangalore_wallbomb.scr bb4 ( 896 2496 134 ) ( 60 90 0 ) 100 0 
exec map_triggers/map_switches/training_alarmswitch_gunrange.scr ( 1008 2479 74 ) ( 0 270 0 ) bb4 60 450 2
exec maps/training_mapscripts/bangalore_wallbomb.scr bb5 ( 734 4031 133 ) ( 60 270 0 ) 100 0 
exec map_triggers/map_switches/training_alarmswitch_gunrange.scr ( 880 4048 74 ) ( 0 90 0 ) bb5 60 450 2
exec maps/training_mapscripts/bangalore_wallbomb.scr bb6 ( -257 2679 -15 ) ( 60 270 0 ) 100 0 
exec map_triggers/map_switches/training_alarmswitch_gunrange.scr ( -194 2808 -138 ) ( 0 90 0 ) bb6 60 450 2

exec maps/training_mapscripts/bangalore_wallbomb.scr bb31 ( 845 2051 96 ) ( 60 -90 0 ) 100 0 
exec maps/training_mapscripts/bangalore_wallbomb.scr bb32 ( 1535 2043 96 ) ( 60 -90 0 ) 100 0 
exec maps/training_mapscripts/bangalore_wallbomb.scr bb33 ( 2193 2047 95 ) ( 60 -90 0 ) 100 0 
thread twoswitch sw1 ( 1351 2095 -139 ) ( 0 180 0 ) 60 500 2
thread twoswitch sw2 ( 1720 2091 -139 ) ( 0 0 0 ) 60 500 2
exec maps/training_mapscripts/bangalore_wallbomb.scr bb41 ( -862 -2720 -70 ) ( 60 45 0 ) 100 0 
exec maps/training_mapscripts/bangalore_wallbomb.scr bb42 ( -1182 -2823 -63 ) ( 60 90 0 ) 100 0 
exec maps/training_mapscripts/bangalore_wallbomb.scr bb43 ( -1504 -2719 -70 ) ( 60 135 0 ) 100 0 
thread twoswitch sw3 ( -837 -2906 -245 ) ( 0 -135 0 ) 60 500 2
thread twoswitch sw4 ( -1530 -2906 -245 ) ( 0 -45 0 ) 60 500 2

exec maps/training_mapscripts/bangalore_wallbomb.scr bb51 ( 3519 -383 64 ) ( 60 180 0 ) 100 0 
exec maps/training_mapscripts/bangalore_wallbomb.scr bb52 ( 3730 -446 -7 ) ( 60 90 0 ) 100 0 
exec maps/training_mapscripts/bangalore_wallbomb.scr bb53 ( 4077 -1 -39 ) ( 60 -90 0 ) 100 0 
exec maps/training_mapscripts/bangalore_wallbomb.scr bb54 ( 4398 -254 -44 ) ( 60 97 10 ) 100 0 
exec maps/training_mapscripts/bangalore_wallbomb.scr bb55 ( 4768 -192 -7 ) ( 60 0 0 ) 100 0
thread twoswitch sw5 ( 3519 -560 -73 ) ( 0 180 0 ) 60 500 2
thread twoswitch sw6 ( 4752 -384 -97 ) ( 0 -90 0 ) 60 500 2

exec map_triggers/gen_switches/cabinetswitch.scr ( 5481 -4495.90 176 ) ( 0 0 0 ) 2 1 // origin, angles, model (1 = dark, 2 = tall, 3 = wardrobe), scale (1 = default).
exec map_triggers/gen_switches/cabinetswitch.scr ( 5707.79 -4439.85 176 ) ( 0 180 0 ) 1 1

exec maps/gen_mapscripts/radios_musictrig.scr ( 5476 -4496 40 ) ( 0 0 0 ) miscobj/radio_civilian.tik 0.01

	thread vehicle_tele 150		// this allows the kingtank specifically to pass through the explodable laser doors near the flak88s
	thread vehicle_tele2 200
	thread vehicles_undermap

	thread splinepath
	thread splinepath2
	thread splinepath3
	thread splinepath4
	thread bomberplane allies first 180 0 7 2.3
	thread bomberplane allies second 180 0 7 2.3
	thread bomberplane axis first 190 0 7 2.3
	thread bomberplane axis second 190 0 7 2.3
}

if(getcvar("g_ubermods") == "1")
{
	thread splinepath
	thread splinepath2
	thread splinepath3
	thread splinepath4
	thread bomberplane allies first 180 1 7 2.3
	thread bomberplane allies second 180 1 7 2.3
	thread bomberplane axis first 190 1 7 2.3
	thread bomberplane axis second 190 1 7 2.3
}

level waittill spawn

	thread consoleprint // additional entities & triggers removed in this thread, flak88bases set as notsolid
	thread ambience

while(level.bbactive == 1) { wait 1 }

if(getcvar("g_throwingknives") == "1")
{
	exec global/give_players_knives.scr 1 // spawn everyone with one throwing knife (hold USE + Right-click to throw)

	exec global/throwingknife.scr k1 ( 2298 3745 -143 ) ( 0 90 0 )
	exec global/throwingknife.scr k2 ( 2996 -776 -87 ) ( 0 90 0 )
	exec global/throwingknife.scr k3 ( 4893 28 -166 ) ( 0 45 0 )
	exec global/throwingknife.scr k4 ( 5625 -4537 16.5 ) ( 0 285 0 )
}
end

ambience: // make sure the spawnamb volumes are not overlapping!!!

	level.spawnamb = makeArray

		( 5263 -4808 -131 ) ( 0 0 -4000 ) ( 176 273 0 ) sound/amb_stereo/Amb_M1_TownExt.mp3
		( 5263 -4808 -130 ) ( 0 0 0 ) ( 176 273 481 ) sound/amb_stereo/Amb_M1_Interior_01.mp3
		( 5263 -4808 352 ) ( 0 0 0 ) ( 176 273 4000 ) sound/amb_stereo/Amb_M1_TownExt.mp3
		( 5262 -4808 0 ) ( -2255 -8000 -4000 ) ( 0 2856 4000 ) sound/amb_stereo/Amb_M1_TownExt.mp3
		( 5263 -4809 0 ) ( 0 -8000 -4000 ) ( 8000 0 4000 ) sound/amb_stereo/Amb_M1_TownExt.mp3

		( 5439 -4255 0 ) ( -176 -279 -4000 ) ( 0 0 4000 ) sound/amb_stereo/Amb_M1_TownExt.mp3
		( 5440 -4255 0 ) ( 0 0 -4000 ) ( 288 88 4000 ) sound/amb_stereo/Amb_M1_TownExt.mp3
		( 5440 -4256 -131 ) ( 0 -552 -4000 ) ( 544 0 0 ) sound/amb_stereo/Amb_M1_TownExt.mp3
		( 5440 -4256 -130 ) ( 0 -552 0 ) ( 544 0 481 ) sound/amb_stereo/Amb_M1_Interior_01.mp3
		( 5440 -4256 352 ) ( 0 -552 0 ) ( 544 0 4000 ) sound/amb_stereo/Amb_M1_TownExt.mp3

		( 6016 -4167 158 ) ( -287 -88 -4000 ) ( 0 0 0 ) sound/amb_stereo/Amb_M1_TownExt.mp3
		( 6016 -4167 159 ) ( -287 -88 0 ) ( 0 0 192 ) sound/amb_stereo/Amb_M1_Interior_01.mp3
		( 6016 -4167 352 ) ( -287 -88 0 ) ( 0 0 4000 ) sound/amb_stereo/Amb_M1_TownExt.mp3
		( 6016 -4166 0 ) ( -753 0 -4000 ) ( 0 5246 4000 ) sound/amb_stereo/Amb_M1_TownExt.mp3
		( 6017 -4167 0 ) ( 0 -641 -4000 ) ( 8000 5246 4000 ) sound/amb_stereo/Amb_M1_TownExt.mp3

		( 4831 -1407 -101 ) ( 0 -544 -4000 ) ( 431 0 0 ) sound/amb_stereo/Amb_M1_TownExt.mp3
		( 4831 -1407 -100 ) ( 0 -544 0 ) ( 431 0 251 ) sound/amb_stereo/Amb_M1_Interior_01.mp3
		( 4831 -1407 152 ) ( 0 -544 0 ) ( 431 0 4000 ) sound/amb_stereo/Amb_M1_TownExt.mp3
		( 4830 -1407 0 ) ( -1823 -544 -4000 ) ( 0 0 4000 ) sound/amb_stereo/Amb_M1_TownExt.mp3
		( 4831 -1406 0 ) ( -63 0 -4000 ) ( 431 2486 4000 ) sound/amb_stereo/Amb_M1_TownExt.mp3

		( 4767 -575 -271 ) ( -1249 0 -4000 ) ( 0 1655 0 ) sound/amb_stereo/Amb_M1_TownExt.mp3
		( 4767 -575 -270 ) ( -543 0 0 ) ( 0 255 335 ) sound/amb_stereo/Amb_M1_TownExt.mp3
		( 4767 -575 66 ) ( -1249 0 0 ) ( 0 1655 4000 ) sound/amb_stereo/Amb_M1_TownExt.mp3
		( 4767 -576 0 ) ( -2800 -830 -4000 ) ( 0 0 4000 ) sound/amb_stereo/Amb_M1_TownExt.mp3

		( 4224 192 -270 ) ( 0 -511 0 ) ( 543 0 335 ) sound/amb_stereo/Amb_M1_Interior_01.mp3
		( 4223 192 -270 ) ( -704 -767 0 ) ( 0 0 335 ) sound/amb_stereo/Amb_M1_Interior_01.mp3
		( 4223 193 -270 ) ( -704 0 0 ) ( 543 888 335 ) sound/amb_stereo/Amb_M1_TownExt.mp3

		( 3517 -136 0 ) ( -1552 -439 -4000 ) ( 0 0 4000 ) sound/amb_stereo/Amb_M1_TownExt.mp3

		( -220 -355 -161 ) ( -539 0 -4000 ) ( 0 227 0 ) sound/amb_stereo/Amb_M1_Cliff_01.mp3
		( -220 -355 -160 ) ( -539 0 0 ) ( 0 227 335 ) sound/amb_stereo/Amb_M1_Interior_01.mp3
		( -220 -355 176 ) ( -539 0 0 ) ( 0 227 4000 ) sound/amb_stereo/Amb_M1_Cliff_01.mp3
		( -219 -355 0 ) ( 0 0 -4000 ) ( 879 675 4000 ) sound/amb_stereo/Amb_M1_Cliff_01.mp3
		( -220 -356 0 ) ( -539 -8000 -4000 ) ( 880 0 4000 ) sound/amb_stereo/Amb_M1_Cliff_01.mp3

		( -759 -127 0 ) ( 0 0 -4000 ) ( 539 447 4000 ) sound/amb_stereo/Amb_M1_Cliff_01.mp3
		( -760 -127 0 ) ( -8000 -8000 -4000 ) ( 0 0 4000 ) sound/amb_stereo/Amb_M1_Cliff_01.mp3
		( -760 -126 0 ) ( -8000 0 -4000 ) ( 0 1206 4000 ) sound/amb_stereo/Amb_M1_Cliff_01.mp3

		( 1879 4360 -600 ) ( 0 -1161 0 ) ( 625 0 823 ) sound/amb_stereo/Amb_M1_Interior_01.mp3
		( 1878 4360 -600 ) ( -1271 -359 0 ) ( 0 0 823 ) sound/amb_stereo/Amb_M1_Interior_01.mp3

		( 2079 2072 -300 ) ( 0 0 0 ) ( 224 1126 300 ) sound/amb_stereo/Amb_M1_Interior_01.mp3
		( 2078 2072 -300 ) ( -376 0 0 ) ( 0 168 300 ) sound/amb_stereo/Amb_M1_Interior_01.mp3

		( 2078 2241 -300 ) ( -126 0 0 ) ( 0 319 363 ) sound/amb_stereo/Amb_M1_Interior_01.mp3

		( 1023 2304 -9 ) ( -255 0 0 ) ( 0 175 152 ) sound/amb_stereo/Amb_M1_Interior_01.mp3

		( 447 3135 -500 ) ( 0 -1063 0 ) ( 577 0 459 ) sound/amb_stereo/Amb_M1_Interior_01.mp3
		( 1025 2624 -500 ) ( 0 -544 0 ) ( 343 0 459 ) sound/amb_stereo/Amb_M1_Interior_01.mp3
		( 446 3135 -500 ) ( -191 -872 0 ) ( 0 0 490 ) sound/amb_stereo/Amb_M1_Interior_01.mp3

		( 254 3135 -500 ) ( -414 -447 0 ) ( 0 0 604 ) sound/amb_stereo/Amb_M1_Interior_01.mp3

		( -161 2935 -300 ) ( -190 -256 0 ) ( 0 0 284 ) sound/amb_stereo/Amb_M1_Interior_01.mp3

		( 1878 3775 -600 ) ( -182 -576 0 ) ( 0 0 264 ) sound/amb_stereo/Amb_M1_Interior_01.mp3
		( 1792 3198 -600 ) ( 0 -310 0 ) ( 351 0 264 ) sound/amb_stereo/Amb_M1_Interior_01.mp3
	endArray

	exec global/ambience_mp.scr sound/amb_stereo/Amb_M1_Canyon_01.mp3 1 // 0 = no, 1 = keep players' music volume at max.
end

////////////////////////////////////////////////////////////////////////

setup:

	thread cratesstuff vehicles/uboat.tik ( 5620 4810 350 ) ( 0 137 0 ) 1
	waitthread cratesstuff vehicles/uboat.tik ( 5620 4810 1100 ) ( 0 137 0 ) 1 1 path_5	// adding these before "removeclass actor" to stop the errors below from appearing:
	waitthread cratesstuff vehicles/uboat.tik ( 2770 -5065 -150 ) ( 0 226 0 ) 1 1 path_7 	// "Game (Event: 'patrolpath', Object: 'Actor') : There are 0 entities with targetname 'path_7'. You are using a command that requires exactly one."

	level.mapname = getcvar "mapname"
	local.master = spawn scriptmaster
	local.master aliascache door_vault_roll_close sound/mechanics/m6l3a_SlidingDoors_Close.wav soundparms 1.0 0.0 1.0 0.0 160 1600 item loaded maps level.mapname
	local.master aliascache door_vault_open sound/mechanics/door_vault_open.wav soundparms 1.0 0.2 1.0 0.0 160 1600 item loaded maps level.mapname
	local.master aliascache kick_chair1 sound/mechanics/kickchair1.wav soundparms 1.5 0.0 0.8 0.2 160 1600 item loaded maps level.mapname
	local.master aliascache kick_chair2 sound/mechanics/kickchair2.wav soundparms 1.5 0.0 0.8 0.2 160 1600 item loaded maps level.mapname
	local.master aliascache kick_chair3 sound/mechanics/kickchair3.wav soundparms 1.5 0.0 0.8 0.2 160 1600 item loaded maps level.mapname
	local.master aliascache explode_gate sound/weapons/explo/Explo_WoodLarge1.wav soundparms 0.9 0.2 0.8 0.4 1000 8000 weapon loaded maps level.mapname

	removeclass Actor
	removeclass AmmoEntity
	removeclass Health
	removeclass TriggerOnce
	removeclass TriggerUse
	removeclass ScriptOrigin
	removeclass BarrelObject // 20 entities
	removeclass CrateObject // 19 entities
	//removeclass VehicleSoundEntity // this does not work
	//removeclass TurretGun // also removes flak88s
	//removeclass Trigger // this removes many ScriptSlaves, including $doorL or $doorR

	for(local.i = 0; local.i <= 868; local.i++) // this does not remove $doorL or $doorR
	{
		local.entity = getentity(local.i)	
		if(local.entity != NULL && local.entity.classname == Trigger && local.entity.targetname == "") { local.entity remove }
	}

	$t736 remove // these 3 are mg42s. if they aren't removed, shooting with them may cause "Reborn Patch: Possible STWH Detected for [player]! Damage set to 0!" errors
	$t737 remove
	$t738 remove

	$introclip delete	// note for below: info_pathnodes & info_waypoints for AI actors do not count as entities and aren't seen by "getentity()" Reborn command, so they don't need to be removed (only seen in the .bsp)
	//$introdoorL remove	// removing any pathnodes could cause a "recursive error after: Z-Free: freed a pointer without ZONEID" and crash the server. 
	//$introdoorR remove
	//$ossdoorbar remove
	//$ossdoor remove
	$ossdoor dmg 0
	//$ossgun remove // ossgun[1], [2] mp40s
	$getossgun remove
	//$door_early2 remove
	//$door_early remove
	//$left_gate remove
	//$right_gate remove
	$lock remove
	//$enddoor remove
	//$doorB remove
	//$doorA remove
	//$exploder remove
	//$door_locked remove // [1] - [21]
	$explosivespulse100 remove
	$explosivespulse101 remove
	$explosivespulse102 remove
	$explosives101 remove
	$explosives102 remove
	$health1 remove
	$health remove
	//$item_crate remove // item_crate[1], [2], [3] hidden health/ammo crates from original map
	$botcher remove
	$spotsearch remove
	$vent remove
	$pow_gun remove
	$autosave remove
	$enemyspawnertrigger remove
	$interior remove
	$exterior remove
	$endtrigger remove
	$decision1 remove
	$decision2 remove
	$patrol2 remove //; $t5 remove; $t6 remove; $t7 remove; $t8 remove; $t9 remove; $t10 remove	// do not remove these $t entities, otherwise loading this map for the 2nd time gives this error:
	$spotlight remove // $spotlight[1], [2], [3]							// "recursive error after: Z-Free: freed a pointer without ZONEID"
	$spotdamage remove
	$spotcover remove

	//$doorL remove
	//$doorR remove
	//$friendlyexplosive remove
	$explosive notsolid // $explosive[1], [2], [3], [4], [5], [6], [7].
	$explosive[4] remove // for the flak88s in original game
	$explosive[5] remove
	$truck remove
	$latertruck remove
	$t208 remove // invisible player-clip for opeltrucks' collision entities.
	$chairclip remove
	$interchair notsolid
	$interchair.origin = ( 1970 3270 64 )
	$interchair.angles = ( 0 -90 0 )

	$explosives100 show
	$explosives100.angles = ( 0 180 0 )
	$friendlyexplosive.origin = ( 684.25 -675.78 -54 )
	$friendlyexplosive.angles = ( 0 0 0 )

	for(local.e = 1; local.e <= $exploderfire.size; local.e++)
	{
		if($exploderfire[local.e].set != "100") { $exploderfire[local.e] remove; local.e = 1 } // use "100" instead of 100, otherwise some entities may not get removed.
	}

	if(getcvar("g_ubermods") != "1" && getcvar("g_ubermods") != "2")
	{
		$exploder remove
		$explosives100 remove
		$friendlyexplosive remove
	}

	if(getcvar("g_ubermods") == "1" || getcvar("g_ubermods") == "2")
	{
		//local.test = 1
 		// radiusdamage1 origin, radiusdamage2 origin, explosion origin, debris origin, debris angle, smoke1 origin, smoke2 origin, trig setsize1, trig setsize2, ::explode set number, ... 
		// ... damage, radius, smaller (1 = smaller earthquake), trig origin (default = explosion origin), test (1 = spawn lasers around trigger box & emitters at all the origins).
		//
		// Example template: exec global/exploder_killer.scr ( 0 0 0 ) ( 0 0 0 ) 	( 0 0 0 ) ( 0 0 0 ) 0 	( 0 0 0 ) ( 0 0 0 ) 	( 0 0 0 ) ( 0 0 0 ) 1 500 600 0 	( 0 0 0 ) local.test
		//
		// Parameters after "set number" are optional, and will auto-default if left blank.
		//
		//$exploder.origin = ( 704 -672 70 )
		level.exploder_killer_noprint = 1 // applies to all exploders.
		//$exploder[1].grenades = 1
		level.exploder_killer_grenades = 1 // applies to all exploders.

		exec global/exploder_killer.scr ( 604 -672 50 ) ( 804 -672 50 ) ( 704 -672 -50 ) ( 704 -672 210 ) 180 ( 554 -586 -79 ) ( 644 -790 -54 ) ( -175 -160 -30 ) ( 175 160 300 ) 100 500 600 0 ( 704 -672 -50 ) local.test
		thread laserdoor ( .3608 .6627 .0016 ) // color
	}

	if(getcvar("g_ubermods") == "2")
	{
		$flak88a_d remove
		$flak88b_d remove

		thread laserdoorvoid ( .3608 .6627 .0016 )
		thread cardchairs 5 // health

		local.exploder2 = spawn script_origin targetname "exploder" // need a 2nd "exploder" for exploder_killer.scr to work properly (for blowing up the explosives room).
		local.exploder2.origin = ( 2058 3024 -424 )
		local.exploder2.set = 105
		//local.exploder2.grenades = 1

		exec global/exploder_killer.scr ( 1967 3024 -411 ) ( 1967 3327 -411 ) ( 1967 3024 -511 ) ( 1967 3024 -340 ) 270 ( 2086 2892 -511 ) ( 1846 2892 -511 ) ( -176 -144 0 ) ( 176 176 175 ) 105 500 600 0 ( 1967 3024 -511 ) local.test
		thread explosivesroom 500 600
	}

	if(getcvar("g_ubermods") == "1")
	{

		thread flak88_explode1 300 500 600
		thread flak88_explode2 300 500 600

		$spotpath1_1 remove; $t351 remove; $t352 remove; $t353 remove; $t354 remove; $blahblah remove; $t348 remove; $t346 remove; $t349 remove
		$spotpath1_2 remove; $t355 remove; $t720 remove; $t357 remove; $t358 remove; $t779 remove; $t765 remove; $t781 remove; $t767 remove; $t769 remove; $t771 remove; $t773 remove
		$t775 remove; $t777 remove; $t359 remove; $t360 remove; $t361 remove; $t362 remove
		$spotpath1_3 remove; $t336 remove; $t337 remove; $t338 remove; $t339 remove; $t340 remove; $t341 remove; $t342 remove; $t343 remove

		$flak88a_d hide
		$flak88b_d hide

		local.fwd_vec = angles_toforward $flak88a.angles
		local.init_angles = spawn script_origin		// need this entity to initially point the turret towards local.angles
		local.init_angles.origin = trace ($flak88a.origin + local.fwd_vec * 56) ($flak88a.origin + local.fwd_vec * 10240) 0
		$flak88a setaimtarget local.init_angles

		local.fwd_vec2 = angles_toforward $flak88b.angles
		local.init_angles2 = spawn script_origin
		local.init_angles2.origin = trace ($flak88b.origin + local.fwd_vec2 * 56) ($flak88b.origin + local.fwd_vec2 * 10240) 0
		$flak88b setaimtarget local.init_angles2

		local.truck1 = spawn script_model targetname "latertruck2"
	 	local.truck1 model "vehicles/opeltruck.tik"
	 	local.truck1.origin = ( 1525 250 -154 ) 
	 	local.truck1.angles = ( 1.49 130 0.00 )
		local.truck1.scale = 1
		local.truck1 anim stop_wheels
		local.truck1 anim idlenolights

		local.truck2 = spawn script_model targetname "truck2" // made $truck2 a driv
	 	local.truck2 model "vehicles/opeltruck.tik"
	 	local.truck2.origin = ( 1586 2905 -200 )
	 	local.truck2.angles = ( 0 -103 0 )
		local.truck2.scale = 1
		local.truck2 anim stop_wheels
		local.truck2 anim idlenolights
	}
	
	local.ossdoor = spawn trigger_use targetname "ossdoor_trigger"
 	local.ossdoor.origin = ( 5908 -4456 208 )
 	local.ossdoor setsize ( -70 -70 -20 ) ( 70 70 70 )
	local.ossdoor setthread ossdoor_trigger

	local.lockgates = spawn trigger_use targetname "metalgates_trigger"
 	local.lockgates.origin = ( 5888 -1816 5 )
 	local.lockgates setsize ( -70 -70 -20 ) ( 70 70 70 )
	local.lockgates thread maps/gen_mapscripts/doorsgates.scr::metal_gates $left_gate $right_gate 85

	local.woodgates = spawn trigger_use targetname "introdoor_trigger"
 	local.woodgates.origin = ( 5311 -3417 -103 )
 	local.woodgates setsize ( -70 -70 -20 ) ( 70 70 70 )
	local.woodgates thread maps/gen_mapscripts/doorsgates.scr::wood_gates $introdoorL $introdoorR 85

	local.singlegate = spawn trigger_use targetname "doorearly_trigger"
 	local.singlegate.origin = ( 6827 -4545 8 )
 	local.singlegate setsize ( -70 -40 -20 ) ( 40 40 70 )
	local.singlegate thread maps/gen_mapscripts/doorsgates.scr::metal_doors $door_early NIL -85

	local.singlegate2 = spawn trigger_use targetname "doorearly2_trigger"
 	local.singlegate2.origin = ( 6827 -4255 8 )
 	local.singlegate2 setsize ( -70 -40 -20 ) ( 40 40 70 )
	local.singlegate2 thread maps/gen_mapscripts/doorsgates.scr::metal_doors $door_early2 NIL 85

	local.voiddoors = spawn trigger_use targetname "woodgates_trigger"
 	local.voiddoors.origin = ( 4192 -1743 -5 )
 	local.voiddoors setsize ( -120 -70 -20 ) ( 120 120 70 )
	local.voiddoors thread maps/gen_mapscripts/doorsgates.scr::wood_gates $doorL $doorR 85

	local.doorA = spawn trigger_use targetname "wooddoora_trigger"
 	local.doorA.origin = $doorA.origin
 	local.doorA setsize ( -40 -70 -70 ) ( 40 40 70 )
	local.doorA thread maps/gen_mapscripts/doorsgates.scr::wood_doors $doorA NIL 85

	local.doorB = spawn trigger_use targetname "wooddoorb_trigger"
 	local.doorB.origin = $doorB.origin
 	local.doorB setsize ( -40 -40 -70 ) ( 40 70 70 )
	local.doorB thread maps/gen_mapscripts/doorsgates.scr::wood_doors $doorB NIL -85

	local.enddoor = spawn trigger_use targetname "enddoor_trigger"
 	local.enddoor.origin = $enddoor.origin
 	local.enddoor setsize ( -40 -40 -70 ) ( 40 70 70 )
	local.enddoor thread maps/gen_mapscripts/doorsgates.scr::wood_doors $enddoor NIL -85

	exec global/doorlocked.scr ( 6363 -5152 32 ) gateiron
	exec global/doorlocked.scr ( 6593 -4496 -1 ) gatelarge 1
	exec global/doorlocked.scr ( 5155 -2880 -63 ) gateiron
	exec global/doorlocked.scr ( 5928 -881 -31 ) wood 1
	exec global/doorlocked.scr ( 4743 -1104 -151 ) wood 1
	exec global/doorlocked.scr ( 4158 -11 -167 ) wood 1
	exec global/doorlocked.scr ( 3677 -436 -133 ) wood 1
	exec global/doorlocked.scr ( 2831 -223 -127 ) wood 1
	exec global/doorlocked.scr ( 2223 -1000 -71 ) wood 1
	exec global/doorlocked.scr ( 1571 -1178 -19 ) gatelarge 1
	exec global/doorlocked.scr ( 1268 4100 -195 ) wood 1

	exec global/doorlocked.scr ( 6496 -5312 8 ) gateiron
	exec global/doorlocked.scr ( 7520 -5952 40 ) wood
	exec global/doorlocked.scr ( 7048 -5187 18 ) gateiron
	exec global/doorlocked.scr ( 6792 -4776 32 ) gateiron
	exec global/doorlocked.scr ( 5031 -3601 128 ) wood
	exec global/doorlocked.scr ( 3294 -267 -127 ) wood
	exec global/doorlocked.scr ( 3060 -694 -127 ) wood
	exec global/doorlocked.scr ( 95 -385 -103 ) gateiron
	exec global/doorlocked.scr ( -1407 -807 -144 ) gatemetal

	level.springfield = 1								
	level.bar = 1								
	level.bazooka = 1	
	level.mp44 = 1		
	level.shotgun = 1
end

////////////////////////////////////////////////////////////////////////

ossdoor_trigger:

	if($ossdoorbar == NULL || $ossdoor == NULL) { end }

	self nottriggerable
	self.inc++
	if(self.inc == NIL || self.inc > 1) { self.inc = 0 }
	if(self.inc == 0) 
	{ 
		$ossdoorbar playsound door_vault_open
		$ossdoorbar time 0.6
		$ossdoorbar rotatexdown 90
		$ossdoorbar waitmove
		wait 0.42
		$ossdoor time 1.45
		$ossdoor rotateydown 80
		$ossdoor waitmove
		$ossdoor connect_paths
	}
	if(self.inc == 1) 
	{ 
		$ossdoorbar playsound door_vault_roll_close
		$ossdoor time 3.05
		$ossdoor rotateyup 80
		$ossdoor waitmove
		$ossdoor connect_paths
		$ossdoorbar time 0.5
		$ossdoorbar rotatexup 90
		$ossdoorbar waitmove
	}
	self triggerable
end

////////////////////////////////////////////////////////////////////////

laserdoor local.color local.health local.damage local.radius:

	level waittill spawn

	for(local.e = 1; local.e <= $exploder.size; local.e++)
	{
		if($exploder[local.e].set == 100) { local.exploder = $exploder[local.e]; break }
	}

	if(local.exploder == NIL || local.exploder == NULL) { end }

	for(local.s = 1; local.s <= $explodersmashed.size; local.s++)
	{
		if($explodersmashed[local.s].set == 100) { $explodersmashed[local.s].nosound = 1 } // turns off global/exploder.scr's explosion sound, since one exists in this thread already.
	}

	for(local.e = 1; local.e <= $exploder_trigshot.size; local.e++)
	{
		if($exploder_trigshot[local.e].set == 100) { local.explodertrig = $exploder_trigshot[local.e]; break }
	}

	local.laser1 = thread spawnlaser ( 694 -511 206 ) ( 694 -833 206 ) local.color 0.5 "laserwall1"
	local.laser2 = thread spawnlaser ( 694 -511 144 ) ( 694 -833 144 ) local.color 0.5 "laserwall2"
	local.laser3 = thread spawnlaser ( 694 -511 82 ) ( 694 -833 82 ) local.color 0.5 "laserwall3"
	local.laser4 = thread spawnlaser ( 694 -511 20 ) ( 694 -833 20 ) local.color 0.5 "laserwall4"
	local.laser5 = thread spawnlaser ( 694 -511 -42 ) ( 694 -833 -42 ) local.color 0.5 "laserwall5"

	local.trig = spawn trigger_multiple
	local.trig.origin = ( 691 -672 -54 )
	local.trig setsize ( -12 -168 -5 ) ( 37 167 260 )
	local.trig setthread laserdoor_hint

	local.trig2 = spawn trigger_multiple spawnflags 128
	local.trig2.origin = ( 691 -672 -54 )
	local.trig2 setsize ( -12 -168 -5 ) ( 37 167 260 )
	local.trig2.lasercolor = local.color
	local.trig2 setthread laserdoor_shot

	while(local.explodertrig != NIL && local.explodertrig != NULL && local.explodertrig.dead != 1) { waitframe }

	local.debris = thread emitterstuff "emitters/mortar_dirt_nosound.tik"  ( 708 -675.78 -54 ) ( 0 0 0 ) 1.25 start

	local.r = randomint(4)
	if(local.r == 0) { $explosives100 playsound explode_building_large1 }
	if(local.r == 1) { $explosives100 playsound explode_building_large2 }
	if(local.r == 2) { $explosives100 playsound explode_building_large3 }
	if(local.r == 3) { $explosives100 playsound explode_building_large4 }

	local.r2 = randomint(2)
	if(local.r2 == 0) { local.debris playsound explode_wood_small1 }
	if(local.r2 == 1) { local.debris playsound explode_wood_small2 }

	println("----- Blowing up the Laser Barrier.")
	level.laserdoors_dead = 1

	local.trig remove
	local.trig2 remove
	local.laser1 remove
	local.laser2 remove
	local.laser3 remove
	local.laser4 remove
	local.laser5 remove
	$explosives100 remove
	$friendlyexplosive remove

	waitframe
	local.debris remove
end

laserdoor_hint:

	self nottriggerable
	local.player = parm.other
	local.player iprint ("Blow up the laser wall with a grenade.")
	wait 1
	self triggerable
end

laserdoor_shot:

	self nottriggerable
	for(local.c = 1; local.c <= 5; local.c++)
	{
		if($("laserwall" + local.c) != NULL) { $("laserwall" + local.c) color ( 1 0 0 ) }
	}
	waitframe
	for(local.c = 1; local.c <= 5; local.c++)
	{
		if($("laserwall" + local.c) != NULL) { $("laserwall" + local.c) color self.lasercolor }
	}
	if(self != NULL) { self triggerable }
end

////////////////////////////////////////////////////////////////////////

laserdoorvoid local.color:

	level waittill spawn

	if($doorL == NULL || $doorR == NULL) { end }

	local.laser1 = thread spawnlaser ( 4193 -1736 -3 ) ( 4352 -1726 -3 ) local.color 0.5 "laserwallvoid1"
	local.laser2 = thread spawnlaser ( 4193 -1736 130 ) ( 4352 -1726 130 ) local.color 0.5 "laserwallvoid2"
	local.laser3 = thread spawnlaser ( 4193 -1736 260 ) ( 4352 -1726 260 ) local.color 0.5 "laserwallvoid3"
	local.laser4 = thread spawnlaser ( 4191 -1736 -3 ) ( 4032 -1726 -3 ) local.color 0.5 "laserwallvoid4"
	local.laser5 = thread spawnlaser ( 4191 -1736 130 ) ( 4032 -1726 130 ) local.color 0.5 "laserwallvoid5"
	local.laser6 = thread spawnlaser ( 4191 -1736 260 ) ( 4032 -1726 260 ) local.color 0.5 "laserwallvoid6"
	local.laser7 = thread spawnlaser local.laser3.origin (local.laser3.origin + ( 0 0 -300 )) local.color 0.5 "laserwallvoid7"
	local.laser8 = thread spawnlaser local.laser6.origin (local.laser6.origin + ( 0 0 -300 )) local.color 0.5 "laserwallvoid8"

	local.trig = spawn trigger_multiple spawnflags 128
	local.trig.origin = ( 4192 -1743 0 )
	local.trig setsize ( -168 -17 -5 ) ( 167 85 260 )
	local.trig.lasercolor = local.color
	local.trig setthread laserdoorvoid_shot

	thread movevoidlasersR local.laser1 local.laser2 local.laser3 local.laser7
	thread movevoidlasersL local.laser4 local.laser5 local.laser6 local.laser8
end

movevoidlasersL local.laser4 local.laser5 local.laser6 local.laser8:

	local.angles = $doorL.angles
	local.PI = 3.14159265359
	local.origin4 = $doorL.origin + ( 0 0 -123 )
	local.origin5 = $doorL.origin + ( 0 0 10 )
	local.origin6 = $doorL.origin + ( 0 0 140 )

	while($doorL.angles == local.angles) { waitframe }

	if($doorL.inc == NIL || $doorL.inc > 1) { $doorL.inc = 0 }
	while(1)
	{
		local.radians = $doorL.angles[1] * (local.PI / 180)
		local.sin = (sin local.radians) * 159
		local.cos = (cos local.radians) * 159

		local.laser4.origin = local.origin4 + ( local.cos local.sin 0 )
		local.laser5.origin = local.origin5 + ( local.cos local.sin 0 )
		local.laser6.origin = local.origin6 + ( local.cos local.sin 0 )
		local.laser8.origin = local.laser6.origin
		local.laser8 endpoint (local.laser6.origin + ( 0 0 -300 ))

		if($doorL.angles[1] >= 85 && $doorL.inc == 0) { break }
		if($doorL.angles[1] <= 0 && $doorL.inc == 1) { break }
		waitframe
	}
	$doorL.inc++
	thread movevoidlasersL local.laser4 local.laser5 local.laser6 local.laser8
end

movevoidlasersR local.laser1 local.laser2 local.laser3 local.laser7:

	local.angles = $doorR.angles
	local.PI = 3.14159265359
	local.origin1 = $doorR.origin + ( 0 0 -123 )
	local.origin2 = $doorR.origin + ( 0 0 10 )
	local.origin3 = $doorR.origin + ( 0 0 140 )

	while($doorR.angles == local.angles) { waitframe }

	if($doorR.inc == NIL || $doorR.inc > 1) { $doorR.inc = 0 }
	while(1)
	{
		local.radians = $doorR.angles[1] * (local.PI / 180)
		local.sin = (sin local.radians) * -159
		local.cos = (cos local.radians) * -159

		local.laser1.origin = local.origin1 + ( local.cos local.sin 0 )
		local.laser2.origin = local.origin2 + ( local.cos local.sin 0 )
		local.laser3.origin = local.origin3 + ( local.cos local.sin 0 )
		local.laser7.origin = local.laser3.origin
		local.laser7 endpoint (local.laser3.origin + ( 0 0 -300 ))

		if($doorR.angles[1] <= -85 && $doorR.inc == 0) { break }
		if($doorR.angles[1] >= 0 && $doorR.inc == 1) { break }
		waitframe
	}
	$doorR.inc++
	thread movevoidlasersR local.laser1 local.laser2 local.laser3 local.laser7
end

laserdoorvoid_shot:

	if($doorL.angles[1] > 45) { end }

	self nottriggerable
	for(local.c = 1; local.c <= 8; local.c++)
	{
		if($("laserwallvoid" + local.c) != NULL) { $("laserwallvoid" + local.c) color ( 1 0 0 ) }
	}
	waitframe
	for(local.c = 1; local.c <= 8; local.c++)
	{
		if($("laserwallvoid" + local.c) != NULL) { $("laserwallvoid" + local.c) color self.lasercolor }
	}
	if(self != NULL) { self triggerable }
end

////////////////////////////////////////////////////////////////////////

explosivesroom local.damage local.radius:

	level waittill spawn

	for(local.e = 1; local.e <= $exploder_trigshot.size; local.e++)
	{
		if($exploder_trigshot[local.e].set == 105) { local.explodertrig = $exploder_trigshot[local.e]; break }
	}

	while(local.explodertrig != NIL && local.explodertrig != NULL && local.explodertrig.dead != 1) { waitframe }
	
	println("----- Blowing up the Explosives Room.")

	wait (randomint(25) / 100.000 + 0.25)
	thread explosivesroom_boom ( 2009 3078 -510 ) local.damage local.radius
	radiusdamage ( 2009 3078 -410 ) local.damage local.radius
	exec global/earthquake.scr .35 2 0 0

	wait (randomint(25) / 100.000 + 0.25)
	thread explosivesroom_boom ( 2182 3307 -511 ) local.damage local.radius
	radiusdamage ( 2182 3307 -410 ) local.damage local.radius
	exec global/earthquake.scr .35 2 0 0

	wait (randomint(25) / 100.000 + 0.25)
	thread explosivesroom_boom ( 1745 3718 -511 ) local.damage local.radius
	radiusdamage ( 1745 3718 -410 ) local.damage local.radius
	exec global/earthquake.scr .35 2 0 0

	waitframe
	if($explosive != NULL) { $explosive remove }
end

explosivesroom_boom local.origin local.damage local.radius:

	local.explode = thread emitterstuff "animate//fx_mortar_higgins.tik" local.origin ( 0 0 0 ) 0.45 start //"fx/fx_flak88_explosion.tik"
	local.debris = thread emitterstuff "emitters/mortar_dirt_nosound.tik" local.origin ( 0 0 0 ) 1 start

	local.r1 = randomint(5)
	if(local.r1 == 0) { local.explode playsound explode_building_small1 }
	if(local.r1 == 1) { local.explode playsound explode_building_small2 }
	if(local.r1 == 2) { local.explode playsound explode_building_small3 }
	if(local.r1 == 3) { local.explode playsound explode_building_small4 }
	if(local.r1 == 4) { local.explode playsound explode_building_small5 }

	local.r2 = randomint(2)
	if(local.r2 == 0) { local.debris playsound explode_wood_small1 }
	if(local.r2 == 1) { local.debris playsound explode_wood_small2 }

	waitframe
	local.explode remove
	local.debris remove
end

////////////////////////////////////////////////////////////////////////

flak88_explode1 local.health local.damage local.radius:

	level waittill spawn

	if($flak88a == NULL || $flak88a_d == NULL) { end }

	local.tank = spawn "vehicles/tigertank.tik"
	local.tank.origin = ( -900 -3265 -310 )	  
	local.tank.angles = ( 0 -90 0 )
	local.tank.health = local.health
	local.tank.scale = 0.1
	local.tank notsolid
	local.tank hide

	local.tank2 = spawn "vehicles/tigertank.tik"
	local.tank2.origin = ( -900 -3445 -310 )	  
	local.tank2.angles = ( 0 -90 0 )
	local.tank2.health = local.health
	local.tank2.scale = 0.1
	local.tank2 notsolid
	local.tank2 hide

	while(local.tank != NULL && local.tank2 != NULL) { waitframe }

	local.explode = spawn script_model
	local.explode model "animate//fx_mortar_higgins.tik" //"fx/fx_flak88_explosion.tik"
	local.explode.origin = $flak88a_d.origin
	local.explode.scale = 1.1
	local.explode anim start

	local.debris = spawn script_model
	local.debris model "emitters/mortar_dirt_nosound.tik" 
	local.debris.origin = $flak88a_d.origin
	local.debris notsolid
	local.debris.scale = 1.25
	local.debris anim start

	local.r = randomint(5)
	if(local.r == 0) { local.explode playsound explode_building_large3 } // all metal explosion sounds
	if(local.r == 1) { local.explode playsound explode_building_small4 }
	if(local.r == 2) { local.explode playsound explode_building_small5 }
	if(local.r == 3) { local.explode playsound explode_building_large4 }
	if(local.r == 4) { local.explode playsound explode_building_small3 }

	local.r2 = randomint(2)
	if(local.r2 == 0) { local.debris playsound explode_wood_small1 }
	if(local.r2 == 1) { local.debris playsound explode_wood_small2 }
	
	exec global/earthquake.scr .35 2 0 0
	radiusdamage $flak88a_d.origin local.damage local.radius
	$flak88a_d.angles = ( 0 $flak88a.angles[1] 0 )
	$flak88a remove
	$flak88a_d show
	println("----- Blowing up Flak88 A.")

	waitframe
	if(local.tank != NULL) { local.tank remove }
	if(local.tank2 != NULL) { local.tank2 remove }
	local.explode remove
	local.debris remove
end

flak88_explode2 local.health local.damage local.radius:

	level waittill spawn

	if($flak88b == NULL || $flak88b_d == NULL) { end }

	local.tank = spawn "vehicles/tigertank.tik"
	local.tank.origin = ( -1465 -3265 -310 )	  
	local.tank.angles = ( 0 -90 0 )
	local.tank.health = local.health
	local.tank.scale = 0.1
	local.tank notsolid
	local.tank hide

	local.tank2 = spawn "vehicles/tigertank.tik"
	local.tank2.origin = ( -1465 -3445 -310 )	  
	local.tank2.angles = ( 0 -90 0 )
	local.tank2.health = local.health
	local.tank2.scale = 0.1
	local.tank2 notsolid
	local.tank2 hide

	while(local.tank != NULL && local.tank2 != NULL) { waitframe }

	local.explode = spawn script_model
	local.explode model "animate//fx_mortar_higgins.tik"
	local.explode.origin = $flak88b_d.origin
	local.explode.scale = 1.1
	local.explode anim start

	local.debris = spawn script_model
	local.debris model "emitters/mortar_dirt_nosound.tik" 
	local.debris.origin = $flak88b_d.origin
	local.debris notsolid
	local.debris.scale = 1.25
	local.debris anim start

	local.r = randomint(5)
	if(local.r == 0) { local.explode playsound explode_building_large3 }
	if(local.r == 1) { local.explode playsound explode_building_small4 }
	if(local.r == 2) { local.explode playsound explode_building_small5 }
	if(local.r == 3) { local.explode playsound explode_building_large4 }
	if(local.r == 4) { local.explode playsound explode_building_small3 }

	local.r2 = randomint(2)
	if(local.r2 == 0) { local.debris playsound explode_wood_small1 }
	if(local.r2 == 1) { local.debris playsound explode_wood_small2 }
	
	exec global/earthquake.scr .35 2 0 0
	radiusdamage $flak88b_d.origin local.damage local.radius
	$flak88b_d.angles = ( 0 $flak88b.angles[1] 0 )
	$flak88b remove
	$flak88b_d show
	println("----- Blowing up Flak88 B.")

	waitframe
	if(local.tank != NULL) { local.tank remove }
	if(local.tank2 != NULL) { local.tank2 remove }
	local.explode remove
	local.debris remove	
end

////////////////////////////////////////////////////////////////////////

jitter_large:

	waitexec global/earthquake.scr .35 10 0 0
	waitexec global/earthquake.scr .23 6 0 0
	waitexec global/earthquake.scr 1 1 0 0
	waitexec global/earthquake.scr 1.25 .3 0 1
end

////////////////////////////////////////////////////////////////////////

cardchairs local.health:

	level waittill spawn

	if($cardgame == NULL) { end }

	local.chair1 = spawn script_model targetname "patrol_g1"
	local.chair1 model "furniture/cardchair.tik"
	local.chair1.origin = ( 5627 -4469 -32 ) // patrol_g1[1].origin
	local.chair1.angles = ( 0 285 0 )
	local.chair2 = spawn script_model targetname "patrol_g1"
	local.chair2 model "furniture/cardchair.tik"
	local.chair2.origin = ( 5649 -4562 -32 ) // patrol_g1[2].origin
	local.chair2.angles = ( 0 105 0 )
	local.chair3 = spawn script_model targetname "patrol_g1"
	local.chair3 model "furniture/cardchair.tik"
	local.chair3.origin = ( 5702 -4493 -32 ) // patrol_g1[3].origin
	local.chair3.angles = ( 0 195 0 )

	local.trig = spawn trigger_multiple spawnflags 128
	local.trig.origin = ( 5636 -4510 -30 )
	local.trig setsize ( -50 -50 -10 ) ( 50 50 50 )
	local.trig.health = 125
	local.trig thread trig_healthboost

	while(local.trig.health > 0) { waitframe }

	local.trig remove
	local.r1 = randomint(2)
	local.r2 = randomint(2)
	local.r3 = randomint(2)
	if(local.r1 == 0) { local.chair1 anim chair_death_backwards }
	if(local.r1 == 1) { local.chair1 anim chair_alert_stand }
	if(local.r2 == 0) { local.chair2 anim chair_death_backwards }
	if(local.r2 == 1) { local.chair2 anim chair_alert_stand }
	if(local.r3 == 0) { local.chair3 anim chair_death_backwards }
	if(local.r3 == 1) { local.chair3 anim chair_alert_stand }
	local.chair1 notsolid
	local.chair2 notsolid
	local.chair3 notsolid
	local.chair1 playsound kick_chair
	local.chair2 playsound kick_chair
	local.chair3 playsound kick_chair
end

trig_healthboost: // shotgun: 340 damage, bazooka: 105 damage, sniper: 106 damage, one grenade: 200 damage, two grenades: 400 damage

	local.health = self.health
	while(self != NULL && self.health > 0) // prevent regular bullets from killing trigger (i.e. if 250 health, trigger can still be killed by 2 grenades or a shotgun blast)
	{
		self.health = local.health
		waitframe
	}
end

////////////////////////////////////////////////////////////////////////

twoswitch local.name local.origin local.angles local.offtime local.damageradius local.pulsatingoff:

	local.switch = spawn script_model targetname ("twoswitch_" + local.name)
	local.switch model "animate/alarmswitch.tik"
	local.switch.origin = local.origin
	local.switch.angles = local.angles
	local.switch notsolid

	local.switchtrig = spawn trigger_use targetname ("twoswitchtrig_" + local.name)
	local.switchtrig.origin = local.switch.origin
	local.switchtrig setsize ( -20 -20 -20 ) ( 20 20 20 )

	local.switchtrig waittill trigger
	local.switchtrig nottriggerable
	local.switch anim turnon
	local.switch playsound alarmswitch

	if(local.name == "sw1" || local.name == "sw2") { local.set = "sw12" }
	if(local.name == "sw3" || local.name == "sw4") { local.set = "sw34" }
	if(local.name == "sw5" || local.name == "sw6") { local.set = "sw56" }

	if(level.trenchblewup[local.set] != 1)
	{
	 	local.player = parm.other
	 	local.switchtrig message ("*** Blowing up some bangalores. ***")
		level.trenchblewup[local.set] = 1 // keep other nontriggered switch nottriggerable until local.offtime ends.
	
		if(local.name == "sw1")
		{	
			thread otherswitch_animonly sw2 turnon

			wait (randomint(50) / 100.00 + 0.25)
			local.player thread maps/training_mapscripts/bangalore_wallbomb.scr::blowup bb31 local.offtime local.damageradius local.pulsatingoff // offtime only works if using waitthread.
			wait (randomint(100) / 100.00 + 0.25)
			local.player thread maps/training_mapscripts/bangalore_wallbomb.scr::blowup bb32 local.offtime local.damageradius local.pulsatingoff
			wait (randomint(100) / 100.00 + 0.25)
			local.player waitthread maps/training_mapscripts/bangalore_wallbomb.scr::blowup bb33 local.offtime local.damageradius local.pulsatingoff // waits "local.offtime" seconds after blowing up
		}
		if(local.name == "sw2")
		{
			thread otherswitch_animonly sw1 turnon

			wait (randomint(50) / 100.00 + 0.25)
			local.player thread maps/training_mapscripts/bangalore_wallbomb.scr::blowup bb33 local.offtime local.damageradius local.pulsatingoff
			wait (randomint(100) / 100.00 + 0.25)
			local.player thread maps/training_mapscripts/bangalore_wallbomb.scr::blowup bb32 local.offtime local.damageradius local.pulsatingoff
			wait (randomint(100) / 100.00 + 0.25)
			local.player waitthread maps/training_mapscripts/bangalore_wallbomb.scr::blowup bb31 local.offtime local.damageradius local.pulsatingoff
		}
		if(local.name == "sw3")
		{	
			thread otherswitch_animonly sw4 turnon

			wait (randomint(50) / 100.00 + 0.25)
			local.player thread maps/training_mapscripts/bangalore_wallbomb.scr::blowup bb41 local.offtime local.damageradius local.pulsatingoff // offtime only works if using waitthread.
			wait (randomint(100) / 100.00 + 0.25)
			local.player thread maps/training_mapscripts/bangalore_wallbomb.scr::blowup bb42 local.offtime local.damageradius local.pulsatingoff
			wait (randomint(100) / 100.00 + 0.25)
			local.player waitthread maps/training_mapscripts/bangalore_wallbomb.scr::blowup bb43 local.offtime local.damageradius local.pulsatingoff // waits "local.offtime" seconds after blowing up
		}
		if(local.name == "sw4")
		{
			thread otherswitch_animonly sw3 turnon

			wait (randomint(50) / 100.00 + 0.25)
			local.player thread maps/training_mapscripts/bangalore_wallbomb.scr::blowup bb43 local.offtime local.damageradius local.pulsatingoff
			wait (randomint(100) / 100.00 + 0.25)
			local.player thread maps/training_mapscripts/bangalore_wallbomb.scr::blowup bb42 local.offtime local.damageradius local.pulsatingoff
			wait (randomint(100) / 100.00 + 0.25)
			local.player waitthread maps/training_mapscripts/bangalore_wallbomb.scr::blowup bb41 local.offtime local.damageradius local.pulsatingoff
		}
		if(local.name == "sw5")
		{	
			thread otherswitch_animonly sw6 turnon

			wait (randomint(50) / 100.00 + 0.25)
			local.player thread maps/training_mapscripts/bangalore_wallbomb.scr::blowup bb52 local.offtime local.damageradius local.pulsatingoff // offtime only works if using waitthread.
			wait (randomint(100) / 100.00 + 0.25)
			local.player thread maps/training_mapscripts/bangalore_wallbomb.scr::blowup bb53 local.offtime local.damageradius local.pulsatingoff
			wait (randomint(100) / 100.00 + 0.25)
			local.player thread maps/training_mapscripts/bangalore_wallbomb.scr::blowup bb54 local.offtime local.damageradius local.pulsatingoff
			wait (randomint(100) / 100.00 + 0.25)
			local.player waitthread maps/training_mapscripts/bangalore_wallbomb.scr::blowup bb55 local.offtime local.damageradius local.pulsatingoff // waits "local.offtime" seconds after blowing up
		}
		if(local.name == "sw6")
		{
			thread otherswitch_animonly sw5 turnon

			wait (randomint(50) / 100.00 + 0.25)
			local.player thread maps/training_mapscripts/bangalore_wallbomb.scr::blowup bb54 local.offtime local.damageradius local.pulsatingoff
			wait (randomint(100) / 100.00 + 0.25)
			local.player thread maps/training_mapscripts/bangalore_wallbomb.scr::blowup bb53 local.offtime local.damageradius local.pulsatingoff
			wait (randomint(100) / 100.00 + 0.25)
			local.player thread maps/training_mapscripts/bangalore_wallbomb.scr::blowup bb52 local.offtime local.damageradius local.pulsatingoff
			wait (randomint(100) / 100.00 + 0.25)
			local.player waitthread maps/training_mapscripts/bangalore_wallbomb.scr::blowup bb51 local.offtime local.damageradius local.pulsatingoff
		}

		level.trenchblewup[local.set] = 0
	}

	if(local.name == "sw1") { thread otherswitch_animonly sw2 turnoff }
	if(local.name == "sw2") { thread otherswitch_animonly sw1 turnoff }
	if(local.name == "sw3") { thread otherswitch_animonly sw4 turnoff }
	if(local.name == "sw4") { thread otherswitch_animonly sw3 turnoff }
	if(local.name == "sw5") { thread otherswitch_animonly sw6 turnoff }
	if(local.name == "sw6") { thread otherswitch_animonly sw5 turnoff }
	local.switch anim turnoff

	wait 1
	waitframe
	local.switch remove
	local.switchtrig remove

	thread twoswitch local.name local.origin local.angles local.offtime local.damageradius local.pulsatingoff
end

otherswitch_animonly local.name local.anim:

	if(local.anim == "turnon")
	{
		$("twoswitchtrig_" + local.name) nottriggerable
		$("twoswitch_" + local.name) anim turnon
		$("twoswitch_" + local.name) playsound alarmswitch
	}
	if(local.anim == "turnoff")
	{
		$("twoswitchtrig_" + local.name) triggerable
		$("twoswitch_" + local.name) anim turnoff
	}
end

////////////////////////////////////////////////////////////////////////

spotlight_colorswitch_auto local.origin local.angles local.type:

	local.switch = spawn script_model
	local.switch model "animate/alarmswitch.tik"
	local.switch.origin = local.origin
	local.switch.angles = local.angles
	local.switch notsolid

	local.switchtrig = spawn trigger_use
	local.switchtrig.origin = local.switch.origin
	local.switchtrig setsize ( -20 -20 -20 ) ( 20 20 20 )

	local.switchtrig waittill trigger
	local.switchtrig nottriggerable
	local.switch playsound alarmswitch
	local.switch anim turnon

	if(local.type == NIL || local.type != "slower")
	{
		level.spotlight_rainbow[s_auto0] = 1
		level.spotlight_rainbow[s_auto1] = 1
		level.spotlight_rainbow[s_auto2] = 1
		local.switchtrig message ("*** Rainbow auto_spotlight colors turned ON. ***")
	}
	if(local.type == "slower")
	{
		local.switchtrig message ("*** Slower rainbow auto_spotlight colors turned ON. ***")
		local.switch thread slow_rainbowcolor_spotlight s_auto0
		local.switch thread slow_rainbowcolor_spotlight s_auto1
		local.switch thread slow_rainbowcolor_spotlight s_auto2
	}

	local.player = parm.other
	local.switchtrig triggerable

	local.switchtrig waittill trigger
	if(local.type == NIL || local.type != "slower") { local.switchtrig message ("*** Rainbow auto_spotlight colors turned OFF. ***") }
	if(local.type == "slower") { local.switchtrig message ("*** Slower rainbow auto_spotlight colors turned OFF. ***") }
	local.switchtrig nottriggerable

	local.switch playsound alarmswitch
	local.switch anim turnoff
	level.spotlight_rainbow[s_auto0] = 0
	level.spotlight_rainbow[s_auto1] = 0
	level.spotlight_rainbow[s_auto2] = 0
	wait 1

	local.switch remove
	local.switchtrig remove

	thread spotlight_colorswitch_auto local.origin local.angles local.type
end

slow_rainbowcolor_spotlight local.name:

	while(self != NULL)
	{
		level.spotlight_rainbow[local.name] = 2
		wait (randomint(100) / 100.0000)
		if(self != NULL) { level.spotlight_rainbow[local.name] = 1 }
		waitframe
	}
	level.spotlight_rainbow[local.name] = 0
end

////////////////////////////////////////////////////////////////////////

vehicle_tele local.distance:
	
	local.trig = spawn trigger_multiple
	local.trig.origin = ( 691 -672 -54 )
 	local.trig setsize ( -20 -168 -10 ) ( 20 167 260 )

	while(level.laserdoors_dead != 1) { wait 1 }

	local.PI = 3.14159265359
	while(local.trig != NULL)
	{
		for(local.a = 0; local.a <= level.drivable_entities.size; local.a++)
		{
			for(local.s = 1; $(level.drivable_entities[local.a]) != NULL && local.s <= $(level.drivable_entities[local.a]).size; local.s++)
			{
				if($(level.drivable_entities[local.a])[local.s] != NULL && $(level.drivable_entities[local.a])[local.s] istouching local.trig && $(level.drivable_entities[local.a])[local.s].driver != NIL && $(level.drivable_entities[local.a])[local.s] cansee local.trig 25)
				{
					local.degrees = $(level.drivable_entities[local.a])[local.s].angles[1]
					if(local.degrees >= 180) { local.degrees -= 360 }
					local.radians = local.degrees * (local.PI / 180)

					local.sin = (sin local.radians) * local.distance
					local.cos = (cos local.radians) * local.distance
					$(level.drivable_entities[local.a])[local.s].origin += ( local.cos local.sin 30 )
				}
			}
		}
		waitframe
	}
end

vehicle_tele2 local.distance:
	
	local.trig = spawn trigger_multiple
	local.trig.origin = ( 1537 2140 -202 )
 	local.trig setsize ( -170 -100 -10 ) ( 170 100 260 )

	local.PI = 3.14159265359
	while(local.trig != NULL)
	{
		for(local.a = 0; local.a <= level.drivable_entities.size; local.a++)
		{
			for(local.s = 1; $(level.drivable_entities[local.a]) != NULL && local.s <= $(level.drivable_entities[local.a]).size; local.s++)
			{
				if($(level.drivable_entities[local.a])[local.s] != NULL && $(level.drivable_entities[local.a])[local.s] istouching local.trig && $(level.drivable_entities[local.a])[local.s].driver != NIL && $(level.drivable_entities[local.a])[local.s] cansee local.trig 25)
				{
					local.degrees = $(level.drivable_entities[local.a])[local.s].angles[1]
					if(local.degrees >= 180) { local.degrees -= 360 }
					local.radians = local.degrees * (local.PI / 180)

					local.sin = (sin local.radians) * local.distance
					local.cos = (cos local.radians) * local.distance
					$(level.drivable_entities[local.a])[local.s].origin += ( local.cos local.sin 30 )
				}
			}
		}
		waitframe
	}
end

////////////////////////////////////////////////////////////////////////
//*** --------------------------------------------
//*** "Bomber Plane Airstrikes"
//*** --------------------------------------------

// plane angles = ( pitch, yaw, roll )
// +pitch = nose down, -pitch = nose up
// +roll = raise left wing, -roll = raise right wing
// yaw = "coord" player angles: ( 0 yaw 0 )

splinepath:

	spawn info_splinepath targetname bomberpath
	$bomberpath.origin = ( -3570 -4975 1120 ) // z - 40 below skybox ceiling
	$bomberpath.angles = ( -5 47 15 )
	$bomberpath speed 3

	spawn info_splinepath targetname a0
	$a0.origin = ( -3070 -4475 1120 )
	$a0.angles = ( -5 47 15 )
	$a0 speed 1

	spawn info_splinepath targetname a1
	$a1.origin = ( -92 -1235 1120 )
	$a1.angles = ( -5 47 0 )
	$a1 speed 1

	spawn info_splinepath targetname a2
	$a2.origin = ( 1535 535 1120 )
	$a2.angles = ( -5 62 -70 )
	$a2 speed 1.2

	spawn info_splinepath targetname a3
	$a3.origin = ( 1535 3293 1120 )
	$a3.angles = ( -5 112 -70 )
	$a3 speed 1.25

	spawn info_splinepath targetname a4
	$a4.origin = ( 245 4692 1120 )
	$a4.angles = ( -5 150 -65 )
	$a4 speed 1.2

	spawn info_splinepath targetname a5
	$a5.origin = ( -3131 6573 1120 )
	$a5.angles = ( -5 150 -25 )
	$a5 speed 0.9

	spawn info_splinepath targetname a6
	$a6.origin = ( -3631 7073 1120 )
	$a6.angles = ( -5 150 -25 )
	$a6 speed 3

	$bomberpath.target = $a0
	$a0.target = $a1
	$a1.target = $a2
	$a2.target = $a3
	$a3.target = $a4
	$a4.target = $a5
	$a5.target = $a6
end

splinepath2:

	spawn info_splinepath targetname bomberpath2
	$bomberpath2.origin = ( -6752 3374 1120 )
	$bomberpath2.angles = ( -5 -45 -15 )
	$bomberpath2 speed 3

	spawn info_splinepath targetname b0
	$b0.origin = ( -6252 2874 1120 )
	$b0.angles = ( -5 -45 -15 )
	$b0 speed 1

	spawn info_splinepath targetname b1
	$b1.origin = ( -2400 -900 1120 )
	$b1.angles = ( -5 -25 -65 )
	$b1 speed 1

	spawn info_splinepath targetname b2
	$b2.origin = ( -150 -900 1120 )
	$b2.angles = ( -5 52 -65 )
	$b2 speed 1

	spawn info_splinepath targetname b3
	$b3.origin = ( 1698 1528 1120 )
	$b3.angles = ( -5 52 0 )
	$b3 speed 1

	spawn info_splinepath targetname b4
	$b4.origin = ( 3371 3724 1120 )
	$b4.angles = ( -5 43 65 )
	$b4 speed 1

	spawn info_splinepath targetname b5
	$b5.origin = ( 6591 5980 1120 )
	$b5.angles = ( -5 30 20 )
	$b5 speed 1

	spawn info_splinepath targetname b6
	$b6.origin = ( 7091 6480 1120 )
	$b6.angles = ( -5 30 20 )
	$b6 speed 3

	$bomberpath2.target = $b0
	$b0.target = $b1
	$b1.target = $b2
	$b2.target = $b3
	$b3.target = $b4
	$b4.target = $b5
	$b5.target = $b6
end

splinepath3:

	spawn info_splinepath targetname bomberpath3
	$bomberpath3.origin = ( 5020 -7325 1400 )
	$bomberpath3.angles = ( 30 90 0 )
	$bomberpath3 speed 3

	spawn info_splinepath targetname c0
	$c0.origin = ( 5020 -6825 1400 )
	$c0.angles = ( 30 90 0 )
	$c0 speed 1.7

	spawn info_splinepath targetname c1
	$c1.origin = ( 5020 -5763 950 )
	$c1.angles = ( 15 90 0 )
	$c1 speed 1.4

	spawn info_splinepath targetname c2
	$c2.origin = ( 5020 -3350 480 )
	$c2.angles = ( -5 90 0 )
	$c2 speed 1.1

	spawn info_splinepath targetname c3
	$c3.origin = ( 5020 0 480 )
	$c3.angles = ( -5 90 -15 )
	$c3 speed 1.1

	spawn info_splinepath targetname c4
	$c4.origin = ( 4792 1171 480 )
	$c4.angles = ( -5 101 -35 )
	$c4 speed 1.5

	spawn info_splinepath targetname c5
	$c5.origin = ( 4792 1671 480 )
	$c5.angles = ( -5 101 -35 )
	$c5 speed 3

	$bomberpath3.target = $c0
	$c0.target = $c1
	$c1.target = $c2
	$c2.target = $c3
	$c3.target = $c4
	$c4.target = $c5
end

splinepath4:

	spawn info_splinepath targetname bomberpath4
	$bomberpath4.origin = ( 3012 -7325 1400 )
	$bomberpath4.angles = ( 30 79 0 )
	$bomberpath4 speed 3

	spawn info_splinepath targetname d0
	$d0.origin = ( 3012 -6825 1400 )
	$d0.angles = ( 30 80 0 )
	$d0 speed 1.7

	spawn info_splinepath targetname d1
	$d1.origin = ( 3200 -5763 950 )
	$d1.angles = ( 15 80 0 )
	$d1 speed 1.7

	spawn info_splinepath targetname d2
	$d2.origin = ( 3600 -3350 705 )
	$d2.angles = ( 15 75 45 )
	$d2 speed 1.5

	spawn info_splinepath targetname d3
	$d3.origin = ( 4300 -2350 480 )
	$d3.angles = ( -5 15 65 )
	$d3 speed 1.2

	spawn info_splinepath targetname d4
	$d4.origin = ( 6344 -2175 480 )
	$d4.angles = ( -5 5 -15 )
	$d4 speed 1.2

	spawn info_splinepath targetname d5
	$d5.origin = ( 7575 -2016 480 )
	$d5.angles = ( -5 12 -40 )
	$d5 speed 1.8

	spawn info_splinepath targetname d6
	$d6.origin = ( 8075 -2016 480 )
	$d6.angles = ( -5 12 -40 )
	$d6 speed 3

	$bomberpath4.target = $d0
	$d0.target = $d1
	$d1.target = $d2
	$d2.target = $d3
	$d3.target = $d4
	$d4.target = $d5
	$d5.target = $d6
end

bomberplane local.team local.position local.offtime local.bombsoff local.bulletstokill local.killtime:

 if(level.airspace_toobusy != 1)
 {
	waitframe // need this, so two "bomberplane" threads can begin before airspace_toobusy = 1 in the 1st thread.
	level.airspace_toobusy = 1

	if(local.offtime > 0 && local.offtime != NIL) { wait local.offtime }
	while($airstrike_bomberplane != NULL) { waitframe } // wait until airspace is not busy anymore

	local.plane = spawn script_model targetname "auto_bomberplane"
	if(local.team == "allies")
	{
		local.plane model "vehicles/p47fly.tik"
		if(local.position == "first") { local.plane.origin = $bomberpath2.origin; local.plane.angles = $bomberpath2.angles; local.plane followpath $bomberpath2 }
		if(local.position == "second") { local.plane.origin = $bomberpath.origin; local.plane.angles = $bomberpath.angles; local.plane followpath $bomberpath }
	}
	if(local.team == "axis")
	{
		local.plane model "vehicles/fockwulffly.tik"
		if(local.position == "first") { local.plane.origin = $bomberpath3.origin; local.plane.angles = $bomberpath3.angles; local.plane followpath $bomberpath3 }
		if(local.position == "second") { local.plane.origin = $bomberpath4.origin; local.plane.angles = $bomberpath4.angles; local.plane followpath $bomberpath4 }
	}

	local.plane.scale = 1
	local.plane notsolid
	local.plane show
	local.plane.team = local.team
	local.teampos = local.team + local.position

	local.plane thread damagetrigger local.teampos local.bulletstokill
	local.plane thread killplane local.teampos local.killtime

	local.plane playsound airplane_flyover
	local.plane loopsound airplane_idle

	if(local.position != "second" && local.bombsoff != 1) 
	{ 
		if(local.team == "allies") { iprintlnbold "*** Allies Airstrike Carpet Bomb Incoming! Take Cover! ***"; println("----- Allies Airstrike Carpet Bomb Incoming!") }
		if(local.team == "axis") { iprintlnbold "*** Axis Airstrike Carpet Bomb Incoming! Take Cover! ***"; println("----- Axis Airstrike Carpet Bomb Incoming!") }
	}

	if(local.bombsoff != 1) 
	{ 
		if(local.team == "allies") { local.plane thread bombdropcoords2 local.position }  // drop bombs from the planes, coords are preset in dropbombcoords.
		if(local.team == "axis") { local.plane thread bombdropcoords local.position }
	}
	if(local.position == "second") { wait 0.4 } // second allies/axis plane waits 0.4 seconds before beginning "waitmove".
	local.plane waitmove

	local.plane stoploopsound
	local.plane remove
	level.airspace_toobusy = 0

	thread bomberplane local.team local.position local.offtime local.bombsoff local.bulletstokill local.killtime								       
 }
end

damagetrigger local.teampos local.bulletstokill:

	local.trigger = spawn trigger_multiple spawnflags 128 // only responds to bullets and explosions occuring near them
	local.trigger.origin = self.origin
	local.trigger setsize ( -300 -300 -100 ) ( 300 300 100 )
	local.trigger.triggered = 0
	local.trigger setthread triggered

	if(local.bulletstokill == NIL || local.bulletstokill < 1) { local.bulletstokill = 7 } // default = 7 bullets

	level.planedead[local.teampos] = 0
	
	while(self != NULL && level.planedead[local.teampos] == 0) 
	{ 
		local.player = parm.other	   // since multiple flying bombs will have the same targetname, the if-statement below will account for any & all
		local.trigger.origin = self.origin // make sure the trigger stays on the plane.  	    // bombs (light bombs, giant bombs) flying in the air.

		if(local.trigger.triggered >= local.bulletstokill) { level.planedead[local.teampos] = 1 }
		if(local.player != NULL && local.trigger istouching local.player) { local.player volumedamage 999 } // kill any player that touches the plane

		for(local.p = 0; local.p <= $player.size; local.p++)
		{
			if($("bigbombweap" + local.p) != NULL && local.trigger istouching $("bigbombweap" + local.p)) { level.planedead[local.teampos] = 2 }
			if($("lightbombweap" + local.p) != NULL && local.trigger istouching $("lightbombweap" + local.p)) { level.planedead[local.teampos] = 2 }
		}
		waitframe
	}
	local.trigger remove 
end

triggered: // if the plane gets shot or otherwise triggered 7+ times, then kill the plane.

	self.triggered++
end

killplane local.teampos local.killtime:

	if(local.killtime == NIL) { local.killtime = 2.5 } // default = 2.5 seconds
	
	while(level.planedead[local.teampos] != 1 && level.planedead[local.teampos] != 2) { waitframe; if(self == NULL) { end } }
	
	if(level.planedead[local.teampos] == 1)
	{
		local.flyingexplosion = spawn script_model
		local.flyingexplosion model "emitters/fire.tik"
		local.flyingexplosion.origin = self.origin
		local.flyingexplosion.scale = 1	
		local.flyingexplosion anim start
		local.flyingexplosion notsolid
		local.flyingexplosion glue self

		local.flyingsmoke = spawn script_model
		local.flyingsmoke model "emitters/planesmokefly.tik"	
		local.flyingsmoke.origin = self.origin
		local.flyingsmoke.scale = 1		
		local.flyingsmoke anim start
		local.flyingsmoke notsolid
		local.flyingsmoke glue self
		
		local.killtime = local.killtime * 10
		local.n = 0

		while(self != NULL && local.n < local.killtime) // change these map edge if-statements per map, and change local.exp.origin respectively
		{
			if(local.teampos == "alliesfirst" && self.origin[0] <= $a5.origin[0] && self.origin[1] >= $a5.origin[1]) { local.outofmap = 1; waitframe; break } // break early if plane touches the map's edge
			if(local.teampos == "alliessecond" && self.origin[0] >= $b5.origin[0] && self.origin[1] >= $b5.origin[1]) { local.outofmap = 2; waitframe; break }
			if(local.teampos == "axisfirst" && self.origin[1] >= $c4.origin[1]) { local.outofmap = 3; waitframe; break }
			if(local.teampos == "axissecond" && self.origin[0] >= $d5.origin[0]) { local.outofmap = 4; waitframe; break }
			local.n++
			wait 0.1
		}
		local.flyingsmoke remove // while-loop keeps looping until 2.3 seconds are done, or until the plane reaches splinepath node $a4 or $b4.
		local.flyingexplosion remove
	}

	local.Exp = spawn script_model
	local.Exp model "fx/fx_truck_explosion.tik"
	if(self != NULL) { local.Exp.origin = self.origin + ( 0 0 -35 ) }
	if(self == NULL || local.outofmap == 1) { local.Exp.origin = $a5.origin + ( 35 -35 -35 ) } // if checking <=: +35. if checking >=: -35. z coord is always -35.
	if(self == NULL || local.outofmap == 2) { local.Exp.origin = $b5.origin + ( -35 -35 -35 ) }
	if(self == NULL || local.outofmap == 3) { local.Exp.origin = $c4.origin + ( 0 -35 -35 ) }
	if(self == NULL || local.outofmap == 4) { local.Exp.origin = $d5.origin + ( -35 0 -35 ) }
	local.Exp.scale = 2.5
	local.Exp notsolid
	local.Exp anim idle
	
	local.Exp2 = spawn script_model
	local.Exp2 model "fx/barrel_gas_destroyed.tik"
	if(self != NULL) { local.Exp2.origin = self.origin + ( 0 0 -35 ) }
	if(self == NULL || local.outofmap == 1) { local.Exp2.origin = $a5.origin + ( 35 -35 -35 ) }
	if(self == NULL || local.outofmap == 2) { local.Exp2.origin = $b5.origin + ( -35 -35 -35 ) }
	if(self == NULL || local.outofmap == 3) { local.Exp2.origin = $c4.origin + ( 0 -35 -35 ) }
	if(self == NULL || local.outofmap == 4) { local.Exp2.origin = $d5.origin + ( -35 0 -35 ) }
	local.Exp2.scale = 2
	local.Exp2 notsolid
	local.Exp2 anim idle

	self hide // do not remove the plane. otherwise the planes will not be 1 second apart from each other for the next airstrike.

	wait 0.1 // sometimes, waitframe isn't long enough for barrel explosion to appear.
	local.Exp anim aaaa
	local.Exp anim dummy
	local.Exp remove
	local.Exp2 remove
	if(self != NULL) { self stopsound; self stoploopsound }
end

dropbomb local.origin local.waittime local.speed local.zrotate local.damageradius local.position:

	local.bombpoint = spawn script_origin origin ( local.origin ) // bombdrop destination
	local.teampos = self.team + local.position

	wait local.waittime // time until bomb drops, while plane is flying down its path

	if(level.planedead[local.teampos] != 1 && level.planedead[local.teampos] != 2)
	{
		local.bomb = spawn script_model
		local.bomb model ammo/us_bomb.tik
		local.bomb.scale = 1.5
		local.bomb.origin = self.origin + ( 0 0 15 )
		local.bomb.angle = self.angle + 90
		local.bomb light 1 0 0 300

		local.bomb thread movestuck_fix local.bombpoint
		local.bomb moveto local.bombpoint
		local.bomb speed local.speed // speed to travel from plane to ground
		local.bomb rotatez local.zrotate // point bomb nose-down over time
		local.bomb waitmove
		if(local.bomb != NULL) { local.bomb explode }

		local.boom = spawn script_model
		local.boom model animate/fx_mortar_dirt.tik // emitters/fx_explosion_mine.tik
		local.boom.origin = local.bombpoint.origin
		local.boom.scale = 1.5 // = 1 if using fx_explosion_mine.tik
		local.boom anim start

		radiusdamage local.boom.origin 200 local.damageradius

		waitframe
		local.boom anim stop
	}

	if(local.bomb != NIL && local.bomb != NULL) { local.bomb remove }
	if(local.boom != NIL && local.boom != NULL) { local.boom remove }
	local.bombpoint remove
end

movestuck_fix local.bombpoint:

	local.n = 0
 	while(self != NULL && self.origin != local.bombpoint)
 	{	    
		if(local.n == 2.000)
		{
			self explode
			waitframe
			if(self != NULL) { self remove }
			end
		}
		if(local.n >= 2.000 || local.bombpoint == NIL) { end }

		local.n = local.n + 0.100
 		wait 0.1
	}
end

bombdropcoords local.position: // axis

	if(local.position != "second") // "first"
	{
		// self thread dropbomb ( origin ) waittime speed zrotation damageradius
		waitframe
		self thread dropbomb ( 5168 -3968 -92 ) 1.55 2000 45 600 local.position
		waitframe
		self thread dropbomb ( 5607 -3972 -20 ) 1.60 2000 45 600 local.position
		waitframe
		self thread dropbomb ( 5309 -3538 -102 ) 1.65 2000 45 600 local.position
		waitframe
		self thread dropbomb ( 5333 -3173 -109 ) 1.70 2000 45 600 local.position
		waitframe
		self thread dropbomb ( 5353 -2737 -50 ) 1.75 2000 45 600 local.position
		waitframe
		self thread dropbomb ( 4942 -1137 -153 ) 2.40 2000 45 600 local.position
		waitframe
		self thread dropbomb ( 4839 -791 -144 ) 2.45 2000 45 600 local.position
		waitframe
		self thread dropbomb ( 5378 -857 -69 ) 2.50 2000 45 600 local.position
		waitframe
		self thread dropbomb ( 5713 -885 -69 ) 2.55 2000 45 600 local.position
		waitframe
		self thread dropbomb ( 5089 -359 -96 ) 2.60 2000 45 600 local.position
		waitframe
		self thread dropbomb ( 4841 -161 -167 ) 2.65 2000 45 600 local.position
		waitframe
	}     
	if(local.position == "second")
	{
		waitframe
		self thread dropbomb ( 3939 -2964 -31 ) 2.20 2000 45 600 local.position
		waitframe
		self thread dropbomb ( 4118 -2634 -11 ) 2.25 2000 45 600 local.position
		waitframe
		self thread dropbomb ( 4308 -2149 -5 ) 2.30 2000 45 600 local.position
		waitframe
		self thread dropbomb ( 4595 -2347 -4 ) 2.35 2000 45 600 local.position
		waitframe
		self thread dropbomb ( 4706 -2021 -5 ) 2.40 2000 45 600 local.position
		waitframe
		self thread dropbomb ( 4769 -2672 4 ) 2.45 2000 45 600 local.position
		waitframe
		self thread dropbomb ( 5415 -2461 -27 ) 2.50 2000 45 600 local.position
		waitframe
		self thread dropbomb ( 5137 -2067 2 ) 2.55 2000 45 600 local.position
		waitframe
		self thread dropbomb ( 5819 -2425 -5 ) 2.60 2000 45 600 local.position
		waitframe
		self thread dropbomb ( 5587 -1973 2 ) 2.65 2000 45 600 local.position
		waitframe
		self thread dropbomb ( 5902 -1902 1 ) 2.70 2000 45 600 local.position
		waitframe
	}
end

bombdropcoords2 local.position: // allies

	if(local.position != "second") // "first"
	{
		waitframe
		self thread dropbomb ( -1131 -609 -122 ) 1.85 2000 45 600 local.position
		waitframe
		self thread dropbomb ( -1094 -1078 -156 ) 1.90 2000 45 600 local.position
		waitframe
		self thread dropbomb ( -757 -598 -97 ) 1.95 2000 45 600 local.position
		waitframe
		self thread dropbomb ( -87 -491 -120 ) 2.00 2000 20 600	local.position
		waitframe
		self thread dropbomb ( 1038 622 -111 ) 2.40 2000 45 600 local.position
		waitframe
		self thread dropbomb ( 670 1188 -103 ) 2.45 2000 45 600 local.position
		waitframe
		self thread dropbomb ( 1142 1023 -148 ) 2.50 2000 45 600 local.position
		waitframe
		self thread dropbomb ( 1649 584 -152 ) 2.50 2000 45 600 local.position
		waitframe
		self thread dropbomb ( 869 1671 -131 ) 2.60 2000 45 600 local.position
		waitframe
		self thread dropbomb ( 1481 1628 -186 ) 2.65 2000 45 600 local.position
		waitframe
		self thread dropbomb ( 2119 1354 -151 ) 2.70 2000 45 600 local.position
		waitframe
		self thread dropbomb ( 1949 1856 -189 ) 2.75 2000 45 600 local.position
		waitframe
		self thread dropbomb ( 1560 1948 -201 ) 2.80 2000 45 600 local.position
		waitframe
		self thread dropbomb ( 2589 2108 -181 ) 2.85 2000 45 600 local.position
		waitframe
		self thread dropbomb ( 2792 2700 -190 ) 3.20 2000 45 600 local.position
		waitframe
		self thread dropbomb ( 2669 3370 -185 ) 3.30 2000 45 600 local.position
		waitframe
		self thread dropbomb ( 3341 3980 -191 ) 3.40 2000 45 600 local.position
		waitframe
		self thread dropbomb ( 3812 4601 -70 ) 3.50 2000 45 600 local.position
		waitframe
	}     
	if(local.position == "second")
	{
		waitframe
		self thread dropbomb ( -1193 -2607 -306 ) 1.55 2000 45 600 local.position
		waitframe
		self thread dropbomb ( -1250 -2210 -291 ) 1.60 2000 45 600 local.position
		waitframe
		self thread dropbomb ( -851 -1932 -211 ) 1.65 2000 45 600 local.position
		waitframe
		self thread dropbomb ( -363 -1968 -189 ) 1.70 2000 45 600 local.position
		waitframe
		self thread dropbomb ( -857 -1379 -186 ) 1.75 2000 45 600 local.position
		waitframe
		self thread dropbomb ( -189 -1450 -54 ) 1.80 2000 45 600 local.position
		waitframe
		self thread dropbomb ( -218 -920 -124 ) 1.85 2000 45 600 local.position
		waitframe
		self thread dropbomb ( 347 -996 -82 ) 1.90 2000 45 600 local.position
		waitframe
		self thread dropbomb ( 850 -224 -62 ) 2.10 2000 45 600 local.position
		waitframe
		self thread dropbomb ( 1251 193 -119 ) 2.15 2000 45 600 local.position
		waitframe
		self thread dropbomb ( 1746 596 -107 ) 2.20 2000 45 600 local.position
		waitframe
		self thread dropbomb ( 1368 2505 -208 ) 2.80 2000 45 600 local.position
		waitframe
		self thread dropbomb ( 1890 2653 -197 ) 2.85 2000 45 600 local.position
		waitframe
		self thread dropbomb ( 2009 3085 -194 ) 2.90 2000 45 600 local.position
		waitframe
		self thread dropbomb ( 1345 3002 -199 ) 2.95 2000 45 600 local.position
		waitframe
		self thread dropbomb ( 1729 3390 -188 ) 3.00 2000 45 600 local.position
		waitframe
		self thread dropbomb ( 1302 3572 -199 ) 3.05 2000 45 600 local.position
		waitframe
		self thread dropbomb ( 1630 3812 -195 ) 3.10 2000 45 600 local.position
		waitframe
	}
end

////////////////////////////////////////////////////////////////////////

vehicles_undermap:

	local.undermap_volumes = makeArray
		( -6249 -4464 -704 ) ( -99 -99 0 ) ( 22222 22222 1 )
		( -6249 -2447 -383 ) ( -99 -99 0 ) ( 12825 4480 1 )
		( 6576 1085 -255 ) ( -4281 -99 0 ) ( 99 5491 1 )
		( 2295 4375 -255 ) ( -22222 -1 0 ) ( 1 22222 1 ) 
		( 544 4375 -255 ) ( -22222 -1216 0 ) ( 1 1 1 )
		( -2127 -143 -255 ) ( -1 -1 0 ) ( 2356 2749 1 )
		( 48 3159 -255 ) ( -22222 -192 0 ) ( 1 1 1 )
		( -376 2967 -255 ) ( -22222 -361 0 ) ( 1 1 1 )
		( 48 2959 -239 ) ( -157 -1 0 ) ( 1 200 1 )
		( 4495 1160 -247 ) ( -1 -22222 0 ) ( 22222 1 1 )
		( 4384 -2767 -511 ) ( -3900 -22222 0 ) ( 1 1 1 )
		( 4544 -4295 -127 ) ( -1 -22222 0 ) ( 22222 1 1 )

		( 0 0 530 ) ( 0 0 -200 ) ( 10000 10000 300 ) // map ceiling
	endArray

	while(1)
	{
		for(local.a = 0; local.a <= level.drivable_entities.size; local.a++)
		{
			for(local.s = 1; $(level.drivable_entities[local.a]) != NULL && local.s <= $(level.drivable_entities[local.a]).size; local.s++)
			{
				if(local.undermap_volumes != NIL && local.undermap_volumes != 0) // if vehicles are inside a volume, blow them up.
				{
					for(local.v = 1; local.v <= local.undermap_volumes.size; local.v++)
					{
						local.X_min[local.v] = local.undermap_volumes[local.v][1][0] + local.undermap_volumes[local.v][2][0]
						local.X_max[local.v] = local.undermap_volumes[local.v][1][0] + local.undermap_volumes[local.v][3][0]
						local.Y_min[local.v] = local.undermap_volumes[local.v][1][1] + local.undermap_volumes[local.v][2][1]
						local.Y_max[local.v] = local.undermap_volumes[local.v][1][1] + local.undermap_volumes[local.v][3][1]
						local.Z_min[local.v] = local.undermap_volumes[local.v][1][2] + local.undermap_volumes[local.v][2][2]
						local.Z_max[local.v] = local.undermap_volumes[local.v][1][2] + local.undermap_volumes[local.v][3][2]
						local.origin = $(level.drivable_entities[local.a])[local.s].origin
	
						if(int(local.origin[0]) >= local.X_min[local.v] && int(local.origin[0]) <= local.X_max[local.v] && int(local.origin[1]) >= local.Y_min[local.v] && int(local.origin[1]) <= local.Y_max[local.v] && int(local.origin[2]) >= local.Z_min[local.v] && int(local.origin[2]) <= local.Z_max[local.v])
						{
							$(level.drivable_entities[local.a])[local.s] damage $world 15000 $world (0 0 0) (0 0 0) (0 0 0) 0 9 0 0
						}
					}
				}
			}
		}
		waitframe
	}
end

////////////////////////////////////////////////////////////////////////

tdm_spawns:

	local.team1 = "allied" // do not use "allies"
	local.team2 = "axis"
	thread player_spawns local.team1 local.team2
end

ffa_spawns:

	local.team1 = "deathmatch"
	local.team2 = "deathmatch"
	thread player_spawns local.team1 local.team2
end

player_spawns local.team1 local.team2:

	spawn ("info_player_" + local.team2) "origin" "623.13 3999.13 0.13" "angle" "-30" "targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "599.35 2549.11 0.13" "angle" "28" "targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "1246.34 2087.13 72.13" "angle" "3" "targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "2133.56 2815.23 64.13" "angle" "-79" "targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "1999.13 3752.89 64.13" "angle" "-69" "targetname" (local.team2 + "_spawn")

	spawn ("info_player_" + local.team2) "origin" "2401.86 3653.67 -191.88" "angle" "-173" "targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "2418.09 3726.27 -183.88" "angle" "147"	"targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "1752.26 3637.05 -511.88" "angle" "32" "targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "980.61 4160.88 64.13" "angle" "-38" "targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "2046.68 3983.13 64.13" "angle" "115" "targetname" (local.team2 + "_spawn")

	spawn ("info_player_" + local.team2) "origin" "1283.39 4059.94 -192.86" "angle" "6" "targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "1808.74 3605.56 -187.30" "angle" "132" "targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "1996.79 2320.38 -200.12" "angle" "84" "targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "123.13 3041.87 -415.88" "angle" "-61" "targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "1364.44 4030.49 64.13" "angle" "7" "targetname" (local.team2 + "_spawn")

	spawn ("info_player_" + local.team2) "origin" "-1037.81 -879.70 -155.34" "angle" "4" "targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "-1444.29 -1490.05 -260.97" "angle" "19" "targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "-855.47 -2036.34 -222.85" "angle" "63" "targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "-1342.13 -2548.96 -288.02" "angle" "58" "targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "-1351.02 -3060.56 -319.88" "angle" "60" "targetname" (local.team2 + "_spawn")

	spawn ("info_player_" + local.team2) "origin" "-998.35 -3279.27 -319.88" "angle" "105" "targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "-1671.08 -3334.71 -320.26" "angle" "44" "targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "-54.58 -1331.09 -16.70" "angle" "64" "targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "503.09 -1183.11 -45.47" "angle" "76" "targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "2254.83 -928.76 -71.88" "angle" "106" "targetname" (local.team2 + "_spawn")

	spawn ("info_player_" + local.team2) "origin" "2794.60 -876.96 -127.88" "angle" "163" "targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "2954.09 -429.37 -143.88" "angle" "-149" "targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "3145.90 -463.59 -143.88" "angle" "-155" "targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "3362.61 -296.01 -143.88" "angle" "-157" "targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "2264.78 -591.13 -76.48" "angle" "-154"	"targetname" (local.team2 + "_spawn")

	spawn ("info_player_" + local.team1) "origin" "7183 -4943 16" "angle" "-78" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "6351 -5296 26" "angle" "36" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "6351 -4519 31" "angle" "-47" "targetname" (local.team1 + "_spawn")

	spawn ("info_player_" + local.team1) "origin" "7024 -4207 13" "angle" "-146" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "6773 -3974 24" "angle" "180" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "6384 -4396 26" "angle" "70" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "5839 -3727 10" "angle" "-53" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "5712 -4240 -26" "angle" "133" "targetname" (local.team1 + "_spawn")

	spawn ("info_player_" + local.team1) "origin" "5503 -4640 -21" "angle" "36" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "5503 -4367 -21" "angle" "-34" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "5243 -4312 -79" "angle" "57" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "5103 -3439 -107" "angle" "-51" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "5928 -4636 208" "angle" "161" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "5791 -4400 217" "angle" "55" "targetname" (local.team1 + "_spawn")

	spawn ("info_player_" + local.team1) "origin" "4631 -3141 -89" "angle" "0" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "5151 -3376 -112" "angle" "62" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "5677 -2864 -19" "angle" "111" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "4992 -2792 -57" "angle" "70" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "4167 -2783 6" "angle" "53" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "3921 -1912 -7" "angle" "-21" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "4702 -1855 8" "angle" "-76" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "4863 -1431 0" "angle" "-38" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "4863 -1800 0" "angle" "0" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "5734 -1823 2" "angle" "-117" "targetname" (local.team1 + "_spawn")

	spawn ("info_player_" + local.team1) "origin" "5719 -1264 4" "angle" "68" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "5928 -882 -31" "angle" "178" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "4743 -1108 -151" "angle" "52" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "4561 -929 -124" "angle" "40" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "4976 206 -148" "angle" "-112" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "5376 -376 -76" "angle" "168" "targetname" (local.team1 + "_spawn")
end

////////////////////////////////////////////////////////////////////////

UBER_teleporters:

	exec map_triggers/undermap.scr ( -6249 -4464 -704 ) ( -99 -99 0 ) ( 22222 22222 1 ) // don't use large values like "99999",
	exec map_triggers/undermap.scr ( -6249 -2447 -383 ) ( -99 -99 0 ) ( 12825 4480 1 )  // or the trigger might not work.
	exec map_triggers/undermap.scr ( 6576 1085 -255 ) ( -4281 -99 0 ) ( 99 5491 1 )
	exec map_triggers/undermap.scr ( 2295 4375 -255 ) ( -22222 -1 0 ) ( 1 22222 1 ) 
	exec map_triggers/undermap.scr ( 544 4375 -255 ) ( -22222 -1216 0 ) ( 1 1 1 )
	exec map_triggers/undermap.scr ( -2127 -143 -255 ) ( -1 -1 0 ) ( 2356 2749 1 )
	exec map_triggers/undermap.scr ( 48 3159 -255 ) ( -22222 -192 0 ) ( 1 1 1 )
	exec map_triggers/undermap.scr ( -376 2967 -255 ) ( -22222 -361 0 ) ( 1 1 1 )
	exec map_triggers/undermap.scr ( 48 2959 -239 ) ( -157 -1 0 ) ( 1 200 1 )
	exec map_triggers/undermap.scr ( 4495 1160 -247 ) ( -1 -22222 0 ) ( 22222 1 1 )
	exec map_triggers/undermap.scr ( 4384 -2767 -511 ) ( -3900 -22222 0 ) ( 1 1 1 )
	exec map_triggers/undermap.scr ( 4544 -4295 -127 ) ( -1 -22222 0 ) ( 22222 1 1 )

if(getcvar("g_ubergametype") != "bb")
{ 
	exec map_triggers/tele.scr ( 1569 -1264 8 ) ( 1569 -1200 -7 ) 0 //exec map_triggers/tele.scr (  ) (  ) 0

	exec map_triggers/tele.scr ( -2335 -3694 -639 ) ( -3343 -1380 -233 ) 1
	exec map_triggers/tele.scr ( -3512 -790 -119 ) ( -3465 -713 -143 ) 0
	exec map_triggers/tele.scr ( -1439 -1009 -125 ) ( -1412 -1007 64 ) 0
	exec map_triggers/tele.scr ( -1392 -801 -144 ) ( -1439 -801 -143 ) 1
	exec map_triggers/tele.scr ( -2015 -3279 -575 ) ( -2076 -3039 -383 ) 0
	exec map_triggers/tele.scr ( -2076 -3039 -383 ) ( -2048 -2992 -311 ) 0
	exec map_triggers/tele.scr ( -15 -1712 -80 ) ( 31 -1743 352 ) 0
	exec map_triggers/tele.scr ( -235 -143 -47 ) ( -236 -144 184 ) 0
	exec map_triggers/tele.scr ( -258 -237 184 ) ( -258 -237 336 ) 0
	exec map_triggers/tele.scr ( 1840 -1136 -42 ) ( 1904 -1175 320 ) 1
	exec map_triggers/tele.scr ( 2000 -48 -78 ) ( 2006 -112 400 ) 0
	exec map_triggers/tele.scr ( 2631 1135 -70 ) ( 2652 1016 328 ) 0
	exec map_triggers/tele.scr ( 2778 2317 -177 ) ( 2778 2659 -191 ) 1
	exec map_triggers/tele.scr ( 2122 4695 -220 ) ( 2122 4408 256 ) 1
	exec map_triggers/tele.scr ( 2064 3983 64 ) ( 2064 3983 256 ) 1
	exec map_triggers/tele.scr ( 623 4336 0 ) ( 623 4336 256 ) 1
	exec map_triggers/tele.scr ( 432 3120 -415 ) ( 432 3120 256 ) 1
	exec map_triggers/tele.scr ( 1903 3983 64 ) ( 1903 3944 64 ) 1
	exec map_triggers/tele.scr ( 2095 3719 -183 ) ( 2089 3715 -511 ) 1
	exec map_triggers/tele.scr ( 2703 -1008 -127 ) ( 2575 -1008 256 ) 0
	exec map_triggers/tele.scr ( 3060 -694 -127 ) ( 3100 -693 304 ) 1
	exec map_triggers/tele.scr ( 3294 -267 -127 ) ( 3294 -267 120 ) 1
	exec map_triggers/tele.scr ( 5173 -143 -124 ) ( 5173 -111 232 ) 0
	exec map_triggers/tele.scr ( 4688 -922 -148 ) ( 4688 -922 64 ) 0
	exec map_triggers/tele.scr ( 4495 -1008 64 ) ( 4495 -1050 216 ) 0
	exec map_triggers/tele.scr ( 5719 -1264 4 ) ( 6020 -1103 312 ) 0
	exec map_triggers/tele.scr ( 5376 -1055 160 ) ( 5236 -1055 160 ) 0
	exec map_triggers/tele.scr ( 4623 -769 64 ) ( 4576 -769 64 ) 1
	exec map_triggers/tele.scr ( 4623 -512 64 ) ( 4576 -512 64 ) 1
	exec map_triggers/tele.scr ( 4863 -1431 0 ) ( 4990 -1584 192 ) 1
	exec map_triggers/tele.scr ( 4384 -2784 -2 ) ( 4458 -2789 384 ) 0
	exec map_triggers/tele.scr ( 5103 -3439 -107 ) ( 5039 -3439 128 ) 0
	exec map_triggers/tele.scr ( 5031 -3601 128 ) ( 4987 -3601 368 ) 0
	exec map_triggers/tele.scr ( 6816 -3824 21 ) ( 6843 -3864 480 ) 0
	exec map_triggers/tele.scr ( 5839 -3727 10 ) ( 5839 -3727 314 ) 0
	exec map_triggers/tele.scr ( 6319 -4400 35 ) ( 6270 -4400 256 ) 0
	exec map_triggers/tele.scr ( 5791 -4400 217 ) ( 5791 -4400 400 ) 0
	exec map_triggers/tele.scr ( 5552 -3312 -61 ) ( 5600 -3312 248 ) 0
	exec map_triggers/tele.scr ( 6351 -4592 17 ) ( 6328 -4639 224 ) 0
	exec map_triggers/tele.scr ( 6255 -4817 224 ) ( 6204 -4817 512 ) 0
	exec map_triggers/tele.scr ( 7024 -4207 14 ) ( 7024 -4207 384 ) 0
	exec map_triggers/tele.scr ( 6498 -5312 8 ) ( 6498 -5347 8 ) 1
	exec map_triggers/tele.scr ( 6707 -5296 9 ) ( 6707 -5360 192 ) 0
	exec map_triggers/tele.scr ( 6752 -5565 256 ) ( 6827 -5567 496 ) 0
	exec map_triggers/tele.scr ( 6792 -4773 32 ) ( 6864 -4773 584 ) 0
	exec map_triggers/tele.scr ( 7416 -4943 26 ) ( 7416 -4943 472 ) 0
	exec map_triggers/tele.scr ( 7032 -5184 19 ) ( 7079 -5184 19 ) 1

	exec map_triggers/tele.scr ( 4038 -2784 -3 ) ( 4018 -2831 -7 ) 1
	exec map_triggers/tele.scr ( 3107 -3748 -214 ) ( 6079 3147 122 ) 1
	exec map_triggers/tele.scr ( 2127 5540 -68 ) ( -4025 566 -143 ) 1
	exec map_triggers/tele.scr ( -4048 -1067 -233 ) ( -3845 -496 -143 ) 1
	exec map_triggers/tele.scr ( 5971 4142 220 ) ( 5971 4830 322 ) 1
	exec map_triggers/tele.scr ( 4751 79 -167 ) ( 2884 -272 -143 ) 1
	exec map_triggers/tele.scr ( 7520 -5952 40 ) ( 94 -385 -103 ) 1

	exec map_triggers/tele.scr ( 3184 863 328 ) ( 3257 863 456 ) 0
	exec map_triggers/tele.scr ( 5240 96 224 ) ( 5300 96 384 ) 0

	exec map_triggers/tele.scr ( 5558 -4640 -21 ) ( 5558 -4687 -31 ) 1

	exec map_triggers/tele.scr ( 1903 4104 -511 ) ( 1903 4143 -511 ) 1
}
end

UBER_mapextras:

if(getcvar("g_ubergametype") != "bb")
{
	thread cratesstuff static/barbwire_long.tik ( 3330 2617 -205 ) ( 0 145 0 ) 1
	thread cratesstuff static/barbwire_long.tik ( 3625 2890 -215 ) ( 0 128 0 ) 1
	thread cratesstuff static/barbwire.tik ( 3430 2598 -150 ) ( 0 145 0 ) 1

	thread solidclip ( 4319 4474 223 ) ( -420 -250 -500 ) ( 265 200 1000 ) 0

	thread solidclip ( -1039 -167 -50 ) ( -45 -125 -100 ) ( 45 325 1000 ) 301
	thread solidclip ( -1425 -289 -91 ) ( -45 -125 -100 ) ( 45 325 1000 ) 286
	thread solidclip ( -1839 -318 -102 ) ( -45 -125 -100 ) ( 45 325 1000 ) 269
	thread solidclip ( -2263 -250 -75 ) ( -45 -125 -100 ) ( 45 325 1000 ) 256
	thread solidclip ( -2486 -195 -76 ) ( -45 -125 -100 ) ( 45 325 1000 ) 86
	thread solidclip ( -2893 -159 -94 ) ( -45 -125 -100 ) ( 45 325 1000 ) 73
	thread solidclip ( -3220 65 -96 ) ( -45 -125 -100 ) ( 45 325 1000 ) 0

	thread solidclip ( -3440 -1039 -141 ) ( -45 -125 -100 ) ( 45 325 1000 ) 62
	thread solidclip ( -3851 885 -130 ) ( -45 -125 -100 ) ( 45 325 1000 ) 90

	thread solidclip ( 3145 2224 -180 ) ( -45 -125 -100 ) ( 45 325 1000 ) 147
	thread solidclip ( 2910 1849 -170 ) ( -45 -125 -100 ) ( 45 325 1000 ) 153
	thread solidclip ( 2745 1450 -150 ) ( -45 -125 -100 ) ( 45 325 1000 ) 169

	thread cratesstuff static/sandbag_link_main.tik ( -1981 -3008 -313 ) ( 0 -90 0 )

	thread cratesstuff static/banquet_table.tik ( 4351 -1634 -49 ) ( 0 270 0 )
	thread cratesstuff static/banquet_table.tik ( 4259 -1634 -49 ) ( 0 270 0 )
	thread cratesstuff static/banquet_table.tik ( 4167 -1634 -49 ) ( 0 270 0 )
	thread cratesstuff static/banquet_table.tik ( 4075 -1634 -49 ) ( 0 270 0 )
	thread cratesstuff static/banquet_table.tik ( 4351 -1434 -49 ) ( 0 270 0 )
	thread cratesstuff static/banquet_table.tik ( 4259 -1434 -49 ) ( 0 270 0 )
	thread cratesstuff static/banquet_table.tik ( 4167 -1434 -49 ) ( 0 270 0 )
	thread cratesstuff static/banquet_table.tik ( 4075 -1434 -49 ) ( 0 270 0 )
	thread cratesstuff static/banquet_table.tik ( 4351 -1234 -49 ) ( 0 270 0 )
	thread cratesstuff static/banquet_table.tik ( 4259 -1234 -49 ) ( 0 270 0 )
	thread cratesstuff static/banquet_table.tik ( 4167 -1234 -49 ) ( 0 270 0 )
	thread cratesstuff static/banquet_table.tik ( 4075 -1234 -49 ) ( 0 270 0 )
	thread cratesstuff static/banquet_table.tik ( 4351 -1034 -49 ) ( 0 270 0 )
	thread cratesstuff static/banquet_table.tik ( 4259 -1034 -49 ) ( 0 270 0 )
	thread cratesstuff static/banquet_table.tik ( 4167 -1034 -49 ) ( 0 270 0 )
	thread cratesstuff static/banquet_table.tik ( 4075 -1034 -49 ) ( 0 270 0 )

	thread cratesstuff static/indycrate.tik ( 1885 -1278 320 ) ( 0 180 0 )

	thread cratesstuff static/indycrate.tik ( 2185 -99 248 ) ( 0 180 0 )
	thread cratesstuff static/indycrate.tik ( 2072 -99 320 ) ( 0 180 0 )

	thread cratesstuff static/indycrate.tik ( -163 -120 256 ) ( 0 90 0 )

	thread cratesstuff static/indycrate.tik ( 475 -1752 399 ) ( 0 90 0 )
	thread cratesstuff static/indycrate.tik ( 475 -1799 352 ) ( 0 90 0 )

	thread cratesstuff static/indycrate.tik ( 759 -1427 399 ) ( 0 180 0 )
	thread cratesstuff static/indycrate.tik ( 806 -1427 352 ) ( 0 180 0 )

	thread cratesstuff static/indycrate.tik ( -924 -2722 -146 ) ( 0 90 0 )
	thread cratesstuff static/indycrate.tik ( -924 -2747 -207 ) ( 0 90 0 )

	thread cratesstuff static/indycrate.tik ( -1442 -2722 -146 ) ( 0 90 0 )
	thread cratesstuff static/indycrate.tik ( -1442 -2747 -207 ) ( 0 90 0 )

	thread cratesstuff static/indycrate.tik ( 600 2571 156 ) ( 0 180 0 )
	thread cratesstuff static/indycrate.tik ( 625 2571 104 ) ( 0 180 0 )
	thread cratesstuff static/indycrate.tik ( 650 2571 52 ) ( 0 180 0 )
	thread cratesstuff static/indycrate.tik ( 675 2571 0 ) ( 0 180 0 )

	thread cratesstuff static/indycrate.tik ( 2132 3175 208 ) ( 0 90 0 )
	thread cratesstuff static/indycrate.tik ( 2132 3128 161 ) ( 0 90 0 )
	thread cratesstuff static/indycrate.tik ( 2132 3081 114 ) ( 0 90 0 )
	thread cratesstuff static/indycrate.tik ( 2132 3034 67 ) ( 0 90 0 )

	thread cratesstuff static/indycrate.tik ( 6043 -4682 428 ) ( 0 270 0 )
	thread cratesstuff static/indycrate.tik ( 6043 -4584 308 ) ( 0 270 0 )
	thread cratesstuff static/indycrate.tik ( 6043 -4537 256 ) ( 0 270 0 )

	thread cratesstuff static/indycrate.tik ( 5855 -3512 303 ) ( 0 90 0 )

	thread cratesstuff static/indycrate.tik ( 4351 -1363 -4 ) ( 0 0 0 )
	thread cratesstuff static/indycrate.tik ( 4805 -1500 141 ) ( 0 0 0 )
	thread cratesstuff static/indycrate.tik ( 4758 -1500 89 ) ( 0 0 0 )
	thread cratesstuff static/indycrate.tik ( 4711 -1500 37 ) ( 0 0 0 )
	thread cratesstuff static/indycrate.tik ( 5463 -1376 89 ) ( 0 0 0 )
	thread cratesstuff static/indycrate.tik ( 5416 -1376 37 ) ( 0 0 0 )
	thread cratesstuff static/indycrate.tik ( 5667 -1251 253 ) ( 0 270 0 )
	thread cratesstuff static/indycrate.tik ( 5524 -1243 253 ) ( 0 180 0 )

	thread cratesstuff static/indycrate.tik ( 5787 -3305 248 ) ( 0 270 0 )
}
end

cratesstuff local.model local.origin local.angles local.hide local.scale local.targetname:

	local.ent = spawn script_model
	local.ent model local.model
	local.ent.origin = local.origin
	if(local.angles[2] != NIL) { local.ent.angles = local.angles }
	if(local.hide == 1) { local.ent hide }
	if(local.scale != NIL && local.scale > 0) { local.ent.scale = local.scale }
	if(local.targetname != NIL) { local.ent.targetname = local.targetname }
	if(local.ent.model == "models/vehicles/uboat.tik") { local.ent setsize ( -2150 -212 0 ) ( 2150 212 582 ) }
end

emitterstuff local.model local.origin local.angles local.scale local.anim local.targetname:

	local.emitter = spawn script_model
	local.emitter model local.model
	if(local.emitter.model == "models/emitters/inferno.tik") { local.emitter.origin = local.origin + ( 0 0 50 ) }
	else { local.emitter.origin = local.origin }
	if(local.angles[2] != NIL) { local.emitter.angles = local.angles }
	if(local.scale != NIL && local.scale > 0) { local.emitter.scale = local.scale }
	if(local.anim != NIL) { local.emitter anim local.anim }
	if(local.targetname != NIL) { local.emitter.targetname = local.targetname }
	local.emitter notsolid
end local.emitter

solidclip local.origin local.setsize1 local.setsize2 local.angle:

	local.clip = spawn script_object  
	local.clip.origin = local.origin
	local.clip setsize local.setsize1 local.setsize2
	local.clip.angle = local.angle
	local.clip solid
	local.clip nodamage
end

spawnlaser local.origin local.endpoint local.color local.scale local.targetname:

	local.laser = spawn func_beam
	local.laser minoffset 0.0
	local.laser maxoffset 0.0
	local.laser numsegments 1
	local.laser life 0
	local.laser color local.color
	local.laser alpha 0.4
	local.laser alwaysdraw
	local.laser activate	
	if(local.scale == NIL || local.scale <= 0) { local.laser scale 1 }	
	else { local.laser scale local.scale }
	local.laser notsolid
	local.laser.origin = local.origin
	local.laser endpoint local.endpoint
	if(local.targetname != NIL) { local.laser.targetname = local.targetname }
end local.laser

////////////////////////////////////////////////////////////////////////

cyb:

level waittill spawn

	level.round_starttime = 8
	level.rounds_towin = 6
 	level.changesides = 0
	level.keepsamesides = 1
	level.bombcamera = 1

  	waitthread global/cyberattack_searchdestroy.scr::bombsite ( 1794 3666 -188 ) 180 axis    // for cyber attack only
  	waitthread global/cyberattack_searchdestroy.scr::bombsite ( 4776 -1869 6 ) -90 allies

  	thread global/cyberattack_searchdestroy.scr::bomb ( 0 0 0 ) 0 ( 0 0 0 ) 0 ( 4157 -11 -167 ) -90
									
	exec global/cyberattack_searchdestroy.scr
end

////////////////////////////////////////////////////////////////////////

snd:

level waittill spawn

	level.round_starttime = 8
	level.rounds_towin = 6
 	level.changesides = 0
	level.bombcamera = 1

  	waitthread global/cyberattack_searchdestroy.scr::bombsite ( 4866 209 -172 ) -90    // for search & destroy only, team parameter doesn't matter
  	waitthread global/cyberattack_searchdestroy.scr::bombsite ( 2800 -995 -127 ) 90 

  	thread global/cyberattack_searchdestroy.scr::bomb ( 5960 -4428 -31 ) 90 ( 2064 3181 -193 ) 180 ( 0 0 0 ) 0
									
	exec global/cyberattack_searchdestroy.scr
end

////////////////////////////////////////////////////////////////////////

bb_objects:

level waittill prespawn

//axis
exec alienx/basebuild.scr::basebuild ( 1774.37 3930.52 -192.26 ) "static/indycrate.tik" 1 0 1 0 90 .5 0 0 1
exec alienx/basebuild.scr::basebuild ( 1808.72 3218.94 -192.26 ) "statweapons/mg42_gun.tik" 1 1 0 0 90 .5 0 0 1
exec alienx/basebuild.scr::basebuild ( 1773.27 3827.49 -191.12 ) "statweapons/flak88turret.tik" 1 1 .5 0 90 .25 0 0 1
exec alienx/basebuild.scr::basebuild ( 1237.20 3819.69 -199.88 ) "static/sandbag_link_main.tik" 1 0 0 1 90 .5 0 0 1
exec alienx/basebuild.scr::basebuild ( 1780.41 3706.96 -189.51 ) "static/indycrate.tik" 1 1 0 1 90 .5 1 0 1 // lift
exec alienx/basebuild.scr::basebuild ( 1783.06 3620.89 -188.44 ) "static/bunkertable.tik" 1 1 1 0 90 .5 0 1 1 // tele
exec alienx/basebuild.scr::basebuild ( 1777.30 3511.53 -187.38 ) "static/banquet_table.tik" 1 0 1 1 90 .5 0 0 1
exec alienx/basebuild.scr::basebuild ( 1771.45 3401.38 -187.55 ) "static/bodies_tarp.tik" 1 1 1 1 90 .5 0 0 1
//exec alienx/basebuild.scr::basebuild ( 1292.62 3919.02 -199.88 ) "static/bookcase.tik" 1 0 1 0 90 .5 0 0 1
//exec alienx/basebuild.scr::basebuild ( 1374.88 3912.52 -200.77 ) "static/static_naziflag1.tik" 1 1 1 1 90 .5 0 0 1
//exec alienx/basebuild.scr::basebuild ( 1570.68 3922.58 -196.74 ) "static/barbwire.tik" 1 0 1 1 90 .5 0 0 1
//exec alienx/basebuild.scr::basebuild ( 1086.50 3016.24 -199.88 ) "static/sandbag_longsegment.tik" 1 0 0 1 90 .5 0 0 1
//exec alienx/basebuild.scr::basebuild ( 1098.01 2724.65 -199.88 ) "static/cabinet_large.tik" 1 1 1 1 90 .6 0 0 1
//exec alienx/basebuild.scr::basebuild ( 1099.16 2777.98 -199.88 ) "static/bush_full.tik" 1 0 1 0 90 .5 0 0 0

//MIDDLE
exec alienx/basebuild.scr::basebuild ( 5057.09 -353.44 -108.32 ) "static/indycrate.tik" 1 0 1 0 90 .5 0 0 1
exec alienx/basebuild.scr::basebuild ( 5087.27 -438.40 -92.91 ) "statweapons/mg42_gun.tik" 1 1 0 0 90 .5 0 0 1
exec alienx/basebuild.scr::basebuild ( 5094.88 -517.08 -92.81 ) "statweapons/flak88turret.tik" 1 1 .5 0 90 .25 0 0 1
exec alienx/basebuild.scr::basebuild ( 5101.69 -600.60 -94.22 ) "static/sandbag_link_main.tik" 1 0 0 1 90 .5 0 0 1
exec alienx/basebuild.scr::basebuild ( 5340.68 -958.04 -62.70 ) "static/indycrate.tik" 1 1 0 1 90 .5 1 0 1 // lift
exec alienx/basebuild.scr::basebuild ( 5254.85 -961.75 -72.72 ) "static/bunkertable.tik" 1 1 1 0 90 .5 0 1 1 // tele
exec alienx/basebuild.scr::basebuild ( 5147.61 -966.52 -72.83 ) "static/banquet_table.tik" 1 0 1 1 90 .5 0 0 1
exec alienx/basebuild.scr::basebuild ( 4784.06 -784.16 -147.30 ) "static/bodies_tarp.tik" 1 1 1 1 90 .5 0 0 1
//exec alienx/basebuild.scr::basebuild ( 4790.40 -563.31 -169.62 ) "static/bookcase.tik" 1 0 1 0 90 .5 0 0 1
//exec alienx/basebuild.scr::basebuild ( 5202.69 -752.51 -80.74 ) "static/static_naziflag1.tik" 1 1 1 1 90 .5 0 0 1
//exec alienx/basebuild.scr::basebuild ( 5276.40 -756.75 -74.62 ) "static/barbwire.tik" 1 0 1 1 90 .5 0 0 1
//exec alienx/basebuild.scr::basebuild ( 4812.07 -406.46 -176.77 ) "static/sandbag_longsegment.tik" 1 0 0 1 90 .5 0 0 1
//exec alienx/basebuild.scr::basebuild ( 4789.29 -673.24 -155.43 ) "static/cabinet_large.tik" 1 1 1 1 90 .6 0 0 1
//exec alienx/basebuild.scr::basebuild ( 4785.60 -901.10 -152.32 ) "static/bush_full.tik" 1 0 1 0 90 .5 0 0 0

//allies
exec alienx/basebuild.scr::basebuild ( 5140.24 -4082.22 -77.81 ) "static/indycrate.tik" 1 0 1 0 90 .5 0 0 1
exec alienx/basebuild.scr::basebuild ( 5139.28 -3987.72 -85.11 ) "statweapons/mg42_gun.tik" 1 1 0 0 90 .5 0 0 1
exec alienx/basebuild.scr::basebuild ( 5175.89 -4211.33 -72.17 ) "statweapons/flak88turret.tik" 1 1 .5 0 90 .25 0 0 1
exec alienx/basebuild.scr::basebuild ( 5146.34 -3885.89 -84.60 ) "static/sandbag_link_main.tik" 1 0 0 1 90 .5 0 0 1
exec alienx/basebuild.scr::basebuild ( 5146.74 -3744.95 -91.14 ) "static/indycrate.tik" 1 1 0 1 90 .5 1 0 1 // lift
exec alienx/basebuild.scr::basebuild ( 5151.31 -3609.56 -111.00 ) "static/bunkertable.tik" 1 1 1 0 90 .5 0 1 1 // tele
exec alienx/basebuild.scr::basebuild ( 5145.58 -3501.95 -111.44 ) "static/banquet_table.tik" 1 0 1 1 90 .5 0 0 1
exec alienx/basebuild.scr::basebuild ( 5555.97 -3828.96 -28.05 ) "static/bodies_tarp.tik" 1 1 1 1 90 .5 0 0 1
//exec alienx/basebuild.scr::basebuild ( 5676.34 -3830.13 -17.97 ) "static/bookcase.tik" 1 0 1 0 90 .5 0 0 1
//exec alienx/basebuild.scr::basebuild ( 5796.26 -3839.76 -15.94 ) "static/static_naziflag1.tik" 1 1 1 1 90 .5 0 0 1
//exec alienx/basebuild.scr::basebuild ( 5691.13 -4184.20 -23.43 ) "static/barbwire.tik" 1 0 1 1 90 .5 0 0 1
//exec alienx/basebuild.scr::basebuild ( 5639.37 -4128.13 -24.40 ) "static/sandbag_longsegment.tik" 1 0 0 1 90 .5 0 0 1
//exec alienx/basebuild.scr::basebuild ( 5572.07 -4175.67 -28.00 ) "static/cabinet_large.tik" 1 1 1 1 90 .6 0 0 1
//exec alienx/basebuild.scr::basebuild ( 5502.42 -4194.75 -38.59 ) "static/bush_full.tik" 1 0 1 0 90 .5 0 0 0
end

////////////////////////////////////////////////////////////////////////

consoleprint:

	wait 1
	if(level.objectlimit != NIL && level.build_number != NIL) { end }

	local.maxclients = int(getcvar(sv_maxclients))
	local.nullent = 0
	local.e = 0
	for(local.i = 0; local.i <= 868; local.i++) // getentity() only goes up to 868 (869 entities).
	{
		if(local.i % 14 == 0) { waitframe } // every 62 entites (if local.i / 14 has remainder of 0), do a waitframe (speeds up counting).

		local.entity = getentity(local.i) // $player[1] = entity 0		
		if(local.entity == NULL && local.i >= local.maxclients) { local.nullent++ }
		if(local.entity != NULL) { local.e++ }
		if(local.e >= 685 - local.maxclients) { local.warning = 1 }

		if(local.entity != NULL && local.entity.model == models/animate/allied_airborne_soldier_dead.tik) { local.entity remove; local.nullent++ } // remove dead soldier model
		if(local.entity != NULL && local.entity.model == models/statweapons/flak88base.tik) { local.entity notsolid } // or local.entity remove
	}
	if(local.entity == NULL) // if entity 868 = NULL
	{
		println("----- Entities in map: " + (1024 - local.nullent - 155) + " / 1024")
		println("----- Entities remaining: " + (local.nullent + 155))
	}
	if(local.entity != NULL)
	{
		println("----- Entities in map: " + "more than 869" + " / 1024")
		println("----- Entities remaining: less than 155 entities.")
	}
	if(local.warning == 1)
	{
		wait 1
		println("----- WARNING: Keep below 685 entities on SP maps for Reborn servers!")
		println("----- Players may soon be unable to join! (stuck connecting to sever)")
	}
end

fillup_330:
end
hint1:
end
save1:
end
door_early:
end
enddoor:
end
use_gate:
end
papersthread:
end
earlyalert:
end
torture:
end
blowdoor:
end
earlyenemies:
end
friendchoice:
end
prisonertruck:
end
gotexplosives:
end
stage2:
end
chairstart:
end
gotruck:
end
ossdoor:
end
end
getossgun:
end
torture2:
end
friendchoice2:
end
blowflak:
end
door_early2:
end
POW_damage:
end
spotshow:
end
large_door:
end
spothide:
end
hint_door:
end
sentryalarm:
end
clickitem_fail:
end