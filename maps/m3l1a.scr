main:

exec cvars/cvars.scr			// <><><> UBER MODS <><><>
exec ubermods/runspeed.scr 350 		// set the server's player run speed here (default = 250).
exec ubermods/hardcode_list.scr		// set the "g_ubergametype" for each map in "hardcode_list.scr" (only if "g_uberhardcode 1" cvar is set, default = "0").
					
//setcvar "g_ubergametype" "0"		// "cyb", "snd", "bb", "ft", "0" (normal TDM or FFA, based on "g_gametype" being "2" or "1" respectively).
					// cyber attack, search & destroy, base-builder, freze tag, none (this cvar is usually placed in server.cfg).
setcvar "g_obj_alliedtext1" "m3l1a"
setcvar "g_obj_axistext1" ""
setcvar "g_obj_axistext2" ""
setcvar "g_obj_axistext3" "By: Searingwolfe"

setcvar "g_scoreboardpic" "m3l1a"

setcvar "fraglimit" "0"
setcvar "timelimit" "20"
setcvar "maxentities" "2000"

setcvar "cheats" "0"
setcvar "thereisnomonkey" "0"

setcvar "dmrespawning" "1" 
setcvar "dmroundlimit" "20" 
setcvar "level.clockside" "kills"
local.v = exec ubermods/uberversion.scr

if(getcvar("g_throwingknives") != "1") { setcvar "g_obj_alliedtext3" "" }
if(getcvar("g_throwingknives") == "1") { setcvar "g_obj_alliedtext3" "+ Throwing Knives Mod" }

if(getcvar("g_gametype") == "1") { 		setcvar "g_obj_alliedtext2" ("UBER Free-For-All " + local.v);	setcvar "g_gametypestring" "Free-For-All UBER";		setcvar "g_gametype" "1"; thread ffa_spawns }
if(getcvar("g_gametype") != "1") { 		setcvar "g_obj_alliedtext2" ("UBER Team-Match " + local.v);	setcvar "g_gametypestring" "Team-Match UBER";		setcvar "g_gametype" "2"; thread tdm_spawns
						spawn info_player_deathmatch "origin" "-1256 3514 -169" "angle" "51" // for spectators when joining game
						spawn info_player_deathmatch "origin" "480 3027 -201" "angle" "-93"
						spawn info_player_deathmatch "origin" "352 -7440 -463" "angle" "90"
}
if(getcvar("g_ubergametype") == "cyb") {	setcvar "g_obj_alliedtext2" ("UBER Cyber Attack " + local.v);	setcvar "g_gametypestring" "Cyber Attack UBER";		setcvar "g_gametype" "2"; thread cyb }
if(getcvar("g_ubergametype") == "snd") {	setcvar "g_obj_alliedtext2" ("UBER Search-Destroy " + local.v);	setcvar "g_gametypestring" "Search & Destroy UBER";	setcvar "g_gametype" "2"; thread snd }
if(getcvar("g_ubergametype") == "ft") {		setcvar "g_obj_alliedtext2" ("UBER Freeze Tag " + local.v);	setcvar "g_gametypestring" "Freeze Tag UBER";		setcvar "g_gametype" "2"; thread cyb }
if(getcvar("g_ubergametype") == "bb") {		setcvar "g_obj_alliedtext2" ("UBER Base-Builder " + local.v);	setcvar "g_gametypestring" "Base-Builder UBER"; 	thread bb_objects
setcvar "g_obj_axistext1" "Build a base &"; setcvar "g_obj_axistext2" "kill enemy players."

exec alienx/basebuild.scr::main 800 1000 500 1 1 0 0 0 // buildtime objectlimit buildspeed buildtakeweaps buildfalldamage countdownhide hudhide consoleprint
//level.basebuild_laserdist = 700
}

if(getcvar("g_ubermods") == "1" || getcvar("g_ubermods") == "2")
{
exec global/aliascache_triggersounds.scr airstrikes
exec global/aliascache_triggersounds.scr explode_building_small
exec global/aliascache_triggersounds.scr explode_building_large
exec global/aliascache_triggersounds.scr explode_wood_small
exec global/aliascache_triggersounds.scr bangalore
exec global/aliascache_triggersounds.scr weldingtorch
}
exec global/aliascache_triggersounds.scr arty_exp_sand
exec global/aliascache_triggersounds.scr arty_exp_water
exec global/aliascache_triggersounds.scr arty_leadinmp

waitthread setup

level waittill prespawn

	exec global/DMprecache.scr
	exec alienx/hud.scr
	exec ui/fix.scr
	level.dmrespawning = 1

	level.script = maps/m3l1a.scr
	exec global/ambient.scr m3l1a
	exec global/door_locked.scr
	exec global/exploder.scr
	//exec global/barrel.scr::explosive_barrel

	setcvar "r_fastsky" "1"
	exec global/fastsky.scr 1
	$world farplane 7000 //15000, reduced to boost fps
	$world farplane_color ( 0.6784 0.8353 0.9686 )

exec global/victory_podium.scr ( 280 1300 -458 ) -90 auto auto 5

if(getcvar("g_ubermods") == "1" || getcvar("g_ubermods") == "2")
{
	exec global/dog.scr ( 1218 4307 -325 ) ( 0 -122 0 ) 15 10

	exec killstreaks/claymores.scr 3 2		// number of kills, number of claymores given (max = 5)
	exec killstreaks/airstrikes.scr	5 8		// number of kills, number of bullets to kill a plane
	exec killstreaks/cluster_mines.scr 7 5		// number of kills, number of additional mines spawned (max = 15)
	exec killstreaks/sentry_turret.scr 9 180	// number of kills, time until sentry turret dies

	thread UBER_mapextras
	thread UBER_teleporters

	thread mapedge ( .3608 .6627 .0016 ) ( 1 0 0 )
	thread random_explode_setup 256 384 275 // local.damage, beachradius, midradius
	thread random_explode_setup_water 256 400 // damage, radius
	thread random_explode_anywhere 256 600
}

if(getcvar("g_ubermods") == "2")
{

	exec map_triggers/joint.scr ( -7856 7920 596 )

exec map_triggers/lightbomb.scr ( 3530 -1466 -545 ) ( 1167 -1333 -532 ) ( -1119 -1297 -529 ) ( -3816 -1375 -536 ) ( -4473 3324 -204 ) ( 3096 3278 -198 ) ( 3209 5210 216 ) ( 1680 5640 592 ) ( -1067 5260 592 ) ( -2463 5692 335 )
exec map_triggers/bomb.scr ( 0 0 0 ) ( 0 0 0 ) ( 0 0 0 ) ( 0 0 0 ) ( 0 0 0 ) ( 6174 -1025 -503 ) ( -5589 -1023 -503 ) ( -5377 5678 251 ) ( 391 5755 233 ) ( 6898 4083 -252 )
exec map_triggers/grenade_ammo.scr ( 1890 1473 -458 ) ( 688 1771 -443 ) ( 29 1271 -455 ) ( -1728 2085 -423 ) ( -172 3067 -287 ) ( -987 3959 -299 ) ( -592 4699 -272 ) ( -87 5240 -311 ) ( 774 4654 -408 ) ( -3176 4617 -203 )
exec map_triggers/rocket_ammo.scr ( 0 0 0 ) ( 0 0 0 ) ( 0 0 0 ) ( 0 0 0 ) ( 0 0 0 ) ( 2364 473 -465 ) ( -2482 776 -461 ) ( -1193 5240 272 ) ( 1829 5632 272 ) ( 2537 5547 -540 )
exec map_triggers/snowball_ammo.scr ( -5595 959 -459 ) ( -6744 4457 -127 ) ( -5775 6969 593 ) ( -2097 6384 354 ) ( 2235 6384 343 ) ( 5944 6384 267 ) ( 6193 871 -460 ) ( 292 -16 -471 ) ( 343 3179 -266 ) ( 336 3430 -329 )
exec map_triggers/health.scr ( -7856 -7984 -448 ) ( 7984 -7984 -448 ) ( 7984 -1055 -506 ) ( -7856 -1055 -506 ) ( -7856 3328 -203 ) ( -7856 6393 395 ) ( -5300 7920 624 ) ( -2767 7408 517 ) ( 7984 6384 256 ) ( 7984 3381 -170 )

if(getcvar("g_ubergametype") != "bb")
{
	//exec map_triggers/player_spotlight.scr ( -1071 4838 319 ) ( 1 1 1 ) s0 700 -90 0 0 1		// white, removed to lower entity count
	//exec map_triggers/player_spotlight.scr ( 1679 5231 319 ) ( 1 1 1 ) s1 700 -90 0 0 1		// white

	//exec map_triggers/spotlight_colorswitch.scr ( -1071 5255 352 ) ( 0 -90 0 ) s0 rainbow
	//exec map_triggers/spotlight_colorswitch.scr ( 1679 5647 352 ) ( 0 -90 0 ) s1 rainbow

// Available playervehicle models:
// bmwbike, european_car_grey, european_car_silver, european_car_tan, european_delivery_truck_green, european_delivery_truck_grey, european_delivery_truck_red3,
// gmctruck, jeep, jeep_bench, m3, mercedes, opeltruck, opeltruckgreen, opeltruckgreen_canopy, sdkfz, sdkfz_afrika, shermantank.
//
// Vehicle speeds: trucks/boats = 250, jeeps/euro_vehicles/mercedes = 400, bikes = 500, halftracks/uboats = 40
//
exec global/playerboat.scr boat1 vehicles/higginsxtrahull.tik ( -5650 -2853 -544 ) ( 0 -90 0 ) 250 250 45
exec global/playerboat.scr boat2 vehicles/higginsxtrahull.tik ( 5650 -2853 -544 ) ( 0 -90 0 ) 250 250 45

// Available playertank models:
// kingtank, panzer_tank, panzer_tank_europe.
//
exec global/playertank.scr tank01 vehicles/panzer_tank_europe.tik ( 3064 -198 -400 ) ( 0 90 0 ) 1000 45		// allies side
exec global/playertank.scr tank02 vehicles/panzer_tank_europe.tik ( -2881 102 -400 ) ( 0 90 0 ) 1000 45		// allies side
exec global/playertank.scr tank03 vehicles/kingtank.tik ( 4231 5659 245 ) ( 0 -90 0 ) 1000 45			// axis side
exec global/playertank.scr tank04 vehicles/kingtank.tik ( -3125 3989 -100 ) ( 0 180 0 ) 1000 45			// middle

exec global/playernebelwerfer.scr NIL 200 45 ( 1524 800 -461 ) ( 355 90 0 )
exec global/playernebelwerfer.scr NIL 200 45 ( -1428 1100 -457 ) ( 355 90 0 )
exec global/playerflak88.scr NIL 200 45 ( -1071 4971 592 ) ( 0 -90 0 ) 0 ( 0 45 0 )
exec global/playerflak88.scr NIL 200 45 ( 1679 5361 592 ) ( 0 -90 0 ) 0 ( 0 45 0 )

exec server_planes/trigger.scr ( -2043 -691 -479 ) "allies" 1 0 ( -2043 -691 521 )	// team (only 1 per modelpair), flying plane scale, modelpair, starting origin (default = origin + 500)
exec server_planes/trigger.scr ( 3651 4850 166 ) "axis" 1 0				// Allies/Axis modelpair: 0 = p47/fockwulf, 1 = stuka_dsrt/stuka, 2 = c47 for both teams
exec server_planes/trigger.scr ( 2218 -927 -494 ) "allies" 1 1 ( 2218 -927 506 )
exec server_planes/trigger.scr ( -2761 5981 344 ) "axis" 1 1
exec server_planes/trigger.scr ( -6395 6887 656 ) "allies" 1 2
}

exec jetpack/trigger.scr ( 644 -667 -478 ) // allies
exec jetpack/trigger.scr ( -88 5947 339 ) // axis

exec maps/gen_mapscripts/radiobomb_walkietrig.scr bombwalkie1 ( 985 -748 -479 ) ( 0 -120 0 ) ( 894 -822 -484 ) ( 0 -125 0 ) 500 1 1 8
exec maps/gen_mapscripts/radiobomb_walkietrig.scr bombwalkie2 ( 2621 5870 -575 ) ( 0 -90 0 ) ( 2564 5871 -535 ) ( 0 0 0 ) 500 1 1 8

exec maps/training_mapscripts/bangalore_wallbomb.scr bb1 ( 2623.5 4983 -370 ) ( 60 -90 0 ) 100 0
exec map_triggers/map_switches/training_alarmswitch_gunrange.scr ( 2494 5313 -507 ) ( 0 90 0 ) bb1 60 450 2   // alarmswitch origin, angles; bangalore name, time, damageradius, pulsatingoff

exec guidedmissile/trigger.scr ( -1006 -636 -478 )
exec guidedmissile/trigger.scr ( -2982 6095 336 )
exec guidedmissile/trigger.scr ( 3850 4842 158 )

	thread vehicles_undermap
	thread explodesounds
	thread bind_triggers_to_higgins
}

thread airstrikes_alternate

level waittill spawn

	thread consoleprint
	thread ambience
	thread water_volumes

while(level.bbactive == 1) { wait 1 }

if(getcvar("g_throwingknives") == "1")
{
	exec global/give_players_knives.scr 1 // spawn everyone with one throwing knife (hold USE + Right-click to throw)
}
end

ambience: // make sure the spawnamb volumes are not overlapping!!!

	level.spawnamb = makeArray
		( 2096 5112 -700 ) ( 0 0 0 ) ( 719 863 524 ) sound/amb_stereo/Amb_M1_Bunker_03.mp3
	endArray

	exec global/ambience_mp.scr sound/amb_stereo/Amb_M4_CountryExt_02.mp3 1 // 0 = no, 1 = keep players' music volume at max.
end

water_volumes: // these are for any airstrikes that drop bombs into the ocean.

	level.water_volumes = makeArray
		( 0 -768 -479 ) ( -8000 -8000 -4000 ) ( 8000 0 1 )
	endArray
end

////////////////////////////////////////////////////////////////////////

explodesounds: // this thread prevents duplicate aliases from playervehicle, playerboat.

	local.master = spawn scriptmaster
	if(level.vehiclescriptmaster2 != 1)
	{
		local.master aliascache explode_truck1 sound/weapons/explo/Explo_MetalMed1.wav soundparms 1.2 .2 .8 .2 1500 8000 weapon loaded maps level.mapname
		local.master aliascache explode_truck2 sound/weapons/explo/Explo_MetalMed2.wav soundparms 1.2 .2 .8 .2 1500 8000 weapon loaded maps level.mapname
		local.master aliascache explode_truck3 sound/weapons/explo/Explo_MetalMed3.wav soundparms 1.2 .2 .8 .2 1500 8000 weapon loaded maps level.mapname
		local.master aliascache explode_truck4 sound/weapons/explo/Explo_MetalMed4.wav soundparms 1.2 .2 .8 .2 1500 8000 weapon loaded maps level.mapname
		local.master aliascache explode_truck5 sound/weapons/explo/Explo_MetalMed5.wav soundparms 1.2 .2 .8 .2 1500 8000 weapon loaded maps level.mapname
	}
	if(level.vehiclescriptmaster[2] != 1)
	{
		local.master aliascache sdkfz_snd_off sound/vehicle/veh_track_off.wav soundparms 1 0 1 0 800 4000 auto loaded maps level.mapname
	}
	if(level.boatscriptmaster != 1)
	{
		local.master aliascache boatsinking sound/amb/Amb_RainPuddle_01.wav soundparms 1.5 0.0 1.0 0.0 250 1600 auto loaded maps level.mapname
		local.master aliascache boatsunk sound/amb/Amb_BasementWater.wav soundparms 0.75 0.0 1.0 0.0 200 1600 auto loaded maps level.mapname
		local.master aliascache boatsinkwave1 sound/amb/Amb_Wave_01.wav soundparms 2.0 0.0 1.0 0.0 500 4000 auto loaded maps level.mapname
		local.master aliascache boatsinkwave2 sound/amb/Amb_Wave_02.wav soundparms 2.0 0.0 1.0 0.0 500 4000 auto loaded maps level.mapname
		local.master aliascache boatsinkwave3 sound/amb/Amb_Wave_03.wav soundparms 2.0 0.0 1.0 0.0 500 4000 auto loaded maps level.mapname
		local.master aliascache boatsinkwave4 sound/amb/Amb_Wave_04.wav soundparms 2.0 0.0 1.0 0.0 500 4000 auto loaded maps level.mapname
	}
end

setup:

	level.mapname = getcvar "mapname"
	local.master = spawn scriptmaster
	local.master aliascache higginsexplosion sound/weapons/explo/Exp_Higgins_01.WAV soundparms 1.5 .2 .8 .2 1500 8000 weapon loaded maps level.mapname
	local.master aliascache sdkfzsndidle sound/vehicle/veh_track_idle.wav soundparms 0.75 0 1 0 800 4000 auto loaded maps level.mapname
	local.master aliascache higgins_door_opening sound/mechanics/DoorHigginsOpen_04.wav soundparms 1.2 0.0 1.0 0.0 200 2000 item loaded maps level.mapname
	local.master aliascache exp_shingle sound/weapons/explo/Exp_Shingle_01.WAV soundparms 1.5 0.0 1.0 0.0 1000 2200 weapon loaded maps level.mapname

	removeclass actor
	//removeclass EffectEntity // 185 entities, including $mortar[1] - [149]
	removeclass AmmoEntity
	removeclass Health
	removeclass Weapon
	removeclass TurretGun // 11 entities
	removeclass TriggerAll
	removeclass TriggerOnce
	removeclass TriggerUseOnce
	//removeclass ScriptOrigin // campaign-related stuff & higgins boat stuff.
	//removeclass CrateObject // 31 entities
	//removeclass BarrelObject // 10 entities
	//removeclass ScriptModel // higgins boats, barbwire fences, bangalores, hedgehog explosives.

	//removeclass Trigger // campaign-related stuff for sounds/explosions.
	for(local.e = 0; local.e <= 868; local.e++) // removes all other Triggers without removing different classed entities, including the wavy ocean.
	{
		local.entity = getentity(local.e)
		if(local.entity != NULL && local.entity.classname == Trigger && local.entity.targetname != "")
		{
			local.entity remove
		}
	}

	// origin, ladder angle, height, width, thickness (going into wall), spawn solid clip (0 = no, 1 = yes), spawn lasers (1 = 1 laser, 2 = 2 lasers for ladder, 3 = ladder with rungs), laser color (R G B).
	exec global/spawnladder.scr ( 1375.5 4241 -503 ) -90 200 31 1 0 1 ( 0 0 1 )

	$playerweapon_springfield remove
	$sequence_12_playerclip1 remove
	$sequence_12_playerclip2 remove
	$cover_sound remove // [1] - [76]
	$trench_objective remove
	$sequence_12_mg42_target remove
	$left_engineer_spawn remove
	$shingle_ranger1_spawn remove
	$shingle_wave_spawn1 remove
	$player_target remove
	$craters_cover1_target remove
	$mg42_middle1_spawner_gunner remove
	$higgins1_ranger1_spot remove
	$higgins1_playerspot remove
	$higgins1_ranger2_spot remove
	$higgins1_ranger3_spot remove
	$higgins1_ranger4_spot remove
	$higgins1_ranger5_spot remove
	$higgins1_ranger7_spot remove
	$higgins1_ranger6_spot remove
	$higgins1_ranger8_spot remove
	$higgins1_ranger10_spot remove
	$higgins1_ranger9_spot remove
	$higgins3_ranger1_spot remove
	$higgins3_ranger5_spot remove
	$higgins3_ranger2_spot remove
	$higgins3_ranger3_spot remove
	$higgins3_ranger4_spot remove
	$higgins3_ranger6_spot remove
	$higgins3_ranger8_spot remove
	$higgins3_ranger7_spot remove
	$higgins4_ranger1_spot remove
	$higgins4_ranger5_spot remove
	$higgins4_ranger2_spot remove
	$higgins4_ranger3_spot remove
	$higgins4_ranger4_spot remove
	$higgins4_ranger6_spot remove
	$higgins4_ranger8_spot remove
	$higgins4_ranger7_spot remove
	$higgins5_ranger1_spot remove
	$higgins5_ranger5_spot remove
	$higgins5_ranger2_spot remove
	$higgins5_ranger3_spot remove
	$higgins5_ranger4_spot remove
	$higgins5_ranger6_spot remove
	$higgins5_ranger8_spot remove
	$higgins5_ranger7_spot remove
	$higgins6_ranger1_spot remove
	$higgins6_ranger5_spot remove
	$higgins6_ranger2_spot remove
	$higgins6_ranger3_spot remove
	$higgins6_ranger4_spot remove
	$higgins6_ranger6_spot remove
	$higgins6_ranger8_spot remove
	$higgins6_ranger7_spot remove
	$mg42_target_left remove // [1] - [4]
	$mg42_target_left_origin remove // [1] - [4]
	$mg42_target_right remove // [1] - [4]
	$mg42_target_right_origin remove // [1] - [4]
	$mg42_middle2_spawner_gunner remove
	$craters_cover3_target remove
	$shingle_objective remove
	$shingle_wave_spawn2 remove
	$shingle_wave_spawn3 remove
	$shingle_wave_spawn4 remove
	$shingle_wave_spawn5 remove
	$shingle_wave_spawn6 remove
	$shingle_wave_spawn7 remove
	$shingle_wave_spawn8 remove
	$shingle_wave_spawn9 remove
	$shingle_wave_spawn10 remove
	$shingle_wave_spawn11 remove
	$shingle_wave_spawn12 remove
	$shingle_wave_spawn13 remove
	$shingle_wave_spawn14 remove
	$shingle_wave_spawn15 remove
	$shingle_wave_spawn16 remove
	$shingle_ranger3_spawn remove
	$shingle_ranger2_spawn remove
	$shingle_ranger5_spawn remove
	$shingle_ranger4_spawn remove
	$shingle_ranger6_spawn remove
	$shingle_ranger7_spawn remove
	$shingle_wave_spawn17 remove
	$shingle_wave_spawn18 remove
	$bangalore_wave1_spawn remove
	$bangalore_wave2_spawn remove
	$bangalore_wave3_spawn remove
	$bangalore_wave4_spawn remove
	$bangalore_wave5_spawn remove
	$bangalore_wave6_spawn remove
	$right_engineer_spawn remove
	$mg42_bunker_target remove
	$higgins1_coxswain_spot remove
	$higgins_runup_mortar1 remove
	$higgins_runup_mortar2 remove
	$higgins_runup_mortar3 remove
	$higgins_runup_mortar4 remove
	$higgins_runup_mortar5 remove
	$higgins_runup_mortar6 remove
	$higgins2_mortar remove
	$higgins_fleet remove

	if(getcvar("g_ubermods") != "1" && getcvar("g_ubermods") != "2")
	{
		$hedgehog_explosive_hog_left_clip remove
		$hedgehog_explosive_hog_left_blow_clip remove
		$barbwire_fence1 remove
		$barbwire_fence3 remove
		$higgins1_clip_player remove
		$barbwire_fence_collision remove
		$barbwire_fence_collision_player remove
		$barbwire_fence2 remove // wooden tetrapost between barbwire
		$bangalore1 remove
		$bangalore2 remove
		$bangalore3 remove

		$higgins1_door_clip remove
		$higgins2_door_clip remove
		$higgins3_door_clip remove
		$higgins4_door_clip remove
		$higgins5_door_clip remove
		$higgins6_door_clip remove
		$higgins1_clip remove
		$higgins2_clip remove
		$higgins3_clip remove
		$higgins4_clip remove
		$higgins5_clip remove
		$higgins6_clip remove
		$higgins1_door remove
		$higgins2_door remove
		$higgins3_door remove
		$higgins4_door remove
		$higgins5_door remove
		$higgins6_door remove
		$higgins1_model remove
		$higgins2_model remove
		$higgins3_model remove
		$higgins4_model remove
		$higgins5_model remove
		$higgins6_model remove
		$higgins1 remove
		$higgins2 remove
		$higgins3 remove
		$higgins4 remove
		$higgins5 remove
		$higgins6 remove
		$higgins1_move remove
		$higgins2_move remove
		$higgins3_move remove
		$higgins4_move remove
		$higgins5_move remove
		$higgins6_move remove
		$higgins1_door_origin remove
		$higgins2_door_origin remove
		$higgins3_door_origin remove
		$higgins4_door_origin remove
		$higgins5_door_origin remove
		$higgins6_door_origin remove
		$higgins1_move2 remove
		$higgins2_move2 remove
		$higgins3_move2 remove
		$higgins4_move2 remove
		$higgins5_move2 remove
		$higgins6_move2 remove
	}
	else
	{
		thread touching_ocean ocean
		thread ocean_blocker

		thread bangalores_init 0 1 // red light (0 = no, 1 = yes), hold USE(e) to plant (0 = no, 1 = yes).
		thread bangalore bangalore1
		thread bangalore bangalore2	// only need one bangalore to blow up the barbwire.
		thread bangalore bangalore3

		thread start_higgins_setups
	}

	$ocean_calm hide
	$ocean_wavy show

	//$ocean_wavy remove
	//$ocean_calm remove
	//$hedgehog_explosive_hog_right remove
	//$hedgehog_explosive_hog_left remove
	//$hedgehog_explosive_hog_left_blow remove
	//$ambient_shore remove
	//$progress_player remove // already removed by removeclasses
	//$minefield remove // already removed by removeclasses

	if($minefield != NULL)
	{
		local.master aliascache explode_mine1 sound/weapons/explo/Explo_Grenade1.wav soundparms 1.0 0.2 0.8 0.4 1000 9000 weapon loaded maps level.mapname
		local.master aliascache explode_mine2 sound/weapons/explo/Explo_Grenade2.wav soundparms 1.0 0.2 0.8 0.4 1000 9000 weapon loaded maps level.mapname
		local.master aliascache explode_mine3 sound/weapons/explo/Explo_Grenade3.wav soundparms 1.0 0.2 0.8 0.4 1000 9000 weapon loaded maps level.mapname
		local.master aliascache explode_mine4 sound/weapons/explo/Explo_Grenade4.wav soundparms 1.0 0.2 0.8 0.4 1000 9000 weapon loaded maps level.mapname
		local.master aliascache mine_trigger sound/weapons/foley/MineTrigger1.wav soundparms 1.0 0.0 1.0 0.0 100 2000 item loaded maps level.mapname
	}

	level.springfield = 1								
	level.bar = 1								
	level.bazooka = 1	
	level.mp44 = 1		
	level.shotgun = 1
	level.rifle = 1	
end

////////////////////////////////////////////////////////////////////////

airstrikes_alternate:

	if(getcvar("g_ubermods") != "1" && getcvar("g_ubermods") != "2") { end }

	level.bomberplane_health = 200 		// these are defaults set inside global/bomberplane_nospline.scr
	level.bomberplane_bombspeed = 0.25	// speed multiplier; higher = bombs drop horizontally further away from plane's splinepath
	level.bomberplane_bombgravity = 2	// higher = bombs drop faster vertically & closer to plane's splinepath
	level.bomberplane_bombspawntime = 0.2	// time between spawning bombs; lower = bombs spawn less often.
	level.bomberplane_speed = 2350		// lower = planes move slower.
								// keep setsize1 height = 0, unless setsize2 height is < 0.
	level.bomberplane_map_setsize1 = ( -7871 -7999 0 )	// just like a .tik file, adjust these map_setsizes so the planes aren't dropping bombs outside of the map (also includes skybox height).
	level.bomberplane_map_setsize2 = ( 7999 7935 1423 )	// setsize1 should be corner of 3rd quadrant (-x min and -y min). setsize2 should be corner of 1st quadrant (+x max and +y max).

	while(1) //parameters: team (allies, axis, c47), number of planes, off time, bombs off (0 = no, 1 = yes), amount of bombs, time until bombs drop, end (1 = only do 1 airstrike)
	{
		local.rtime = randomint(90) + 60	// randomize time between 90 and 180 seconds. NOTE: any offtime between 1 and 2 is essentially waiting 0 seconds.
		local.r = randomint(2)
		if(getcvar("g_ubermods") == "2") { local.bombs = 25; local.timetodrop = 0.1 }	// these are NIL if g_ubermods = 1, preventing bombs from dropping.

		if(local.r == 0) { waitexec global/bomberplane_nospline.scr axis 2 local.rtime local.bombs local.timetodrop 1 }	// axis = 50% chance
		if(local.r == 1)												// allies = 33% chance
		{														// c47 = 17% chance
			local.r2 = randomint(5)
			if(local.r2 == 0 || local.r2 == 1) { waitexec global/bomberplane_nospline.scr allies 2 local.rtime local.bombs local.timetodrop 1 }
			if(local.r2 == 2 || local.r2 == 3) { waitexec global/bomberplane_nospline.scr allies 2 local.rtime local.bombs local.timetodrop 1 }
			if(local.r2 == 4) { waitexec global/bomberplane_nospline.scr c47 2 local.rtime local.bombs local.timetodrop 1 }
			if(local.r2 == 5) { waitexec global/bomberplane_nospline.scr c47 2 local.rtime local.bombs local.timetodrop 1 }
		}
		waitframe
	}
end

////////////////////////////////////////////////////////////////////////

start_higgins_setups:

	for(local.h = 1; local.h <= 6; local.h++)
	{
		$("higgins" + local.h + "_door") hide
		$("higgins" + local.h + "_model") hide
		$("higgins" + local.h + "_clip") hide
		$("higgins" + local.h + "_door_clip") hide
		$("higgins" + local.h) hide

		$("higgins" + local.h + "_door") notsolid
		$("higgins" + local.h + "_model") notsolid
		$("higgins" + local.h + "_clip") notsolid
		$("higgins" + local.h + "_door_clip") notsolid
		$("higgins" + local.h) notsolid
	}

	wait (30 + randomint(120))
	iprintlnbold("*** Higgins Boats are approaching! ***")
	println("----- Higgins Boats are approaching!")

	for(local.h = 1; local.h <= 6; local.h++)
	{
		$("higgins" + local.h + "_door") show
		$("higgins" + local.h + "_model") show
		$("higgins" + local.h + "_clip") show
		$("higgins" + local.h + "_door_clip") show
		$("higgins" + local.h) show

		$("higgins" + local.h + "_door") solid
		$("higgins" + local.h + "_model") solid
		$("higgins" + local.h + "_clip") solid
		$("higgins" + local.h + "_door_clip") solid
		$("higgins" + local.h) solid

		$("higgins" + local.h) thread setup_higgins 250 // boat health (boosted/held at 250, so bullets cannot kill them). $higgins2 always blows up, and will never respawn.
	}
end

////////////////////////////////////////////////////////////////////////

setup_higgins local.health local.restarted:

	self.thread0 = 1
	self.thread1 = 0
	self.thread2 = 0
	self.thread3 = 0
	if(self.targetname == "higgins3") { local.dist = 512 }
	if(self.targetname == "higgins4") { local.dist = 768 }
	if(self.targetname == "higgins5") { local.dist = 448 }
	if(self.targetname == "higgins6") { local.dist = 384 }
	$(self.targetname + "_model").model = "models/vehicles/higginsxtrahull.tik"
	self.landed = 0

	waitthread higgins_boat_bind self $(self.targetname + "_model") $(self.targetname + "_clip") $(self.targetname + "_move") $(self.targetname + "_move2") $(self.targetname + "_door") $(self.targetname + "_door_origin") $(self.targetname + "_door_clip") $(self.targetname + "_spray_left") $(self.targetname + "_spray_right")

	if(local.dist != NIL)
	{
		$(self.targetname + "_move2") time 8
		$(self.targetname + "_move2") movenorth local.dist
		$(self.targetname + "_move2") move
		local.origin = $(self.targetname + "_move2").origin + ( 0 local.dist 0 )
		while(self != NULL && self.dead != 1 && $(self.targetname + "_move2").origin != local.origin) { waitframe }
	}
	else
	{
		local.c = 0
		while(self != NULL && self.dead != 1 && local.c <= 160) { local.c++; wait 0.05 } //wait 8
	}
	if(self.dead == 1) { self.thread0 = 0; end }

	local.damagetrig = spawn trigger_multiple spawnflags 128
	local.damagetrig.targetname = (self.targetname + "_damagetrig")
	local.damagetrig.origin = $(self.targetname + "_model").origin
	local.damagetrig setsize ( -320 -100 -10 ) ( 275 100 70 )
	local.damagetrig.health = local.health
	local.damagetrig.name = self.targetname
	local.damagetrig thread healthboost
	local.damagetrig glue $(self.targetname + "_model")

	local.num = int(string(self.targetname[self.targetname.size - 1]))
	self thread higgins_wave_motions local.num
	$(self.targetname + "_move") thread higgins_forward_motions local.num

	$(self.targetname + "_move2") time 20
	$(self.targetname + "_move2") movenorth 1800
	$(self.targetname + "_move2") move
	local.origin = $(self.targetname + "_move2").origin + ( 0 1800 0 )
	while(self != NULL && self.dead != 1 && $(self.targetname + "_move2").origin != local.origin) { waitframe }
	if(self.dead == 1) { self.thread0 = 0; end }

	$(self.targetname + "_move").stop_forward_motion = 1

	$(self.targetname + "_move2") time 10
	$(self.targetname + "_move2") movenorth 600
	$(self.targetname + "_move2") move
	local.origin = $(self.targetname + "_move2").origin + ( 0 600 0 )
	while(self != NULL && self.dead != 1 && $(self.targetname + "_move2").origin != local.origin) { waitframe }
	if(self.dead == 1) { self.thread0 = 0; end }

	if(local.num != 2) { thread ("higgins" + local.num + "_landing") }
	else { thread higgins2_blow }
	self.thread0 = 0
end

healthboost: // shotgun: 340 damage, bazooka: 105 damage, sniper: 106 damage, one grenade: 200 damage, two grenades: 400 damage

	local.health = self.health
	while(self != NULL && self.health > 0)
	{
		if(isalive self) { self.health = local.health } // need "isalive" check to avoid "cannot give health to dead entities" error
		waitframe
	}
	$(self.name) thread higgins_death local.health
	self remove
end

//*************************************************
//*************************************************
//  Binding the Higgins boats and get them moving
higgins_boat_bind local.higgins_origin local.higgins_model local.higgins_clip local.higgins_move local.higgins_move2 local.higgins_door local.higgins_door_origin local.higgins_door_clip local.higgins_spray_left local.higgins_spray_right:

	local.higgins_model bind local.higgins_origin
	local.higgins_model notsolid
	local.higgins_model.model = "models/vehicles/higginsxtrahull.tik"
	local.higgins_model loopsound sdkfzsndidle

	if(local.higgins_origin.targetname != "higgins1")
	{
		local.offset = 32
		local.higgins_move2.origin += ( 0 0 local.offset )
		local.higgins_move.origin += ( 0 0 local.offset )
		local.higgins_origin.origin += ( 0 0 local.offset )
		local.higgins_door_origin.origin += ( 0 0 local.offset )
		local.higgins_door.origin += ( 0 0 local.offset )
		local.higgins_model.origin += ( 0 0 local.offset )
		local.higgins_clip.origin += ( 0 120 20 )
		local.higgins_door_clip.origin += ( 0 0 local.offset )
		local.higgins_spray_left.origin += ( 0 0 local.offset )
		local.higgins_spray_right.origin += ( 0 0 local.offset )
	}

	local.higgins_door notsolid
	local.higgins_door_origin notsolid
	local.higgins_door bind local.higgins_door_origin
	local.higgins_door_clip bind local.higgins_door_origin
	local.higgins_door_origin bind local.higgins_origin

	local.higgins_spray_left bind local.higgins_origin
	local.higgins_spray_right bind local.higgins_origin

	local.higgins_origin bind local.higgins_move

	if(local.higgins_origin.targetname == "higgins1") { local.higgins_clip bind local.higgins_origin }
	else { local.higgins_clip bind local.higgins_move2 }

	local.higgins_move bind local.higgins_move2

	local.higgins_clip hide
	local.higgins_door_clip hide
	local.higgins_move2 time .1
	local.higgins_move time .1
	local.higgins_origin time .1
	local.higgins_origin rotatezdown 1.5
	local.higgins_origin movedown 20
	local.higgins_origin waitmove
end

//*************************************************
//*************************************************
//  Higgins boat waving motions
higgins_wave_motions local.higgins_number:

	self.thread1 = 1
	self.stop = 0
	local.flip = 0
	self time 1

	local.random = randomfloat 3
	wait local.random

	while(self.dead != 1 && self.stop == 0)
	{
		if (local.flip == 0) { self rotatexup 1 }
		else { self rotatexdown 1 }
		
		$("higgins" + local.higgins_number + "_spray_right") anim start
		$("higgins" + local.higgins_number + "_spray_right") playsound wave_crash
		
		self movedown 6
		self move
		local.origin = self.origin + ( 0 0 -6 )
		while(self != NULL && self.dead != 1 && self.origin[2] != local.origin[2]) { waitframe }
		if(self.dead == 1) { break }
			
		$("higgins" + local.higgins_number + "_spray_right") anim stop
		if (local.flip == 0) { self rotatexup 1.5 }
		else { self rotatexdown 1.5 }
		
		$("higgins" + local.higgins_number + "_spray_left") anim start
		$("higgins" + local.higgins_number + "_spray_left") playsound wave_crash
				
		self rotatezup 1.5
		self movedown 3
		self move
		local.origin = self.origin + ( 0 0 -3 )
		while(self != NULL && self.dead != 1 && self.origin[2] != local.origin[2]) { waitframe }
		if(self.dead == 1) { break }
				
		$("higgins" + local.higgins_number + "_spray_left") anim stop
		if (local.flip == 0) { self rotatexup 1.5 }
		else { self rotatexdown 1.5 }
		self rotatezup 1.5
		self moveup 3
		self move
		local.origin = self.origin + ( 0 0 3 )
		while(self != NULL && self.dead != 1 && self.origin[2] != local.origin[2]) { waitframe }
		if(self.dead == 1) { break }
						
		if (local.flip == 0) { self rotatexup 1 }
		else { self rotatexdown 1 }
		self moveup 6
		self move
		local.origin = self.origin + ( 0 0 6 )
		while(self != NULL && self.dead != 1 && self.origin[2] != local.origin[2]) { waitframe }
		if(self.dead == 1) { break }

		if (local.flip == 0) { self rotatexup 1.5 }
		else { self rotatexdown 1.5 }								
		self rotatezdown 1.5
		self moveup 3
		self move
		local.origin = self.origin + ( 0 0 3 )
		while(self != NULL && self.dead != 1 && self.origin[2] != local.origin[2]) { waitframe }
		if(self.dead == 1) { break }
			
		if (local.flip == 0) { self rotatexdown 2.5 }
		else { self rotatexup 2.5 }					
		self rotatezdown 1.5
		self movedown 3
		self move
		local.origin = self.origin + ( 0 0 -3 )
		while(self != NULL && self.dead != 1 && self.origin[2] != local.origin[2]) { waitframe }
		if(self.dead == 1) { break }
								
		if (local.flip == 0) { local.flip = 1 }
		else { local.flip = 0 }						
	}
	self.thread1 = 0
end

//*************************************************
//*************************************************
//  Higgins boat forward / backward motions
higgins_forward_motions local.higgins_number:

	self.stop_forward_motion = 0
	$("higgins" + local.higgins_number).thread2 = 1

	while($("higgins" + local.higgins_number).dead != 1 && self.stop_forward_motion == 0)
	{
		local.random_time = (randomint 3 + 4)
		self time local.random_time
		local.move_distance = (randomint 48 + 96)
			
		self movenorth local.move_distance
		self move
		local.origin = self.origin + ( 0 local.move_distance 0 )
		while($("higgins" + local.higgins_number) != NULL && $("higgins" + local.higgins_number).dead != 1 && self.origin[1] != local.origin[1]) { waitframe }
		if($("higgins" + local.higgins_number).dead == 1) { break }
			
		local.random_time = randomint 2
		local.c = 0
		while($("higgins" + local.higgins_number) != NULL && $("higgins" + local.higgins_number).dead != 1 && local.c <= (local.random_time / 0.05000)) { local.c++; wait 0.05 } //wait local.random_time
		if($("higgins" + local.higgins_number).dead == 1) { break }
			
		self movesouth local.move_distance
		self move
		local.origin = self.origin + ( 0 (local.move_distance * -1) 0 )
		while($("higgins" + local.higgins_number) != NULL && $("higgins" + local.higgins_number).dead != 1 && self.origin[1] != local.origin[1]) { waitframe }
		if($("higgins" + local.higgins_number).dead == 1) { break }
			
		local.c = 0
		while($("higgins" + local.higgins_number) != NULL && $("higgins" + local.higgins_number).dead != 1 && local.c <= (local.random_time / 0.05000)) { local.c++; wait 0.05 } //wait local.random_time
		if($("higgins" + local.higgins_number).dead == 1) { break }
	}
	$("higgins" + local.higgins_number).thread2 = 0
end

//*****************************
//*****************************
//*** higgins boat 1 landing
higgins1_landing:

	$higgins1.thread3 = 1
	$higgins1_move2 time 3
	$higgins1_move2 rotatexup 15
	$higgins1_move2 rotateydown 5	// moveeast = ( + 0 0 ), movewest = ( - 0 0 )
	$higgins1_move2 moveeast 48	// movenorth = ( 0 + 0 ), movesouth = ( 0 - 0 )
	$higgins1_move2 movenorth 32	// moveup = ( 0 0 + ), movedown = ( 0 0 - )
	$higgins1_move2 move
	local.origin = $higgins1_move2.origin + ( 48 32 0 )
	while($higgins1 != NULL && $higgins1.dead != 1 && $higgins1_move2.origin != local.origin) { waitframe } // replaces "waitmove", so the script can end early if "dead = 1".
	if($higgins1.dead == 1) { $higgins1.thread3 = 0; end }

	$higgins1_move2 time 2
	$higgins1_move2 rotatexdown 15
	$higgins1_move2 rotateyup 5
	$higgins1_move2 moveeast 24
	$higgins1_move2 movenorth 160
	$higgins1_move2 move
	local.origin = $higgins1_move2.origin + ( 24 160 0 )
	while($higgins1 != NULL && $higgins1.dead != 1 && $higgins1_move2.origin != local.origin) { waitframe }
	if($higgins1.dead == 1) { $higgins1.thread3 = 0; end }

	$higgins1_move2 time 10
	$higgins1_move2 rotateydown 7
	$higgins1_move2 movenorth 1224
	$higgins1_move2 moveeast 32
	$higgins1_move2 move
	local.origin = $higgins1_move2.origin + ( 32 1224 0 )
	while($higgins1 != NULL && $higgins1.dead != 1 && $higgins1_move2.origin != local.origin) { waitframe }
	if($higgins1.dead == 1) { $higgins1.thread3 = 0; end }

	$higgins1_move2 time 6
	$higgins1_move2 rotateyup 7
	$higgins1_move2 movenorth 368
	$higgins1_move2 moveeast 32
	$higgins1_move2 move
	local.origin = $higgins1_move2.origin + ( 32 368 0 )
	while($higgins1 != NULL && $higgins1.dead != 1 && $higgins1_move2.origin != local.origin) { waitframe }
	if($higgins1.dead == 1) { $higgins1.thread3 = 0; end }

	$higgins1.stop = 1

	$higgins1_move2 time 7
	$higgins1_move2 movenorth 300
	$higgins1_move2 move
	local.origin = $higgins1_move2.origin + ( 0 300 0 )
	while($higgins1 != NULL && $higgins1.dead != 1 && $higgins1_move2.origin != local.origin) { waitframe }
	if($higgins1.dead == 1) { $higgins1.thread3 = 0; end }

	$higgins1 time 2
	$higgins1 rotatezup 2
	$higgins1 movedown 8
	$higgins1 move
	local.origin = $higgins1.origin + ( 0 0 -8 )
	while($higgins1 != NULL && $higgins1.dead != 1 && $higgins1.origin != local.origin) { waitframe }
	if($higgins1.dead == 1) { $higgins1.thread3 = 0; end }

	$higgins1_model stoploopsound
	$higgins1_model playsound sdkfz_snd_off
	$higgins1_door playsound higgins_door_opening
	local.c = 0
	while($higgins1 != NULL && $higgins1.dead != 1 && local.c <= 46) { local.c++; wait 0.05 } //wait 2.3
	if($higgins1.dead == 1) { $higgins1.thread3 = 0; $higgins1_door stopsound; $higgins1_model stopsound; end }

	$higgins1_door_origin time .65
	$higgins1_door_origin rotatezdown 90
	$higgins1_door_origin waitmove
	if($higgins1.dead == 1) { $higgins1.thread3 = 0; end }

	$higgins1 thread higgins_inwater_tele
	$higgins1.thread3 = 0
	$higgins1.landed = 1
end

higgins2_blow:

	$higgins2.thread3 = 1
	local.c = 0
	while($higgins2 != NULL && $higgins2.dead != 1 && local.c <= 120) { local.c++; wait 0.05 } //wait 6
	if($higgins2.dead == 1) { $higgins2.thread3 = 0 }

	$higgins2_model stoploopsound
	$higgins2_model playsound arty_leadinmp
	local.c = 0
	while($higgins2 != NULL && $higgins2.dead != 1 && local.c <= 22) { local.c++; wait 0.05 } //wait 1.1
	if($higgins2.dead == 1) { $higgins2.thread3 = 0; $higgins2 stopsound; end }
	$higgins2 thread higgins_death
	$higgins2.thread3 = 0
end

higgins3_landing:

	$higgins3.thread3 = 1
	wait 1.5

	$higgins3_move2 time 3
	$higgins3_move2 rotatexdown 12
	$higgins3_move2 rotateyup 5
	$higgins3_move2 movewest 24
	$higgins3_move2 movenorth 32
	$higgins3_move2 move
	local.origin = $higgins3_move2.origin + ( -24 32 0 )
	while($higgins3 != NULL && $higgins3.dead != 1 && $higgins3_move2.origin != local.origin) { waitframe }
	if($higgins3.dead == 1) { $higgins3.thread3 = 0; end }

	$higgins3_move2 time 2
	$higgins3_move2 rotatexup 12
	$higgins3_move2 rotateydown 5
	$higgins3_move2 movewest 12
	$higgins3_move2 movenorth 128
	$higgins3_move2 move
	local.origin = $higgins3_move2.origin + ( -12 128 0 )
	while($higgins3 != NULL && $higgins3.dead != 1 && $higgins3_move2.origin != local.origin) { waitframe }
	if($higgins3.dead == 1) { $higgins3.thread3 = 0; end }

	$higgins3_move2 time 13
	$higgins3_move2 rotateydown 7
	$higgins3_move2 movenorth 1100
	$higgins3_move2 moveeast 120
	$higgins3_move2 move
	local.origin = $higgins3_move2.origin + ( 120 1100 0 )
	while($higgins3 != NULL && $higgins3.dead != 1 && $higgins3_move2.origin != local.origin) { waitframe }
	if($higgins3.dead == 1) { $higgins3.thread3 = 0; end }

	$higgins3_move2 time 5
	$higgins3_move2 rotateyup 7
	$higgins3_move2 movenorth 300
	$higgins3_move2 moveeast 90
	$higgins3_move2 move
	local.origin = $higgins3_move2.origin + ( 90 300 0 )
	while($higgins3 != NULL && $higgins3.dead != 1 && $higgins3_move2.origin != local.origin) { waitframe }
	if($higgins3.dead == 1) { $higgins3.thread3 = 0; end }

	$higgins3.stop = 1

	$higgins3_move2 time 6
	$higgins3_move2 movenorth 250
	$higgins3_move2 move
	local.origin = $higgins3_move2.origin + ( 0 250 0 )
	while($higgins3 != NULL && $higgins3.dead != 1 && $higgins3_move2.origin != local.origin) { waitframe }
	if($higgins3.dead == 1) { $higgins3.thread3 = 0; end }

	$higgins3 time 2
	$higgins3 rotatezup 2
	$higgins3 moveup 8
	$higgins3 move
	local.origin = $higgins3.origin + ( 0 0 8 )
	while($higgins3 != NULL && $higgins3.dead != 1 && $higgins3.origin != local.origin) { waitframe }
	if($higgins3.dead == 1) { $higgins3.thread3 = 0; end }

	$higgins3_model stoploopsound
	$higgins3_model playsound sdkfz_snd_off
	$higgins3_door playsound higgins_door_opening
	local.c = 0
	while($higgins3 != NULL && $higgins3.dead != 1 && local.c <= 46) { local.c++; wait 0.05 } //wait 2.3
	if($higgins3.dead == 1) { $higgins3.thread3 = 0; $higgins3_door stopsound; $higgins3_model stopsound; end }

	$higgins3_door_origin time .75
	$higgins3_door_origin rotatezdown 90
	$higgins3_door_origin waitmove
	if($higgins3.dead == 1) { $higgins3.thread3 = 0; end }

	$higgins3 thread higgins_inwater_tele 1 -2353
	$higgins3 thread higgins_onboat_tele -2558
	$higgins3.thread3 = 0
	$higgins3.landed = 1
end

higgins4_landing:

	$higgins4.thread3 = 1
	wait 2.5

	$higgins4_move2 time 13
	$higgins4_move2 rotateyup 24
	$higgins4_move2 movewest 512
	$higgins4_move2 movenorth 900
	$higgins4_move2 move
	local.origin = $higgins4_move2.origin + ( -512 900 0 )
	while($higgins4 != NULL && $higgins4.dead != 1 && $higgins4_move2.origin != local.origin) { waitframe }
	if($higgins4.dead == 1) { $higgins4.thread3 = 0; end }

	$higgins4_move2 time 8
	$higgins4_move2 rotateydown 24
	$higgins4_move2 movewest 448
	$higgins4_move2 movenorth 600
	$higgins4_move2 move
	local.origin = $higgins4_move2.origin + ( -448 600 0 )
	while($higgins4 != NULL && $higgins4.dead != 1 && $higgins4_move2.origin != local.origin) { waitframe }
	if($higgins4.dead == 1) { $higgins4.thread3 = 0; end }

	$higgins4.stop = 1

	$higgins4_move2 time 7
	$higgins4_move2 movenorth 350
	$higgins4_move2 move
	local.origin = $higgins4_move2.origin + ( 0 350 0 )
	while($higgins4 != NULL && $higgins4.dead != 1 && $higgins4_move2.origin != local.origin) { waitframe }
	if($higgins4.dead == 1) { $higgins4.thread3 = 0; end }

	$higgins4 time 2
	$higgins4 rotatezup 2
	$higgins4 moveup 8
	$higgins4 move
	local.origin = $higgins4.origin + ( 0 0 8 )
	while($higgins4 != NULL && $higgins4.dead != 1 && $higgins4.origin != local.origin) { waitframe }
	if($higgins4.dead == 1) { $higgins4.thread3 = 0; end }

	$higgins4_model stoploopsound
	$higgins4_model playsound sdkfz_snd_off
	$higgins4_door playsound higgins_door_opening
	local.c = 0
	while($higgins4 != NULL && $higgins4.dead != 1 && local.c <= 46) { local.c++; wait 0.05 } //wait 2.3
	if($higgins4.dead == 1) { $higgins4.thread3 = 0; $higgins4_door stopsound; $higgins4_model stopsound; end }

	$higgins4_door_origin time .75
	$higgins4_door_origin rotatezdown 90
	$higgins4_door_origin waitmove
	if($higgins4.dead == 1) { $higgins4.thread3 = 0; end }

	$higgins4 thread higgins_inwater_tele
	$higgins4.thread3 = 0
	$higgins4.landed = 1
end

higgins5_landing:

	$higgins5.thread3 = 1
	wait 1.5

	$higgins5_move2 time 3
	$higgins5_move2 rotatexup 12
	$higgins5_move2 rotateydown 5
	$higgins5_move2 moveeast 24
	$higgins5_move2 movenorth 32
	$higgins5_move2 move
	local.origin = $higgins5_move2.origin + ( 24 32 0 )
	while($higgins5 != NULL && $higgins5.dead != 1 && $higgins5_move2.origin != local.origin) { waitframe }
	if($higgins5.dead == 1) { $higgins5.thread3 = 0; end }

	$higgins5_move2 time 2
	$higgins5_move2 rotatexdown 12
	$higgins5_move2 rotateyup 5
	$higgins5_move2 moveeast 12
	$higgins5_move2 movenorth 128
	$higgins5_move2 move
	local.origin = $higgins5_move2.origin + ( 12 128 0 )
	while($higgins5 != NULL && $higgins5.dead != 1 && $higgins5_move2.origin != local.origin) { waitframe }
	if($higgins5.dead == 1) { $higgins5.thread3 = 0; end }

	$higgins5_move2 time 15
	$higgins5_move2 rotateydown 11
	$higgins5_move2 movenorth 1424
	$higgins5_move2 moveeast 160
	$higgins5_move2 move
	local.origin = $higgins5_move2.origin + ( 160 1424 0 )
	while($higgins5 != NULL && $higgins5.dead != 1 && $higgins5_move2.origin != local.origin) { waitframe }
	if($higgins5.dead == 1) { $higgins5.thread3 = 0; end }

	$higgins5_move2 time 7
	$higgins5_move2 rotateyup 11
	$higgins5_move2 movenorth 400
	$higgins5_move2 moveeast 110
	$higgins5_move2 move
	local.origin = $higgins5_move2.origin + ( 110 400 0 )
	while($higgins5 != NULL && $higgins5.dead != 1 && $higgins5_move2.origin != local.origin) { waitframe }
	if($higgins5.dead == 1) { $higgins5.thread3 = 0; end }

	$higgins5.stop = 1

	$higgins5_move2 time 6
	$higgins5_move2 movenorth 250
	$higgins5_move2 move
	local.origin = $higgins5_move2.origin + ( 0 250 0 )
	while($higgins5 != NULL && $higgins5.dead != 1 && $higgins5_move2.origin != local.origin) { waitframe }
	if($higgins5.dead == 1) { $higgins5.thread3 = 0; end }

	$higgins5 time 2
	$higgins5 rotatezup 2
	$higgins5 moveup 8
	$higgins5 move
	local.origin = $higgins5.origin + ( 0 0 8 )
	while($higgins5 != NULL && $higgins5.dead != 1 && $higgins5.origin != local.origin) { waitframe }
	if($higgins5.dead == 1) { $higgins5.thread3 = 0; end }

	$higgins5_model stoploopsound
	$higgins5_model playsound sdkfz_snd_off
	$higgins5_door playsound higgins_door_opening
	local.c = 0
	while($higgins5 != NULL && $higgins5.dead != 1 && local.c <= 46) { local.c++; wait 0.05 } //wait 2.3
	if($higgins5.dead == 1) { $higgins5.thread3 = 0; $higgins5_door stopsound; $higgins5_model stopsound; end }

	$higgins5_door_origin time .75
	$higgins5_door_origin rotatezdown 90
	$higgins5_door_origin waitmove
	if($higgins5.dead == 1) { $higgins5.thread3 = 0; end }

	$higgins5 thread higgins_inwater_tele 1 -1993
	$higgins5 thread higgins_onboat_tele -2216
	$higgins5.thread3 = 0
	$higgins5.landed = 1
end

higgins6_landing:

	$higgins6.thread3 = 1
	wait 2.5

	$higgins6_move2 time 16
	$higgins6_move2 rotateydown 24
	$higgins6_move2 moveeast 512
	$higgins6_move2 movenorth 1300
	$higgins6_move2 move
	local.origin = $higgins6_move2.origin + ( 512 1300 0 )
	while($higgins6 != NULL && $higgins6.dead != 1 && $higgins6_move2.origin != local.origin) { waitframe }
	if($higgins6.dead == 1) { $higgins6.thread3 = 0; end }

	$higgins6_move2 time 10
	$higgins6_move2 rotateyup 24
	$higgins6_move2 moveeast 448
	$higgins6_move2 movenorth 900
	$higgins6_move2 move
	local.origin = $higgins6_move2.origin + ( 448 900 0 )
	while($higgins6 != NULL && $higgins6.dead != 1 && $higgins6_move2.origin != local.origin) { waitframe }
	if($higgins6.dead == 1) { $higgins6.thread3 = 0; end }

	$higgins6.stop = 1

	$higgins6_move2 time 8.5
	$higgins6_move2 movenorth 400
	$higgins6_move2 move
	local.origin = $higgins6_move2.origin + ( 0 400 0 )
	while($higgins6 != NULL && $higgins6.dead != 1 && $higgins6_move2.origin != local.origin) { waitframe }
	if($higgins6.dead == 1) { $higgins6.thread3 = 0; end }

	$higgins6 time 2
	$higgins6 rotatezup 2
	$higgins6 moveup 8
	$higgins6 move
	local.origin = $higgins6.origin + ( 0 0 8 )
	while($higgins6 != NULL && $higgins6.dead != 1 && $higgins6.origin != local.origin) { waitframe }
	if($higgins6.dead == 1) { $higgins6.thread3 = 0; end }

	$higgins6_model stoploopsound
	$higgins6_model playsound sdkfz_snd_off
	$higgins6_door playsound higgins_door_opening
	local.c = 0
	while($higgins6 != NULL && $higgins6.dead != 1 && local.c <= 46) { local.c++; wait 0.05 } //wait 2.3
	if($higgins6.dead == 1) { $higgins6.thread3 = 0; $higgins6_door stopsound; $higgins6_model stopsound; end }

	$higgins6_door_origin time .75
	$higgins6_door_origin rotatezdown 90
	$higgins6_door_origin waitmove
	if($higgins6.dead == 1) { $higgins6.thread3 = 0; end }

	$higgins6 thread higgins_inwater_tele
	$higgins6.thread3 = 0
	$higgins6.landed = 1
end

////////////////////////////////////////////////////////////////////////

higgins_death local.health:

	self.dead = 1
	self.stop = 1
	$(self.targetname + "_move").stop_forward_motion = 1

	$(self.targetname + "_spray_left") anim start
	$(self.targetname + "_spray_right") anim start
	$(self.targetname + "_spray_left") loopsound boatsinking
	$(self.targetname + "_spray_right") loopsound boatsinking
	self thread waterspray $(self.targetname + "_spray_left") $(self.targetname + "_spray_right")

	self.origin += ( 0 0 -22 )
	self playsound higginsexplosion
	$(self.targetname + "_model").model = "models/vehicles/higgins_damage.tik"
	$(self.targetname + "_model") stoploopsound
	$(self.targetname + "_model") playsound explode_truck

	local.r = randomint(2)
	if(local.r == 0) { local.one = 1 }
	if(local.r == 1) { local.one = -1 }
	self.angles += ( ((randomint(30) + 5) * local.one) 0 0 )

	local.fire = spawn script_model
	local.fire model "models/emitters/fancyfire.tik"
	local.fire.origin = $(self.targetname + "_model").origin + ( 0 0 42 )
	local.fire.angles = ( 270 0 0 )
	local.fire.scale = 1
	local.fire anim start
	local.fire notsolid
	local.fire loopsound vehicledeathfire
	self thread bind_emitter local.fire
	local.smoke = spawn script_model
	local.smoke model "models/emitters/thin_black_short.tik"
	local.smoke.origin = $(self.targetname + "_model").origin + ( 0 0 42 )
	local.smoke.angles = ( 270 0 0 )
	local.smoke.scale = .7
	local.smoke anim start
	local.smoke notsolid
	local.smoke playsound boatsinkwave
	self thread bind_emitter local.smoke

	if(self.landed == 1) { exec global/earthquake.scr .35 2 0 0 }
	radiusdamage ($(self.targetname + "_model").origin + ( 0 0 50 )) 500 200

	local.boom = spawn script_model
	local.boom model "models/emitters/mortar_higgins.tik"
	local.boom.origin = $(self.targetname + "_model").origin + $(self.targetname + "_model").forwardvector * 100
	local.boom.angles = ( 0 -90 0 ) + ( 260 0 0 )
	local.boom.scale = 1
	local.boom anim start
	local.boom notsolid

	local.debris = spawn script_model
	local.debris model "emitters/mortar_dirt_nosound.tik" 
	local.debris.origin = $(self.targetname + "_model").origin + $(self.targetname + "_model").forwardvector * 100
	local.debris.scale = .8
	local.debris anim start
	local.debris notsolid
	waitframe
	local.boom remove
	local.debris remove

	self thread deadhiggins_movesounds

	//wait 2
	self time 20
	self rotatezup 22
	self movedown 250
	self movenorth 150
	self waitmove

	local.fire remove
	local.smoke remove

	if(self.targetname == "higgins2")
	{
		wait 60
		$(self.targetname + "_move2") remove
		$(self.targetname + "_move") remove
		$(self.targetname + "_door_origin") remove
		$(self.targetname + "_door") remove
		$(self.targetname + "_model") remove
		$(self.targetname + "_clip") remove
		$(self.targetname + "_door_clip") remove
		$(self.targetname + "_spray_left") remove
		$(self.targetname + "_spray_right") remove
		self remove
		end
	}
	else
	{	
		wait 40
		$(self.targetname + "_move2") unbind // unbinding these before respawning the higgins boats prevents them from unexpectedly dropping too low underwater (origin[2] lowers for some reason).
		$(self.targetname + "_move") unbind
		$(self.targetname + "_door_origin") unbind
		$(self.targetname + "_door") unbind
		$(self.targetname + "_model") unbind
		$(self.targetname + "_clip") unbind
		$(self.targetname + "_door_clip") unbind
		$(self.targetname + "_spray_left") unbind
		$(self.targetname + "_spray_right") unbind
		self unbind

		$(self.targetname + "_move2") hide
		$(self.targetname + "_move") hide
		$(self.targetname + "_door_origin") hide
		$(self.targetname + "_door") hide
		$(self.targetname + "_model") hide
		$(self.targetname + "_clip") hide
		$(self.targetname + "_door_clip") hide
		self hide
	}

	self thread higgins_restart local.health
end

deadhiggins_movesounds:

	self playsound snd_step_equipment
	wait .6
	self playsound snd_step_equipment

	wait 10

	$(self.targetname + "_spray_left") anim stop
	$(self.targetname + "_spray_right") anim stop
end

bind_emitter local.emitter:

	local.PI = 3.14159265359
	while(self != NULL && local.emitter != NULL)
	{
		local.degrees = self.angles[1]
		if(local.degrees >= 180) { local.degrees -= 360 }
		local.radians = local.degrees * (local.PI / 180)
		local.sin = (sin local.radians) * -70
		local.cos = (cos local.radians) * -70
		local.offset = (tan local.radians) * -70

		local.emitter.origin = self.origin + ( local.cos local.sin (42 - local.offset) )
		waitframe
	}
end

waterspray local.spray1 local.spray2:

	waitframe
	wait .6

	local.c = 0
	while(self != NULL && local.c <= 100)
	{
		local.c++
		wait .1
	}
	local.spray1 anim stop
	local.spray2 anim stop
	local.spray1 stoploopsound
	local.spray2 stoploopsound
	local.spray1 loopsound boatsunk
	local.spray2 loopsound boatsunk

	while(self != NULL && self.dead == 1) { waitframe }
	if(local.spray1 == NULL || local.spray2 == NULL) { end }
	local.spray1 stoploopsound
	local.spray2 stoploopsound
end

////////////////////////////////////////////////////////////////////////

higgins_restart local.health:

	while(self.thread0 == 1 || self.thread1 == 1 || self.thread2 == 1 || self.thread3 == 1) { waitframe } // wait for wavemotion, forwardmotion, and landing threads to prematurely end first.

	self.dead = 0
	if(self.targetname == "higgins1") // these need to exactly match the higgins' values right after the initial "higgins_boat_bind" script runs, otherwise the boats do not land in the same spots as before.
	{
		$higgins1_move2.origin = ( 384 -7872 -504 )
		$higgins1_move.origin = ( 384 -7872 -504 )
		$higgins1.origin = ( 384 -7808 -504 )
		$higgins1_door_origin.origin = ( 384 -7266 -472 )
		$higgins1_door.origin = ( 381.540009 -7531 -512 )
		$higgins1_model.origin = ( 382.720001 -7530.819824 -511.660004 )
		$higgins1_clip.origin = ( 382 -7453 -445 )
		$higgins1_door_clip.origin = ( 381 -7245 -418 )
		$higgins1_spray_left.origin = ( 184 -7160 -472 )
		$higgins1_spray_right.origin = ( 584 -7160 -472 )
	}
	if(self.targetname == "higgins3")
	{
		$higgins3_move2.origin = ( -528 -7872 -536 )
		$higgins3_move.origin =  ( -528 -7872 -536 )
		$higgins3.origin = ( -528 -7808 -536 )
		$higgins3_door_origin.origin = ( -528 -7266 -504 )
		$higgins3_door.origin = ( -530.460022 -7531 -544 )
		$higgins3_model.origin = ( -529.280029 -7528.819824 -543.719971 )
		$higgins3_clip.origin = ( -531 -7484 -480 )
		$higgins3_door_clip.origin = ( -531 -7245 -449 )
		$higgins3_spray_left.origin = ( -648 -7224 -504 )
		$higgins3_spray_right.origin = ( -408 -7224 -504 )
	}
	if(self.targetname == "higgins4")
	{
		$higgins4_move2.origin = ( -904 -7872 -536 )
		$higgins4_move.origin = ( -904 -7872 -536 )
		$higgins4.origin = ( -904 -7808 -536 )
		$higgins4_door_origin.origin = ( -904 -7266 -504 )
		$higgins4_door.origin = ( -906.460022 -7531 -544 )
		$higgins4_model.origin = ( -901.280029 -7528.819824 -543.719971 )
		$higgins4_clip.origin = ( -903 -7529 -469 )
		$higgins4_door_clip.origin = ( -907 -7245 -449 )
		$higgins4_spray_left.origin = ( -1024 -7224 -504 )
		$higgins4_spray_right.origin = ( -784 -7224 -504 )
	}
	if(self.targetname == "higgins5")
	{
		$higgins5_move2.origin = ( 912 -7872 -536 )
		$higgins5_move.origin =  ( 912 -7872 -536 )
		$higgins5.origin = ( 912 -7808 -536 )
		$higgins5_door_origin.origin = ( 912 -7266 -504 )
		$higgins5_door.origin = ( 909.539978 -7531 -544 )
		$higgins5_model.origin = ( 910.719971 -7528.819824 -543.719971 )
		$higgins5_clip.origin = ( 909 -7484 -480 )
		$higgins5_door_clip.origin = ( 909 -7245 -449 )
		$higgins5_spray_left.origin = ( 792 -7224 -504 )
		$higgins5_spray_right.origin = ( 1024 -7224 -504 )
	}
	if(self.targetname == "higgins6")
	{
		$higgins6_move2.origin = ( 1360 -7872 -536 )
		$higgins6_move.origin =  ( 1360 -7872 -536 )
		$higgins6.origin = ( 1360 -7808 -536 )
		$higgins6_door_origin.origin = ( 1360 -7266 -504 )
		$higgins6_door.origin = ( 1357.540039 -7531 -544 )
		$higgins6_model.origin = ( 1358.719971 -7528.819824 -543.719971 )
		$higgins6_clip.origin = ( 1357 -7529 -469 )
		$higgins6_door_clip.origin = ( 1357 -7245 -449 )
		$higgins6_spray_left.origin = ( 1240 -7224 -504 )
		$higgins6_spray_right.origin = ( 1472 -7224 -504 )
	}

	$(self.targetname + "_move2").angles = ( 0 0 0 )
	$(self.targetname + "_move").angles = ( 0 0 0 )
	self.angles = ( 0 0 0 )
	$(self.targetname + "_door_origin").angles = ( 0 0 0 )
	$(self.targetname + "_door").angles = ( 0 90 0 )
	$(self.targetname + "_model").angles = ( 0 90 0 )
	$(self.targetname + "_clip").angles = ( 0 0 0 )
	$(self.targetname + "_door_clip").angles = ( 0 0 0 )
	$(self.targetname + "_spray_left").angles = ( 0 0 0 )
	$(self.targetname + "_spray_right").angles = ( 0 0 0 )

	$(self.targetname + "_move2") show
	$(self.targetname + "_move") show
	$(self.targetname + "_door_origin") show
	$(self.targetname + "_door") show
	$(self.targetname + "_model") show
	$(self.targetname + "_clip") show
	$(self.targetname + "_door_clip") show
	self show

	self thread setup_higgins local.health 1
end

////////////////////////////////////////////////////////////////////////

higgins_inwater_tele local.longerdist:

	local.yaxis = $(self.targetname + "_door_clip").origin[1] + 120

	local.PI = 3.14159265359
	while(self != NULL && $(self.targetname + "_door") != NULL && self.dead != 1)
	{
		for(local.i = 1; local.i <= $player.size; local.i++)
		{
			local.degrees = $player[local.i].angles[1]
			if(local.degrees >= 180) { local.degrees -= 360 }
			local.radians = local.degrees * (local.PI / 180)

			if(local.longerdist != 1 && $player[local.i].origin[2] <= -550 && $player[local.i] istouching $(self.targetname + "_door"))
			{
				local.sin = (sin local.radians) * 60
				local.cos = (cos local.radians) * 60
				$player[local.i].origin += ( local.cos local.sin 1000 )
				$player[local.i].origin = trace $player[local.i].origin ($player[local.i].origin + ( 0 0 -2000 )) 0
				$player[local.i].origin += ( 0 0 10 )
				$player[local.i] thread wallstuck_fix
			}

			if(local.longerdist == 1 && vector_length($(self.targetname + "_door").origin - $player[local.i].origin) < 420 && $player[local.i].origin[2] <= -575 && local.radians > -2.094 && local.radians < -1.048 && $player[local.i].origin[1] <= local.yaxis)
			{
				$player[local.i].origin = ( self.origin[0] ($player[local.i].origin[1] - 250) ($player[local.i].origin[2] + 1000) )
				$player[local.i].origin = trace $player[local.i].origin ($player[local.i].origin + ( 0 0 -2000 )) 0
				$player[local.i].origin += ( 0 0 10 )
				$player[local.i] thread wallstuck_fix
			}
		}
		waitframe
	}
end

higgins_onboat_tele:

	local.yaxis = $(self.targetname + "_door").origin[1] - 50

	local.PI = 3.14159265359
	while(self != NULL && self.dead != 1)
	{
		for(local.i = 1; local.i <= $player.size; local.i++)
		{
			local.degrees = $player[local.i].angles[1]
			if(local.degrees >= 180) { local.degrees -= 360 }
			local.radians = local.degrees * (local.PI / 180)

			if($player[local.i] istouching $(self.targetname + "_model") && $player[local.i].origin[2] <= -410 && local.radians > 1.048 && local.radians < 2.094 && $player[local.i].origin[1] >= local.yaxis)
			{
				local.sin = (sin local.radians) * 250
				local.cos = (cos local.radians) * 250
				$player[local.i].origin += ( local.cos local.sin 1000 )
				$player[local.i].origin = trace $player[local.i].origin ($player[local.i].origin + ( 0 0 -2000 )) 0
				$player[local.i].origin += ( 0 0 50 )
				$player[local.i] thread wallstuck_fix
			}
		}
		waitframe
	}
end

wallstuck_fix:

	local.c = 0
	local.origin = self.origin
	local.team = self.dmteam

	if(self.wallstuck_fixing == 1) { end }
	self.wallstuck_fixing = 1

	while(self != NULL && isalive self && self.dmteam == local.team) // while player is stuck in a wall (falling) and origin isn't changing, count a few seconds, then respawn the player
	{
		if(local.c >= 60) // about 3 seconds
		{
			if((self getmovement) == falling && self.origin == local.origin) { self respawn }
			if(self.isdog == 1) { self hide }
			break
		}
		local.c++
		waitframe
	}
	if(self != NULL) { self.wallstuck_fixing = 0 }
end

////////////////////////////////////////////////////////////////////////

ocean_blocker:

	while(1)
	{
		for(local.a = 0; local.a <= level.drivable_entities.size; local.a++)
		{
			for(local.s = 1; $(level.drivable_entities[local.a]) != NULL && local.s <= $(level.drivable_entities[local.a]).size; local.s++)
			{
				if($(level.drivable_entities[local.a])[local.s].origin[1] >= -2736 && $(level.drivable_entities[local.a])[local.s].model == "models/vehicles/higginsxtrahull.tik")
				{
					$(level.drivable_entities[local.a])[local.s].origin += ( 0 -200 200 )
				}
				if($(level.drivable_entities[local.a])[local.s].origin[1] <= -2736 && $(level.drivable_entities[local.a])[local.s].model != "models/vehicles/higginsxtrahull.tik")
				{
					$(level.drivable_entities[local.a])[local.s].origin += ( 0 200 200 )
				}
			}
		}
		waitframe
	}
end

////////////////////////////////////////////////////////////////////////

vehicles_undermap:

	while(1)
	{
		for(local.a = 0; local.a <= level.drivable_entities.size; local.a++)
		{
			for(local.s = 1; $(level.drivable_entities[local.a]) != NULL && local.s <= $(level.drivable_entities[local.a]).size; local.s++)
			{
				if($(level.drivable_entities[local.a])[local.s].origin[2] <= -650)
				{
					$(level.drivable_entities[local.a])[local.s] damage $world 15000 $world (0 0 0) (0 0 0) (0 0 0) 0 9 0 0
				}
				if($(level.drivable_entities[local.a])[local.s].origin[2] >= 1000) // prevent tanks from blowing up if they somehow fly upwards while climbing steep hills by bringing them back down.
				{
					$(level.drivable_entities[local.a])[local.s].origin += $(level.drivable_entities[local.a])[local.s].forwardvector * 250 + ( 0 0 -500 )
					$(level.drivable_entities[local.a])[local.s].angles = ( 0 $(level.drivable_entities[local.a])[local.s].angles[1] 0 )
				}
			}
		}
		waitframe
	}
end

////////////////////////////////////////////////////////////////////////

touching_ocean local.ocean:

	local.boat[1] = higgins1_model
	local.boat[2] = higgins2_model
	local.boat[3] = higgins3_model
	local.boat[4] = higgins4_model
	local.boat[5] = higgins5_model
	local.boat[6] = higgins6_model

	while(1)
	{
		for(local.i = 1; local.i <= $player.size; local.i++)
		{
			if($player[local.i].not_touching_scripted_higgins == NIL) { $player[local.i].not_touching_scripted_higgins = 0 }

			if(isalive $player[local.i] && $player[local.i].dmteam != "spectator" && $player[local.i].dead != 1)
			{
				if($player[local.i] istouching $(local.ocean) && $player[local.i].driving != 1 && $player[local.i].flying != 1 && $player[local.i].touching_playerboat != 1 && $player[local.i].fellundermap != 1 && $player[local.i].origin[1] < -2736)
				{
					for(local.b = 1; local.b <= local.boat.size; local.b++)
					{
						if($(local.boat[local.b]) != NULL)
						{
							if($player[local.i].not_touching_scripted_higgins >= 10)
							{
								$player[local.i] iprint "You fell under the map."
								$player[local.i] iprint "Teleporting to the surface."
								$player[local.i] respawn	// killent local.player.entnum

								$player[local.i] thread fellundermap // don't need this if "local.player kill" is used instead.
								break
							}

							if($player[local.i] istouching $(local.boat[local.b])) { $player[local.i].not_touching_scripted_higgins = 0 }
							else { $player[local.i].not_touching_scripted_higgins++ }

							if($player[local.i].not_touching_scripted_higgins > 10) { $player[local.i].not_touching_scripted_higgins = 10 }
							
						}
					}
				}
			}
		}
		waitframe
	}
end

fellundermap:

	self.fellundermap = 1 // status variable used for other scripts (like dog.scr). keep "wait" long enough for other scripts to respond.
	wait 0.5
	if(self != NULL) { self.fellundermap = 0 }
end

////////////////////////////////////////////////////////////////////////
//*** --------------------------------------------
//*** "Beach Barbwire Bangalores"
//*** --------------------------------------------

// local.redlight (0 = off, 1 = on); hold_to_plant (0 = instant plant, 1 = hold USE to plant); 
// planttime (hold USE for this long to plant, for hold_to_plant = 1 only); boomtime (time until explosion happens).

bangalores_init local.redlight local.hold_to_plant local.planttime local.boomtime:
	
	local.bangtrig = spawn trigger_use targetname "bangalore_planttrig" // these are never triggered. instead, they're used for local.player "istouching", and have wide setsizes.
	local.bangtrig model "animate/bangalore_pulsating_ghosting.tik"
	local.bangtrig.origin = ( -1160.38 3195.89 -252.83 )
	local.bangtrig setsize ( -40 -40 -40 ) ( 40 40 40 )
	local.bangtrig show
	local.bangtrig nottriggerable

	level.bangalores_hold_to_plant = local.hold_to_plant
	level.bangalores_redlight = local.redlight

	if(local.planttime != NIL) { level.bangalores_planttime = local.planttime }
	if(local.planttime == NIL) { level.bangalores_planttime = 3 }

	if(local.boomtime != NIL) { level.bangalores_boomtime = local.boomtime }
	if(local.boomtime == NIL) { level.bangalores_boomtime = 4 }
end

////////////////////////////////////////////////////////////////////////

bangalore_explode:

	$bangalore_planttrig.model = "animate/bangalore.tik"
	if(level.bangalores_redlight == 1) { $bangalore_planttrig light 1 0 0 200 }
	
	local.random = randomint(2)
	if(local.random == 0) { $bangalore_planttrig playsound bombpickup2 }
	if(local.random == 1) { $bangalore_planttrig playsound bombpickup3 }
	$bangalore_planttrig loopsound weldingtorch

	wait level.bangalores_boomtime

	$bangalore_planttrig hide
	$bangalore_explosion1a.scale = 1.2
	$bangalore_explosion1b.scale = 1.2
	$bangalore_explosion1a anim start
	$bangalore_explosion1b anim start
	$bangalore_explosion1b playsound exp_shingle
	local.random = randomint(3)
	if(local.random == 0) { $bangalore_planttrig playsound explode_building_small3 }
	if(local.random == 1) { $bangalore_planttrig playsound explode_building_small4 }
	if(local.random == 2) { $bangalore_planttrig playsound explode_building_small5 }
	exec global/earthquake.scr .35 2 0 0
	radiusdamage $bangalore_explosion1a 500 800
	wait .3

	$bangalore_explosion2a.scale = 1.2
	$bangalore_explosion2b.scale = 1.2
	$bangalore_explosion2a anim start
	$bangalore_explosion2b anim start
	$bangalore_explosion2b playsound exp_shingle
	local.random = randomint(3)
	if(local.random == 0) { $bangalore_planttrig playsound explode_building_small3 }
	if(local.random == 1) { $bangalore_planttrig playsound explode_building_small4 }
	if(local.random == 2) { $bangalore_planttrig playsound explode_building_small5 }
	exec global/earthquake.scr .35 2 0 0
	radiusdamage $bangalore_explosion2a 500 800

	wait .5
	$bangalore_explosion3a.scale = 1.2
	$bangalore_explosion3b.scale = 1.2
	$bangalore_explosion3a anim start
	$bangalore_explosion3b anim start
	$bangalore_explosion3b playsound exp_shingle
	local.random = randomint(3)
	if(local.random == 0) { $bangalore_planttrig playsound explode_building_small3 }
	if(local.random == 1) { $bangalore_planttrig playsound explode_building_small4 }
	if(local.random == 2) { $bangalore_planttrig playsound explode_building_small5 }
	exec global/earthquake.scr .35 2 0 0
	radiusdamage $bangalore_explosion3a 500 800

	$barbwire_fence1 remove
	$barbwire_fence2 remove
	$barbwire_fence3 remove
	$barbwire_fence_collision remove
	$barbwire_fence_collision_player remove

	waitframe
	$bangalore_explosion1a remove
	$bangalore_explosion1b remove
	$bangalore_explosion2a remove
	$bangalore_explosion2b remove
	$bangalore_explosion3a remove
	$bangalore_explosion3b remove
	$bangalore_planttrig remove

	for(local.i = 1; local.i <= $player.size; local.i++) // remove all other bangalores after the beach barbwire explodes.
	{
		if($("cig_1" + $player[local.i].entnum) != NULL) { $("cig_1" + $player[local.i].entnum) remove }
	}
	for(local.b = 1; local.b <= 3; local.b++)
	{
		if($("bangalore" + local.b + "_pickup") != NULL) { $("bangalore" + local.b + "_pickup") remove }
		if($("bangalore" + local.b) != NULL) { $("bangalore" + local.b) remove }
	}
	
end

////////////////////////////////////////////////////////////////////////

bangalore local.name local.origin local.angles:

	if($(local.name) != NULL) // remove the old bangalore
	{
		local.origin = $(local.name).origin
		local.angles = $(local.name).angles
		$(local.name) remove
	}

	local.trig = spawn trigger_use targetname (local.name + "_pickup")
	local.trig model models/animate/bangalore_pulsating.tik
	local.trig.origin = local.origin
	local.trig.angles = local.angles
	local.trig setsize ( -25 -25 -25 ) ( 25 25 25 )
	if(level.bangalores_redlight == 1) { local.trig light 1 0 0 65 }
	local.trig notsolid
	local.trig show
	local.trig droptofloor

	local.trig.name = local.name
	local.trig setthread doit
end

doit:

	self nottriggerable
	local.player = parm.other
	if(local.player.inuse)
	{
		local.player iprint "Cannot use. You are holding something already."
		wait 1
		self triggerable
		end
	}
	else
	{
		self message ("*** You have acquired a bangalore. ***")
		local.player.inuse = 1
		local.player playsound bombpickup4
		local.player thread bangalore_holding self.name self.origin self.angles
	}
	self triggerable
end

bangalore_holding local.name local.origin local.angles:

   	self iprint ("*** Plant the bangalore on the beach barbwire.*** ")
	if(self.isdog == 1) { self.dog attachmodel models/animate/bangalore.tik "Bip01 Spine" 0.5 ("cig_1" + self.entnum) 1 -1 -1 -1 -1 ( 0 0 5 ) }
   	else { self attachmodel models/animate/bangalore.tik "Bip01 R Thigh" 0.5 ("cig_1" + self.entnum) 1 -1 -1 -1 -1 ( 0 0 3 ) } //( -up +down, +forward -backward, +right -left )
   	local.static = spawn script_model
   	local.static model "static/corona_reg.tik"
   	local.static.scale = 0.001
   	local.static.origin = self.origin
   	local.static notsolid
   	if(level.bangalores_redlight == 1) { local.static light 1 0 0 80 }
   	local.static glue self
   	local.static show

	if(self.isdog == 1) { $("cig_1" + self.entnum).angles = ( 0 -90 0 ) }
	else { $("cig_1" + self.entnum).angles = ( 0 180 20 ) }
   	$(local.name + "_pickup") nottriggerable
	waitframe
   	if($(local.name + "_pickup") != NULL) { $(local.name + "_pickup") remove }

   	local.result = self waitthread scan_player local.name local.number //cannot use self in "doit"

   	if(local.result != left)
   	{
		self.inuse = 0
    		$("cig_1" + self.entnum) remove
		local.static unglue
		local.static remove

		if(level.bangalore_went2spectator[local.name] == 1)  // if player goes to spectator, spawn the bomb at its old picked-up origin.
		{ 
			level.bangalore_went2spectator[local.name] = 0
			goto bangalore local.name local.origin local.angles
		}

    		if(self.planted != 1) { goto bangalore local.name self.origin ( 0 (self.angles[1] - 90) 0 ) } // "goto" command ends the current thread immediately, and goes to a new one.
		self.planted = 0
   	}
	if(local.result == left) { goto bangalore local.name local.origin local.angles }
end

scan_player local.name local.number:

	local.result = ok
	local.team = self.dmteam
	local.holdtimer = 0
	local.dog = self.isdog
	while(1)
	{
		if(self == NULL)
     		{
   			local.result = left
   			end local.result
     		}
     		else
     		{
			if(self.dmteam != local.team || !isalive self || self.dead == 1 || self.dmteam == spectator || level.change_team_score == 1)
    			{
	   			if(self.dmteam == spectator || isalive self) { level.bangalore_went2spectator[local.name] = 1 }
    	   			end local.result
    			}

			if(self.isdog == 1 && local.dog != 1)
			{
				if($("cig_1" + self.entnum) != NULL) { $("cig_1" + self.entnum) remove }
				self.dog attachmodel models/animate/bangalore.tik "Bip01 Spine" 0.5 ("cig_1" + self.entnum) 1 -1 -1 -1 -1 ( 0 0 5 )
				for(local.i = 1; local.i <= $("cig_1" + self.entnum).size; local.i++) { $("cig_1" + self.entnum)[local.i].angles = ( 0 -90 0 ) }
				local.dog = 1
			}
			if(self.isdog != 1 && local.dog == 1)
			{
				if($("cig_1" + self.entnum) != NULL) { $("cig_1" + self.entnum) remove }
				self attachmodel models/animate/bangalore.tik "Bip01 R Thigh" 0.5 ("cig_1" + self.entnum) 1 -1 -1 -1 -1 ( 0 0 3 )
				for(local.i = 1; local.i <= $("cig_1" + self.entnum).size; local.i++) { $("cig_1" + self.entnum)[local.i].angles = ( 0 180 20 ) }
				local.dog = 0
			}


			local.holdtimer = 0
			while(isalive self && self.useheld == 1 && self.dmteam == local.team && $bangalore_planttrig != NULL && self istouching $bangalore_planttrig)
			{
				if(local.holdtimer == 0) { self stopwatch level.bangalores_planttime }
				if(local.holdtimer >= (level.bangalores_planttime * 20) || level.bangalores_hold_to_plant != 1)
				{
					self thread bangalore_explode

					self iprint ("*** You planted a bangalore. Take cover! ***")
					self stopwatch level.bangalores_boomtime
					self.planted = 1

	   				end local.result
				}		
				local.holdtimer++
				wait 0.05 // 20 local.holdtimer increments per second
			}
     		}
		if(self != NULL) { self stopwatch 0; local.team = self.dmteam }
     		wait 0.05
	}
end local.result

////////////////////////////////////////////////////////////////////////
//*** --------------------------------------------
//*** "Random Crater Explosions"
//*** --------------------------------------------

random_explode_setup local.damage local.beachradius local.midradius:

	thread random_explode ( -1472 2041 -516 ) local.damage local.beachradius
	thread random_explode ( 55 1558 -517 ) local.damage local.beachradius
	thread random_explode ( 552 2051 -521 ) local.damage local.beachradius
   	thread random_explode ( 1583 1555 -516 ) local.damage local.beachradius
   	thread random_explode ( 55 3056 -373 ) local.damage local.beachradius

   	thread random_explode ( -1020 4164 -371 ) local.damage local.midradius
   	thread random_explode ( -469 4621 -383 ) local.damage local.midradius
   	thread random_explode ( 46 5129 -474 ) local.damage local.midradius
   	thread random_explode ( 546 4668 -498 ) local.damage local.midradius

   	thread random_explode ( -3005 4623 -271 ) local.damage local.beachradius
end

random_explode local.origin local.damage local.radius local.off:

	if(local.off != 1) { wait (randomfloat 20 + 25) }

   	local.exp = spawn script_model
	local.exp model "animate/fx_mortar_dirt.tik"
   	local.exp.origin = local.origin
   	local.exp.scale = 1.5

	local.exp playsound arty_leadinmp
	wait 1

	radiusdamage local.origin local.damage local.radius
	local.exp playsound artyexp_sand
	local.exp anim start
	waitframe
	local.exp remove

	if(local.off != 1) { thread random_explode local.origin local.damage local.radius }
end

////////////////////////////////////////////////////////////////////////
//*** --------------------------------------------
//*** "Random Water Explosions"
//*** --------------------------------------------

random_explode_setup_water local.damage local.radius:

	thread random_explode_water ( 704 -6208 -496 ) local.damage local.radius
   	thread random_explode_water ( -192 -5248 -496 ) local.damage local.radius
   	thread random_explode_water ( -832 -4544 -496 ) local.damage local.radius
   	thread random_explode_water ( 1536 -3712 -496 ) local.damage local.radius
   	thread random_explode_water ( 768 -3264 -496 ) local.damage local.radius
   	thread random_explode_water ( 64 -2880 -496 ) local.damage local.radius
end

random_explode_water local.origin local.damage local.radius local.off:

	if(local.off != 1) { wait (randomfloat 30 + 15) }

   	local.exp = spawn script_model
	local.exp model "animate/fx_mortar_water.tik"
   	local.exp.origin = local.origin
   	local.exp.scale = 1.5

	local.exp playsound arty_leadinmp
	wait 1

	local.spray = spawn script_model
	local.spray model "emitters/fx_oceanspray.tik"
	local.spray.origin = local.origin + ( 0 0 50 )
	local.spray.scale = 1.8

	radiusdamage (local.origin + ( 0 0 50 )) local.damage local.radius
	local.exp playsound artyexp_water
	local.exp anim start
	local.spray anim start
	waitframe
	local.exp remove
	local.spray remove

	if(local.off != 1) { thread random_explode_water local.origin local.damage local.radius }
end

////////////////////////////////////////////////////////////////////////
//*** --------------------------------------------
//*** "Random Explosions Anywhere"
//*** --------------------------------------------

random_explode_anywhere local.damage local.radius:

	wait ((randomfloat(190) / 10) + 0.1)

	local.x_min = 7870 // map X-Y setsizes (-1 unit from the edges, only use + values)
	local.x_max = 7998
	local.y_min = 7998
	local.y_max = 7934

	local.r = randomint(2)
	if(local.r == 1) { local.x = randomint(local.x_min) * -1 }
	else { local.x = randomint(local.x_max) }
	if(local.r == 1) { local.y = randomint(local.y_min) * -1 }
	else { local.y = randomint(local.y_max) }

	local.origin = ( local.x local.y 1423 )
	local.z = trace local.origin (local.origin + ( 0 0 -5000 )) 0
	if(local.z_inv == 1) { local.z = local.z * -1 }

	if(level.water_volumes != NIL && level.water_volumes != 0) // if randomized origin is inside of a water volume, do a water explosion
	{
		for(local.v = 1; local.v <= level.water_volumes.size; local.v++)
		{
			local.X_min[local.v] = level.water_volumes[local.v][1][0] + level.water_volumes[local.v][2][0]
			local.X_max[local.v] = level.water_volumes[local.v][1][0] + level.water_volumes[local.v][3][0]
			local.Y_min[local.v] = level.water_volumes[local.v][1][1] + level.water_volumes[local.v][2][1]
			local.Y_max[local.v] = level.water_volumes[local.v][1][1] + level.water_volumes[local.v][3][1]
			local.Z_min[local.v] = level.water_volumes[local.v][1][2] + level.water_volumes[local.v][2][2]
			local.Z_max[local.v] = level.water_volumes[local.v][1][2] + level.water_volumes[local.v][3][2]
	
			if(int(local.origin[0]) >= local.X_min[local.v] && int(local.origin[0]) <= local.X_max[local.v] && int(local.origin[1]) >= local.Y_min[local.v] && int(local.origin[1]) <= local.Y_max[local.v] && int(local.origin[2]) >= local.Z_min[local.v] && int(local.origin[2]) <= local.Z_max[local.v])
			{
				thread random_explode_water ( local.x local.y local.z[2] ) local.damage local.radius 1
			}
			else { thread random_explode ( local.x local.y local.z[2] ) local.damage local.radius 1 }
		}
	}
	else { thread random_explode ( local.x local.y local.z[2] ) local.damage local.radius 1 }

	thread random_explode_anywhere local.damage local.radius
end

////////////////////////////////////////////////////////////////////////

bind_triggers_to_higgins:

	// for "giantbomb" and "rocket_ammo" triggers only. change level.spot_ variables to: bbomb, rocket, grenade, snowball, lbomb if needed.

	if(level.spot_bbomb != NIL && level.spot_bbomb.size >= 1)
	{
		local.g = 0
		for(local.s = 0; local.s <= level.spot_bbomb.size - 1; local.s++)
		{
			if(level.spot_bbomb[local.s] != NIL && level.spot_bbomb[local.s].size >= 1 && level.spot_bbomb[local.s][0] == 0 && level.spot_bbomb[local.s][1] == 0 && level.spot_bbomb[local.s][2] >= 0)
			{
				local.g++
				local.glue_bbomb[local.g] = local.s
			}
		}
	}
	if(level.spot_rocket != NIL && level.spot_rocket.size >= 1)
	{
		local.g = 0
		for(local.s = 0; local.s <= level.spot_rocket.size - 1; local.s++)
		{
			if(level.spot_rocket[local.s] != NIL && level.spot_rocket[local.s].size >= 1 && level.spot_rocket[local.s][0] == 0 && level.spot_rocket[local.s][1] == 0 && level.spot_rocket[local.s][2] >= 0)
			{
				local.g++
				local.glue_rocket[local.g] = local.s
			}
		}
	}

	while($higgins1 != NULL && $higgins3 != NULL && $higgins4 != NULL && $higgins5 != NULL && $higgins6 != NULL)
	{
		if(local.glue_bbomb != NIL)
		{
			local.h = 0
			for(local.s = 0; local.s <= level.spot_bbomb.size - 1; local.s++)
			{
				for(local.g = 1; local.g <= local.glue_bbomb.size; local.g++)
				{
					if(local.s == local.glue_bbomb[local.g])
					{
						local.h++
						if(local.h == 2) { local.h++ } // $higgins2 does not respawn.

						if(local.h <= 6)
						{
							level.spot_bbomb[local.glue_bbomb[local.g]] = $("higgins" + local.h + "_model").origin + ( 0 0 55 )
						}
					}
					if(local.h > 6)
					{
						if(local.e != 2) { local.e = 1 }
						break
					}
				}
				if(local.h > 6)
				{
					if(local.e != 2) { local.e = 1 }
					break
				}
			}
		}
		if(local.e == 1) { wait 1; println("----- ERROR thread 'bind_triggers_to_higgins': Can only bind 5 or fewer ( 0 0 0 ) giantbomb.scr origins to higgins boats."); local.e = 2 }

		if(local.glue_rocket != NIL)
		{
			local.h = 0
			for(local.s = 0; local.s <= level.spot_rocket.size - 1; local.s++)
			{
				for(local.g = 1; local.g <= local.glue_rocket.size; local.g++)
				{
					if(local.s == local.glue_rocket[local.g])
					{
						local.h++
						if(local.h == 2) { local.h++ } // $higgins2 does not respawn.

						if(local.h <= 6)
						{
							level.spot_rocket[local.glue_rocket[local.g]] = $("higgins" + local.h + "_door_origin").origin + ( 0 -25 30 )
						}
					}
					if(local.h > 6)
					{
						if(local.f != 6) { local.f = 1 }
						break
					}
				}
				if(local.h > 6)
				{
					if(local.f != 6) { local.f = 1 }
					break
				}
			}
		}
		if(local.f == 1) { wait 1; println("----- ERROR thread 'bind_triggers_to_higgins': Can only bind 5 or fewer ( 0 0 0 ) rocket_ammo.scr origins to higgins boats."); local.f = 2 }
		waitframe
	}
end

////////////////////////////////////////////////////////////////////////

tdm_spawns:

	local.team1 = "allied" // do not use "allies"
	local.team2 = "axis"
	thread player_spawns local.team1 local.team2
end

ffa_spawns:

	local.team1 = "deathmatch"
	local.team2 = "deathmatch"
	thread player_spawns local.team1 local.team2
end

player_spawns local.team1 local.team2:

	spawn ("info_player_" + local.team1) "origin" "-3816.004 903.474 -460.286" "angle" "82" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "-3780.725 -187.867 -473.075" "angle" "83" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "-3849.465 -1041.326 -505.433" "angle" "89" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "-2923.071 -638.262 -478.354" "angle" "87" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "-3086.797 -1986.546 -575.865" "angle" "83" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "-2246.640 239.469 -468.068" "angle" "85" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "-2042.499 -848.967 -487.399" "angle" "88" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "-2267.196 -2070.211 -575.875" "angle" "87" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "-1545.027 -2159.103 -575.875" "angle" "83" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "-1154.327 -963.714 -498.157" "angle" "92" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "-737.456 -1951.731 -575.875" "angle" "81" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "6.896 -1817.313 -575.875" "angle" "82" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "714.182 -1973.471 -575.875" "angle" "83" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "1165.311 -1001.126 -501.664" "angle" "87" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "372.019 -735.884 -479.498" "angle" "89" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "-333.065 -656.129 -478.563" "angle" "84" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "73.922 -1312.855 -530.846" "angle" "85" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "615.747 -336.844 -474.796" "angle" "86" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "-284.439 -206.432 -473.281" "angle" "82" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "-771.394 393.194 -466.266" "angle" "85" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "210.043 630.774 -463.473" "angle" "89" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "1211.410 252.097 -467.912" "angle" "90" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "822.709 1203.819 -456.744" "angle" "85" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "1190.884 1728.690 -463.562" "angle" "89" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "-770.245 1266.843 -455.964" "angle" "80" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "-448.779 1892.266 -433.875" "angle" "86" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "-2128.635 1676.980 -441.562" "angle" "79" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "1776.142 -1938.812 -575.795" "angle" "85" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "2228.176 -1113.001 -512.152" "angle" "99" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "2843.145 -1794.047 -575.875" "angle" "89" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "3529.606 -1146.119 -515.257" "angle" "88" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "2573.212 -263.913 -473.966" "angle" "86" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "2356.552 281.513 -467.575" "angle" "86" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "3767.784 -98.773 -472.031" "angle" "89" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "3856.062 938.642 -459.874" "angle" "91" "targetname" (local.team1 + "_spawn")
	spawn ("info_player_" + local.team1) "origin" "2438.572 1378.098 -451.977" "angle" "85" "targetname" (local.team1 + "_spawn")

	spawn ("info_player_" + local.team2) "origin" "-3481.234 6435.593 225.181" "angle" "-90" "targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "-2914.714 5921.049 302.118" "angle" "-93" "targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "-1530.515 5623.155 305.965" "angle" "-93" "targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "-1491.162 5047.585 -141.795" "angle" "-95" "targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "-2486.689 4831.896 -258.708" "angle" "-81" "targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "-3530.525 5390.800 -171.379" "angle" "-100" "targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "-1328.874 5240.875 272.125" "angle" "-58" "targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "-1038.603 5240.875 272.125" "angle" "-96" "targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "-815.125 5240.874 272.125" "angle" "-123" "targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "-656.526 5176.188 -292.661" "angle" "-60" "targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "-648.694 5965.092 336.125" "angle" "-72" "targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "1091.187 6016.637 269.400" "angle" "-100" "targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "1392.875 6384.875 357.623" "angle" "-117" "targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "588.253 5157.315 -393.875" "angle" "-92" "targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "1252.171 5277.583 -299.000" "angle" "-114" "targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "1423.125 5632.875 272.125" "angle" "-58" "targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "1683.526 5632.864 272.125" "angle" "-91" "targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "1936.875 5632.875 272.125" "angle" "-124" "targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "2117.693 6188.624 340.811" "angle" "-57" "targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "2042.534 5087.416 -305.764" "angle" "-91" "targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "2730.080 5766.567 249.734" "angle" "-104" "targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "3242.312 5235.010 216.125" "angle" "-126" "targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "3961.132 5839.668 272.305" "angle" "-121" "targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "2727.176 4962.005 -386.266" "angle" "-148" "targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "1392.874 4180.665 -303.875" "angle" "-142" "targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "1664.000 4890.609 -503.759" "angle" "-100" "targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "1920.001 4509.391 -503.759" "angle" "98" "targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "2176.011 4890.598 -503.759" "angle" "-99" "targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "2432.000 4509.390 -503.759" "angle" "98" "targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "2357.638 5847.497 -470.341" "angle" "-90" "targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "2131.125 5571.873 -575.875" "angle" "-55" "targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "2435.126 5861.875 -575.875" "angle" "-55" "targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "2529.080 5643.689 -557.875" "angle" "-22" "targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "2131.127 5331.125 -575.707" "angle" "36" "targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "2732.875 5568.125 -575.875" "angle" "121" "targetname" (local.team2 + "_spawn")
	spawn ("info_player_" + local.team2) "origin" "2781.485 5336.875 -575.875" "angle" "149" "targetname" (local.team2 + "_spawn")
end

////////////////////////////////////////////////////////////////////////

UBER_teleporters:

	exec map_triggers/undermap.scr ( 0 0 -719 ) ( -8000 -8000 -500 ) ( 8000 8000 1 ) undermap_tele

	exec map_triggers/tele.scr ( 2431 4509 -503 ) ( 2543 4373 -339 ) 0

if(getcvar("g_ubergametype") != "bb")
{
	exec map_triggers/tele.scr ( 2063 6239 391 ) ( 1936 5632 272 ) 1
	exec map_triggers/tele.scr ( 1392 6239 331 ) ( 1423 5632 272 ) 1
	exec map_triggers/tele.scr ( -720 5848 336 ) ( -815 5240 272 ) 1
	exec map_triggers/tele.scr ( -1423 5847 335 ) ( -1328 5240 272 ) 1
	exec map_triggers/tele.scr ( -1423 6384 335 ) ( -720 6384 337 ) 1
	exec map_triggers/tele.scr ( 1392 6384 357 ) ( 2063 6384 335 ) 1
	exec map_triggers/teleface.scr ( 2360 5860 -463 ) ( 2137 5861 -375 ) -90 -90
	exec map_triggers/tele.scr ( 2134 5671 -319 ) ( 1682 5632 272 ) 1
	exec map_triggers/tele.scr ( 3451 1443 -453 ) ( 3039 3195 -236 ) 0
	exec map_triggers/tele.scr ( -3752 1276 -455 ) ( -3128 3341 -203 ) 0
	exec map_triggers/tele.scr ( 1383 3207 -258 ) ( 1374 3333 -269 ) 1

	exec map_triggers/tele.scr ( 1264 6136 312 ) ( 1429 6136 592 ) 0
	exec map_triggers/tele.scr ( 2095 6136 317 ) ( 1927 6136 592 ) 0
	exec map_triggers/tele.scr ( -1487 5712 337 ) ( -1311 5712 592 ) 0
	exec map_triggers/tele.scr ( -656 5712 312 ) ( -826 5712 592 ) 0
	exec map_triggers/tele.scr ( 6466 4738 -184 ) ( 6466 4312 -252 ) 1
	exec map_triggers/tele.scr ( 6466 3867 -252 ) ( 6466 3361 -170 ) 1
	exec map_triggers/tele.scr ( -3736 6901 339 ) ( -4783 6901 343 ) 1

	exec map_triggers/tele.scr ( 1664 4890 -503 ) ( 1602 4922 -376 ) 1
	exec map_triggers/tele.scr ( 1375 4032 -313 ) ( 1376 4127 -303 ) 1
}
end

UBER_mapextras:

	thread solidclip ( 0 -2766 -511 ) ( -8000 -8000 -500 ) ( 8000 0 0 ) 0 ocean

	thread cratesstuff static/barbwire_long_two_post.tik ( -424.18 5894.70 322.86 ) ( 0 100 355 ) 1
	thread cratesstuff static/barbwire_long_one_post.tik ( 164.46 5913.15 285.67 ) ( 0 260 350 ) 1
	thread cratesstuff static/barbwire_long_two_post.tik ( 631.76 5879.89 231.52 ) ( 0 90 0 ) 1
	thread cratesstuff static/barbwire_two_post.tik ( 1112 5888 248 ) ( 0 90 0 ) 1

	thread cratesstuff vehicles/higginsxtrahull.tik ( 3993 5157 125 ) ( 7 -90 0 ) 1 1 map_floor ( -300 -90 -5000 ) ( 255 90 64 )
	thread cratesstuff vehicles/higginsxtrahull.tik ( 3993 5615 180 ) ( 7 -90 0 ) 1 1 map_floor ( -300 -90 -5000 ) ( 255 90 64 )
	thread cratesstuff vehicles/higginsxtrahull.tik ( 4173 5157 120 ) ( 7 -90 0 ) 1 1 map_floor ( -300 -90 -5000 ) ( 255 90 64 )
	thread cratesstuff vehicles/higginsxtrahull.tik ( 4173 5615 175 ) ( 7 -90 0 ) 1 1 map_floor ( -300 -90 -5000 ) ( 255 90 64 )
	thread cratesstuff vehicles/higginsxtrahull.tik ( 4353 5157 115 ) ( 7 -90 0 ) 1 1 map_floor ( -300 -90 -5000 ) ( 255 90 64 )
	thread cratesstuff vehicles/higginsxtrahull.tik ( 4353 5615 170 ) ( 7 -90 0 ) 1 1 map_floor ( -300 -90 -5000 ) ( 255 90 64 )

	thread solidclip ( 5960 4350 -253 ) ( 0 -510 -500 ) ( 1015 0 0 ) 0
/*
	thread cratesstuff vehicles/higginsxtrahull.tik ( 6262 4250 -315 ) ( 0 0 0 ) 1 1 map_floor ( -300 -90 -5000 ) ( 255 90 64 )
	thread cratesstuff vehicles/higginsxtrahull.tik ( 6262 4095 -315 ) ( 0 0 0 ) 1 1 map_floor ( -300 -90 -5000 ) ( 255 90 64 )
	thread cratesstuff vehicles/higginsxtrahull.tik ( 6262 3940 -315 ) ( 0 0 0 ) 1 1 map_floor ( -300 -90 -5000 ) ( 255 90 64 )
	thread cratesstuff vehicles/higginsxtrahull.tik ( 6710 4250 -315 ) ( 0 0 0 ) 1 1 map_floor ( -300 -90 -5000 ) ( 255 90 64 )
	thread cratesstuff vehicles/higginsxtrahull.tik ( 6710 4095 -315 ) ( 0 0 0 ) 1 1 map_floor ( -300 -90 -5000 ) ( 255 90 64 )
	thread cratesstuff vehicles/higginsxtrahull.tik ( 6710 3940 -315 ) ( 0 0 0 ) 1 1 map_floor ( -300 -90 -5000 ) ( 255 90 64 )
*/

	thread mapwall ( 3456 3839 75 ) ( 3584 3839 85 ) 20
	thread mapwall ( 3584 3839 85 ) ( 4415 3839 -113 ) 20
	thread mapwall ( 4415 3839 -113 ) ( 4415 3391 -171 ) 50
	thread mapwall ( 4415 3391 -171 ) ( 8000 3391 -171 ) 50
	thread mapwall ( 3456 3839 75 ) ( 3456 4164 75 ) 20
	thread mapwall ( 3456 4164 75 ) ( 3647 4352 96 ) 20
	thread mapwall ( 3647 4352 96 ) ( 3903 4352 76 ) 20
	thread mapwall ( 3903 4352 76 ) ( 4927 4352 -193 ) 50
	thread mapwall ( 4927 4352 -193 ) ( 4927 4480 -109 ) 50
	thread mapwall ( 4927 4480 -109 ) ( 5183 4480 -223 ) 50
	thread mapwall ( 5183 4480 -223 ) ( 5806 4480 -223 ) 50
	thread mapwall ( 5806 4480 -223 ) ( 5806 4604 -203 ) 50
	thread mapwall ( 5806 4604 -203 ) ( 6454 4604 -257 ) 50
	thread mapwall ( 6454 4604 -257 ) ( 6454 4745 -185 ) 50
	thread mapwall ( 6454 4745 -185 ) ( 8000 4745 -95 ) 100

	thread mapwall ( 8000 4799 95 ) ( 7936 4799 96 ) 20
	thread mapwall ( 7936 4799 96 ) ( 7616 5120 136 ) 20
	thread mapwall ( 7616 5120 136 ) ( 8000 5120 136 ) 100

	thread mapwall ( 8000 5887 256 ) ( 3902 5887 279 ) 0 3000 10
	thread mapwall ( 3904 5887 279 ) ( 3904 4863 156 ) 20
	thread mapwall ( 3904 4863 156 ) ( 3391 4863 176 ) 0 3000 10
	thread mapwall ( 3391 4863 176 ) ( 3391 5120 206 ) 20
	thread mapwall ( 3391 5120 206 ) ( 2624 5887 256 ) 0 3000 10
	thread mapwall ( 3391 5887 256 ) ( 2080 5887 271 ) 0 3000 10

	thread mapwall ( 2080 6019 296 ) ( 2303 6080 276 ) 0 25 1000
	thread mapwall ( 2303 6080 276 ) ( 2367 6144 276 ) 0 25 1000
	thread mapwall ( 2367 6144 276 ) ( 2367 6335 325 ) 0 50 500
	thread mapwall ( 2367 6335 325 ) ( 2112 6335 325 ) 0 3000 25
	thread mapwall ( 2112 6335 325 ) ( 2112 6272 356 ) 0 500 50
	thread mapwall ( 2112 6272 356 ) ( 2060 6224 396 ) 0 500 50

	thread mapwall ( 834 6399 285 ) ( 834 5912 264 ) 20
	thread mapwall ( 834 5912 264 ) ( -23 5886 336 ) 0 3000 10
	thread mapwall ( -23 5886 336 ) ( -23 6144 336 ) 0
	thread mapwall ( -23 6144 336 ) ( -319 6144 376 ) 0 3000 10
	thread mapwall ( -319 6144 376 ) ( -735 6144 336 ) 0 3000 10

	thread mapwall ( -1408 5695 335 ) ( -2175 5695 356 ) 0 3000 0
	thread mapwall ( -2175 5695 356 ) ( -2303 5695 326 ) 0 3000 0
	thread mapwall ( -2303 5695 326 ) ( -2751 5695 344 ) 0 3000 0
	thread mapwall ( -2751 5951 336 ) ( -3265 5951 336 ) 0 275 10
	thread mapwall ( -2751 6226 376 ) ( -3265 6226 376 ) 0 275 10

	thread mapwall ( -3265 6399 277 ) ( -3265 7423 520 ) 0 1000 10
	thread mapwall ( -3265 7423 520 ) ( -3777 7423 332 ) 0 3000 10
	thread mapwall ( -3775 6912 336 ) ( -4438 6912 -113 ) 0 3000 10
	thread mapwall ( -4138 6912 -113 ) ( -4543 6912 185 ) 0 3000 10

	thread mapwall ( -3775 6911 336 ) ( -3775 6655 276 ) 20
	thread mapwall ( -3775 6655 276 ) ( -3775 6399 156 ) 20
	thread mapwall ( -3775 6399 156 ) ( -3904 6271 -83 ) 20
	thread mapwall ( -3904 6271 -83 ) ( -3967 6207 -123 ) 20
	thread mapwall ( -3967 6207 -123 ) ( -3967 6080 -143 ) 20
	thread mapwall ( -3967 6080 -143 ) ( -3775 5888 -123 ) 20
	thread mapwall ( -3775 5888 -123 ) ( -3774 5631 -83 ) 20
	thread mapwall ( -3774 5631 -83 ) ( -3775 5375 -93 ) 20
	thread mapwall ( -3775 5375 -93 ) ( -3959 5106 -719 ) 20
	thread mapwall ( -3959 5106 -719 ) ( -3967 4864 -123 ) 20
	thread mapwall ( -3967 4864 -123 ) ( -4672 4863 -143 ) 20
	thread mapwall ( -4672 4863 -143 ) ( -4672 4992 -133 ) 20
	thread mapwall ( -4672 4992 -133 ) ( -4480 5696 -143 ) 20
	thread mapwall ( -4480 5696 -143 ) ( -4480 5952 -133 ) 20
	thread mapwall ( -4480 5952 -133 ) ( -4416 6016 -143 ) 20
	thread mapwall ( -4416 6016 -143 ) ( -4416 6400 -143 ) 20
	thread mapwall ( -4416 6400 -143 ) ( -4287 6913 -113 ) 20
	thread mapwall ( -4287 6913 -113 ) ( -3775 6911 336 ) 20

	thread mapwall ( -5829 5373 188 ) ( -6848 5375 166 ) 20
	thread mapwall ( -6848 5375 166 ) ( -6848 5888 266 ) 20
	thread mapwall ( -6848 5888 266 ) ( -6464 5888 266 ) 20
	thread mapwall ( -6464 5888 266 ) ( -6079 5888 336 ) 20
	thread mapwall ( -6079 5888 336 ) ( -5951 5760 266 ) 20
	thread mapwall ( -5951 5760 266 ) ( -5823 5634 246 ) 50
	thread mapwall ( -5823 5634 246 ) ( -5312 5632 234 ) 50
	thread mapwall ( -5312 5632 234 ) ( -5312 5888 266 ) 50
	thread mapwall ( -5312 5888 266 ) ( -4927 5888 276 ) 20
	thread mapwall ( -4927 5888 276 ) ( -4927 5118 205 ) 20
	thread mapwall ( -4927 5118 205 ) ( -5183 4862 195 ) 20
	thread mapwall ( -5183 4862 195 ) ( -5824 4863 146 ) 20
	thread mapwall ( -5824 4863 146 ) ( -5829 5373 188 ) 20

	thread mapwall ( -5311 7935 625 ) ( -5311 7423 586 ) 20
	thread mapwall ( -5311 7423 586 ) ( -6591 7422 635 ) 0 3000 10
	thread mapwall ( -5823 7422 635 ) ( -6591 6655 596 ) 0 3000 100
	thread mapwall ( -6591 6655 596 ) ( -6591 6528 596 ) 0 70 10
	thread mapwall ( -6591 6528 596 ) ( -6719 6399 516 ) 0 70 10
	thread mapwall ( -6719 6399 516 ) ( -6848 6398 395 ) 0 3000 10
	thread mapwall ( -6848 6398 395 ) ( -6848 6398 395 ) 0 3000 10
	thread mapwall ( -6848 6398 395 ) ( -7359 6399 376 ) 0 3000 10
	thread mapwall ( -7359 6399 376 ) ( -7871 6399 366 ) 0 3000 10

	thread mapwall ( -5824 4863 146 ) ( -6848 4863 15 ) 0 511 10 ( 7.29 180 -14 )
	thread mapwall ( -5567 4863 180 ) ( -6379 4863 79 ) 0 10 3000 ( 7.88 180 -32 )
	thread mapwall ( -6379 4863 79 ) ( -7872 4863 -140 ) 0 10 3000 ( 7.88 180 -21 )

	thread mapwall ( -6012 6143 466 ) ( -6463 6143 386 ) 0 193 0 ( 10.06 180 -11 )
	thread mapwall ( -5823 6912 576 ) ( -5952 6911 556 ) 0 175 0 ( 8.81 180 -12 )

	thread emitterstuff emitters/inferno.tik ( -1472 2041 -476 ) ( 0 0 0 ) 5
	thread emitterstuff emitters/inferno.tik ( 55 1558 -477 ) ( 0 0 0 ) 5
	thread emitterstuff emitters/inferno.tik ( 552 2051 -481 ) ( 0 0 0 ) 5
   	thread emitterstuff emitters/inferno.tik ( 1583 1555 -476 ) ( 0 0 0 ) 5
   	thread emitterstuff emitters/inferno.tik ( 55 3056 -343 ) ( 0 90 0 ) 5

   	thread emitterstuff emitters/inferno.tik ( -1020 4164 -321 ) ( 0 180 0 ) 5
   	thread emitterstuff emitters/inferno.tik ( -469 4621 -343 ) ( 0 0 0 ) 5
   	thread emitterstuff emitters/inferno.tik ( 46 5129 -424 ) ( 0 0 0 ) 5
   	thread emitterstuff emitters/inferno.tik ( 546 4668 -458 ) ( 0 0 0 ) 5
   	thread emitterstuff emitters/inferno.tik ( -3005 4623 -231 ) ( 0 0 0 ) 5

	thread cratesstuff vehicles/uboat.tik ( 1500 -7998 -555 ) ( 0 0 0 )
	thread cratesstuff vehicles/stuka_d.tik ( -2930 4615 -235 ) ( 0 0 0 )
	thread cratesstuff vehicles/shermantank_damaged.tik ( 1926 504 -464 ) ( 0 90 0 )
	thread cratesstuff vehicles/shermantank_damaged.tik ( -1850 279 -467 ) ( 0 90 0 )
	thread emitterstuff emitters/firefill.tik ( 1926 504 -344 ) ( 0 0 0 )
	thread emitterstuff emitters/firefill.tik ( -1850 279 -347 ) ( 0 0 0 )

	exec maps/gen_mapscripts/bonfire.scr ( -2930 4615 -235 ) "emitters/firefill.tik" 1.5 4.0 200 1 0.5 // origin, model, scale, burn time, burn distance, damageinc (damage dealt per iteration), burn model scale.

if(getcvar("g_ubergametype") != "bb")
{
/*
	thread cratesstuff static/banquet_table.tik ( 6509 3475 -230 ) ( 9 90 0 ) // removed to lower entity count
	thread cratesstuff static/banquet_table.tik ( 6419 3475 -230 ) ( 9 90 0 )
	thread cratesstuff static/banquet_table.tik ( 6509 3675 -262 ) ( 9 90 0 )
	thread cratesstuff static/banquet_table.tik ( 6419 3675 -262 ) ( 9 90 0 )
	thread cratesstuff static/banquet_table.tik ( 6509 3875 -295 ) ( 9 90 0 )
	thread cratesstuff static/banquet_table.tik ( 6419 3875 -295 ) ( 9 90 0 )

	thread cratesstuff static/banquet_table.tik ( 6509 4600 -250 ) ( -7 90 0 )
	thread cratesstuff static/banquet_table.tik ( 6509 4400 -276 ) ( -7 90 0 )
	thread cratesstuff static/banquet_table.tik ( 6419 4600 -250 ) ( -7 90 0 )
	thread cratesstuff static/banquet_table.tik ( 6419 4400 -276 ) ( -7 90 0 )

	thread cratesstuff static/banquet_table.tik ( -3800 6957 300 ) ( 0 180 0 )
	thread cratesstuff static/banquet_table.tik ( -4000 6957 300 ) ( 0 180 0 )
	thread cratesstuff static/banquet_table.tik ( -4200 6957 300 ) ( 0 180 0 )
	thread cratesstuff static/banquet_table.tik ( -4400 6957 300 ) ( 0 180 0 )
	thread cratesstuff static/banquet_table.tik ( -4600 6957 300 ) ( 0 180 0 )
	thread cratesstuff static/banquet_table.tik ( -4800 6957 300 ) ( 0 180 0 )

	thread cratesstuff static/banquet_table.tik ( -3800 6867 300 ) ( 0 180 0 )
	thread cratesstuff static/banquet_table.tik ( -4000 6867 300 ) ( 0 180 0 )
	thread cratesstuff static/banquet_table.tik ( -4200 6867 300 ) ( 0 180 0 )
	thread cratesstuff static/banquet_table.tik ( -4400 6867 300 ) ( 0 180 0 )
	thread cratesstuff static/banquet_table.tik ( -4600 6867 300 ) ( 0 180 0 )
	thread cratesstuff static/banquet_table.tik ( -4800 6867 300 ) ( 0 180 0 )

	thread cratesstuff static/indycrate.tik ( 2116 6189 306 ) ( 0 180 0 )
	thread cratesstuff static/indycrate.tik ( 2093 6189 353 ) ( 0 180 0 )
	thread cratesstuff static/indycrate.tik ( 2070 6189 400 ) ( 0 180 0 )
	thread cratesstuff static/indycrate.tik ( 2047 6189 447 ) ( 0 180 0 )
	thread cratesstuff static/indycrate.tik ( 2024 6189 494 ) ( 0 180 0 )

	thread cratesstuff static/indycrate.tik ( 1243 6189 306 ) ( 0 0 0 )
	thread cratesstuff static/indycrate.tik ( 1266 6189 353 ) ( 0 0 0 )
	thread cratesstuff static/indycrate.tik ( 1289 6189 400 ) ( 0 0 0 )
	thread cratesstuff static/indycrate.tik ( 1312 6189 447 ) ( 0 0 0 )
	thread cratesstuff static/indycrate.tik ( 1335 6189 494 ) ( 0 0 0 )

	thread cratesstuff static/indycrate.tik ( -637 5797 306 ) ( 0 180 0 )
	thread cratesstuff static/indycrate.tik ( -660 5797 353 ) ( 0 180 0 )
	thread cratesstuff static/indycrate.tik ( -683 5797 400 ) ( 0 180 0 )
	thread cratesstuff static/indycrate.tik ( -706 5797 447 ) ( 0 180 0 )
	thread cratesstuff static/indycrate.tik ( -729 5797 494 ) ( 0 180 0 )

	thread cratesstuff static/indycrate.tik ( -1506 5660 306 ) ( 0 0 0 )
	thread cratesstuff static/indycrate.tik ( -1483 5660 353 ) ( 0 0 0 )
	thread cratesstuff static/indycrate.tik ( -1460 5660 400 ) ( 0 0 0 )
	thread cratesstuff static/indycrate.tik ( -1437 5660 447 ) ( 0 0 0 )
	thread cratesstuff static/indycrate.tik ( -1414 5660 494 ) ( 0 0 0 )
*/
}
end

mapedge local.color local.color2:

	thread spawnlaser ( -1409 5830 336 ) ( -1409 6399 336 ) local.color 1
	thread spawnlaser ( -1409 6399 336 ) ( -2754 6399 400 ) local.color 1
	thread spawnlaser ( -2754 6399 400 ) ( -2754 7422 550 ) local.color 1
	thread spawnlaser ( -2754 7422 550 ) ( -3264 7422 526 ) local.color 1

	thread spawnlaser ( -5311 7934 626 ) ( -6300 7934 650 ) local.color 1
	thread spawnlaser ( -6300 7934 650 ) ( -7870 7934 596 ) local.color 1
	thread spawnlaser ( -7870 7934 596 ) ( -7870 6392 365 ) local.color 1

	thread spawnlaser ( 832 6398 297 ) ( -307 6398 380 ) local.color 1
	thread spawnlaser ( -307 6398 380 ) ( -734 6398 340 ) local.color 1
	thread spawnlaser ( -734 6398 340 ) ( -734 5840 340 ) local.color 1

	thread spawnlaser ( 7998 5888 257 ) ( 7998 6398 257 ) local.color 1
	thread spawnlaser ( 7998 6398 257 ) ( 3905 6398 280 ) local.color 1
	thread spawnlaser ( 3905 6398 280 ) ( 2366 6398 325 ) local.color 1

	thread spawnlaser ( 1408 5233 320 ) ( 1408 8000 320 ) local.color2 0.5
	thread spawnlaser ( 1408 5233 320 ) ( 1951 5233 320 ) local.color2 0.5
	thread spawnlaser ( 1951 5233 320 ) ( 1951 8000 320 ) local.color2 0.5

	thread spawnlaser ( -800 4840 320 ) ( -800 8000 320 ) local.color2 0.5
	thread spawnlaser ( -800 4840 320 ) ( -1343 4840 320 ) local.color2 0.5
	thread spawnlaser ( -1343 4840 320 ) ( -1343 8000 320 ) local.color2 0.5
end

cratesstuff local.model local.origin local.angles local.hide local.scale local.targetname local.setsize1 local.setsize2:

	local.ent = spawn script_model
	local.ent model local.model
	local.ent.origin = local.origin
	if(local.angles[2] != NIL) { local.ent.angles = local.angles }
	if(local.hide == 1) { local.ent hide }
	if(local.scale != NIL && local.scale > 0) { local.ent.scale = local.scale }
	if(local.targetname != NIL) { local.ent.targetname = local.targetname }
	if(local.setsize2 != NIL) { local.ent setsize local.setsize1 local.setsize2 }
end

emitterstuff local.model local.origin local.angles local.scale local.anim:

	local.emitter = spawn script_model
	local.emitter model local.model
	local.emitter.origin = local.origin
	if(local.angles[2] != NIL) { local.emitter.angles = local.angles }
	if(local.scale != NIL && local.scale > 0) { local.emitter.scale = local.scale }
	if(local.anim != NIL) { local.emitter anim local.anim }
	local.emitter notsolid
end

solidclip local.origin local.setsize1 local.setsize2 local.angles local.targetname:

	local.clip = spawn script_object
	local.clip.origin = local.origin
	local.clip setsize local.setsize1 local.setsize2
	local.clip.angle = local.angles
	local.clip solid
	local.clip nodamage
	if(local.targetname != NIL) { local.clip.targetname = local.targetname }
end

spawnlaser local.origin local.endpoint local.color local.scale:

	local.laser = spawn func_beam
	local.laser minoffset 0.0
	local.laser maxoffset 0.0
	local.laser numsegments 1
	local.laser life 0
	local.laser color local.color
	local.laser alpha 0.4
	local.laser alwaysdraw
	local.laser activate	
	if(local.scale == NIL || local.scale <= 0) { local.laser scale 1 }	
	else { local.laser scale local.scale }
	local.laser notsolid
	local.laser.origin = local.origin
	local.laser endpoint local.endpoint
end local.laser

mapwall local.origin1 local.origin2 local.thickness local.thick1 local.thick2 local.angles local.targetname:

	local.wall = spawn script_object // draw an invisible 20-unit-thick wall between any two points that extends 5000 units downward.
	local.wall.origin = local.origin1
	local.fwd_vector = ( (local.origin2[0] - local.origin1[0]) (local.origin2[1] - local.origin1[1]) (local.origin2[2] - local.origin1[2]) ) // make a vector from origin1 to origin2.
	local.wall.angles = vector_toangles(local.fwd_vector)
	local.wall solid
	local.wall nodamage
	if(local.targetname != NIL) { local.wall.targetname = local.targetname }

	local.dist = sqrt ((local.origin2[0] - local.origin1[0]) * (local.origin2[0] - local.origin1[0]) + (local.origin2[1] - local.origin1[1]) * (local.origin2[1] - local.origin1[1]) + (local.origin2[2] - local.origin1[2]) * (local.origin2[2] - local.origin1[2]))
	local.thick = local.thickness / 2.000

	local.wall setsize ( 0 (local.thickness * -1) -5000 ) ( local.dist local.thickness 0 )
	if(local.thick2 != NIL) { local.wall setsize ( 0 (local.thick1 * -1) -5000 ) ( local.dist local.thick2 0 ) }
	if(local.angles != NIL) { local.wall.angles = local.angles }
end

////////////////////////////////////////////////////////////////////////

cyb:

level waittill spawn

	level.round_starttime = 8
	level.rounds_towin = 6
 	level.changesides = 0
	level.keepsamesides = 1
	level.bombcamera = 1

  	waitthread global/cyberattack_searchdestroy.scr::bombsite ( 2679 5833 -575 ) -90 axis    // for cyber attack only
  	waitthread global/cyberattack_searchdestroy.scr::bombsite ( 405 -1077 -508 ) -90 allies

  	thread global/cyberattack_searchdestroy.scr::bomb ( 0 0 0 ) 0 ( 0 0 0 ) 0 ( -1154 3288 -246 ) 79 	// allies bomb (snd), axis bomb (snd), radiobomb (cyb).
	exec global/cyberattack_searchdestroy.scr								// none of these can be NIL. instead, use ( 0 0 0 ) 0 if not being used.
end

////////////////////////////////////////////////////////////////////////

snd:

level waittill spawn

	level.round_starttime = 8
	level.rounds_towin = 6
 	level.changesides = 1
	level.bombcamera = 1
	//level.cameradistance = 200 // this can be changed for each "changesides" if a bombsite is inside a small room, so the camera is not inside of a wall

	if(level.changesides == 0) // allies are planting (axis bombsite origins)
	{
  		waitthread global/cyberattack_searchdestroy.scr::bombsite ( 2679 5833 -575 ) -90	// for search & destroy only, team parameter doesn't matter
  		waitthread global/cyberattack_searchdestroy.scr::bombsite ( -1499 4883 -208 ) 180	// make sure to include initial bombsites before the while-loop begins.
	}
	if(level.changesides == 1) // axis are planting (allies bombsite origins)
	{
  		waitthread global/cyberattack_searchdestroy.scr::bombsite ( 1592 2930 -368 ) -90
  		waitthread global/cyberattack_searchdestroy.scr::bombsite ( -2921 -546 -477 ) 90
	}

  	thread global/cyberattack_searchdestroy.scr::bomb ( 457 -312 -474 ) -90 ( 1927 4546 -503 ) 46 ( 0 0 0 ) 0
	exec global/cyberattack_searchdestroy.scr // begin the main script

//-----------------------------------------------------------------------------

	local.sides = level.changesides	// when the sides change each 3 rounds, old bombsites are removed and 2 ones are added closer to the defending team's spawn.
	while(1)
	{
		if(level.changesides != local.sides)
		{
			waitthread global/cyberattack_searchdestroy.scr::bombsites_remove

			if(level.changesides == 0)
			{
  				waitthread global/cyberattack_searchdestroy.scr::bombsite ( 2679 5833 -575 ) -90
  				waitthread global/cyberattack_searchdestroy.scr::bombsite ( -1499 4883 -208 ) 180
			}
			if(level.changesides == 1)
			{
  				waitthread global/cyberattack_searchdestroy.scr::bombsite ( 1592 2930 -368 ) -90
  				waitthread global/cyberattack_searchdestroy.scr::bombsite ( -2921 -546 -477 ) 90
			}
			local.sides = level.changesides
		}
		waitframe
	}
end

////////////////////////////////////////////////////////////////////////

bb_objects:

level waittill prespawn

//allies
exec alienx/basebuild.scr::basebuild ( 2168.00 -672.00 -464.00 ) "static/indycrate.tik" 1 0 1 0 90 .5 0 0 1
exec alienx/basebuild.scr::basebuild ( 2168.00 -572.00 -464.00 ) "statweapons/mg42_gun.tik" 1 1 0 0 90 .5 0 0 1
exec alienx/basebuild.scr::basebuild ( 2168.00 -472.00 -464.00 ) "statweapons/flak88turret.tik" 1 1 .5 0 90 .25 0 0 1
exec alienx/basebuild.scr::basebuild ( 2168.00 -372.00 -464.00 ) "static/sandbag_link_main.tik" 1 0 0 1 90 .5 0 0 1
exec alienx/basebuild.scr::basebuild ( 2168.00 -272.00 -464.00 ) "static/indycrate.tik" 1 1 0 1 90 .5 1 0 1 // lift
exec alienx/basebuild.scr::basebuild ( 2168.00 -172.00 -464.00 ) "static/bunkertable.tik" 1 1 1 0 90 .5 0 1 1 // tele
exec alienx/basebuild.scr::basebuild ( 2168.00 -72.00 -464.00 ) "static/banquet_table.tik" 1 0 1 1 90 .5 0 0 1
exec alienx/basebuild.scr::basebuild ( 2168.00 172.00 -464.00 ) "static/bodies_tarp.tik" 1 1 1 1 90 .5 0 0 1
//exec alienx/basebuild.scr::basebuild ( 2168.00 272.00 -464.00 ) "static/bookcase.tik" 1 0 1 0 90 .5 0 0 1
//exec alienx/basebuild.scr::basebuild ( 2168.00 372.00 -464.00 ) "static/static_naziflag1.tik" 1 1 1 1 90 .5 0 0 1
//exec alienx/basebuild.scr::basebuild ( 2168.00 472.00 -464.00 ) "static/barbwire.tik" 1 0 1 1 90 .5 0 0 1
//exec alienx/basebuild.scr::basebuild ( 2168.00 572.00 -464.00 ) "static/sandbag_longsegment.tik" 1 0 0 1 90 .5 0 0 1
//exec alienx/basebuild.scr::basebuild ( 2168.00 672.00 -464.00 ) "static/cabinet_large.tik" 1 1 1 1 90 .6 0 0 1
//exec alienx/basebuild.scr::basebuild ( 2168.00 772.00 -464.00 ) "static/bush_full.tik" 1 0 1 0 90 .5 0 0 0


//axis
exec alienx/basebuild.scr::basebuild ( 2568.00 3936.00 -310.00 ) "static/indycrate.tik" 1 0 1 0 90 .5 0 0 1
exec alienx/basebuild.scr::basebuild ( 2468.00 3936.00 -310.00 ) "statweapons/mg42_gun.tik" 1 1 0 0 90 .5 0 0 1
exec alienx/basebuild.scr::basebuild ( 2368.00 3936.00 -310.00 ) "statweapons/flak88turret.tik" 1 1 .5 0 90 .25 0 0 1
exec alienx/basebuild.scr::basebuild ( 2268.00 3936.00 -310.00 ) "static/sandbag_link_main.tik" 1 0 0 1 90 .5 0 0 1
exec alienx/basebuild.scr::basebuild ( 2168.00 3936.00 -310.00 ) "static/indycrate.tik" 1 1 0 1 90 .5 1 0 1 // lift
exec alienx/basebuild.scr::basebuild ( 2068.00 3936.00 -310.00 ) "static/bunkertable.tik" 1 1 1 0 90 .5 0 1 1 // tele
exec alienx/basebuild.scr::basebuild ( 1968.00 3936.00 -310.00 ) "static/banquet_table.tik" 1 0 1 1 90 .5 0 0 1
exec alienx/basebuild.scr::basebuild ( 1868.00 3936.00 -310.00 ) "static/bodies_tarp.tik" 1 1 1 1 90 .5 0 0 1
//exec alienx/basebuild.scr::basebuild ( 1768.00 3936.00 -310.00 ) "static/bookcase.tik" 1 0 1 0 90 .5 0 0 1
//exec alienx/basebuild.scr::basebuild ( 1668.00 3936.00 -310.00 ) "static/static_naziflag1.tik" 1 1 1 1 90 .5 0 0 1
//exec alienx/basebuild.scr::basebuild ( 1568.00 3936.00 -310.00 ) "static/barbwire.tik" 1 0 1 1 90 .5 0 0 1
//exec alienx/basebuild.scr::basebuild ( 1468.00 3936.00 -310.00 ) "static/sandbag_longsegment.tik" 1 0 0 1 90 .5 0 0 1
//exec alienx/basebuild.scr::basebuild ( 1368.00 3936.00 -310.00 ) "static/cabinet_large.tik" 1 1 1 1 90 .6 0 0 1
//exec alienx/basebuild.scr::basebuild ( 1268.00 3936.00 -310.00 ) "static/bush_full.tik" 1 0 1 0 90 .5 0 0 0
end

////////////////////////////////////////////////////////////////////////

consoleprint:

	wait 1
	if(level.objectlimit != NIL && level.build_number != NIL) { end }

	local.maxclients = int(getcvar(sv_maxclients))
	local.nullent = 0
	local.e = 0
	for(local.i = 0; local.i <= 868; local.i++) // getentity() only goes up to 868 (869 entities).
	{
		if(local.i % 14 == 0) { waitframe } // every 62 entites (if local.i / 14 has remainder of 0), do a waitframe (speeds up counting).

		local.entity = getentity(local.i) // $player[1] = entity 0		
		if(local.entity == NULL && local.i >= local.maxclients) { local.nullent++ }
		if(local.entity != NULL) { local.e++ }
		if(local.e >= 685 - local.maxclients) { local.warning = 1 }
	}
	if(local.entity == NULL) // if entity 868 = NULL
	{
		println("----- Entities in map: " + (1024 - local.nullent - 155) + " / 1024")
		println("----- Entities remaining: " + (local.nullent + 155))
	}
	if(local.entity != NULL)
	{
		println("----- Entities in map: " + "more than 869" + " / 1024")
		println("----- Entities remaining: less than 155 entities.")
	}
	if(local.warning == 1)
	{
		wait 1
		println("----- WARNING: Keep below 685 entities on SP maps for Reborn servers!")
		println("----- Players may soon be unable to join! (stuck connecting to sever)")
	}
end

clickitem_fail:
end
enter_trench:
end
sequence_11_shelf_run:
end
player_sequence_8_right:
end
player_sequence_8_center:
end
player_sequence_8_left:
end
player_sequence_7_center:
end
player_sequence_7_right:
end
player_sequence_7_left:
end
player_sequence_6_right:
end
player_sequence_6_left:
end
player_sequence_5_right:
end
player_sequence_5_center:
end
player_sequence_5_left:
end
player_sequence_4_right:
end
player_sequence_4_center:
end
player_sequence_4_left:
end
player_sequence_3_right:
end
player_sequence_3_left:
end
player_sequence_3_center:
end
player_sequence_2_right:
end
player_sequence_1_center:
end
playeritem_bangalore_give:
end
bunker_dust_trigger:
end
sequence_9_shingle_start:
end
mg42_bunker:
end
mg42_crater_puzzle_start:
end
playerweapon_springfield_give:
end
player_sequence_2_center:
end
player_sequence_2_left:
end
end_level:
end
dragging_guys_blow:
end
higgins1_opening_sequence:
end
spawnrangelinked:
end
higgins_runup_mortar1:
end
higgins_runup_mortar2:
end
higgins_runup_mortar3:
end
higgins_runup_mortar4:
end
higgins_runup_mortar5:
end
higgins_runup_mortar6:
end

